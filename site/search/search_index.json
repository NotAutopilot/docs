{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"This is a converted version of the Tinkla Wiki, documenting how to install and use Open Pilot on Tesla vehicles. Main Pages Getting Started Welcome to Tinkla! - Main landing page What is Open Pilot - Overview of the project Tesla Vehicle Support Pre-Autopilot (pre AP) Tesla Model S Open Pilot for pre AP Tesla Model S - Complete guide for pre-AP vehicles Autopilot 1 (AP1) Open Pilot for Tesla Model S/X with AP1 - Complete guide for AP1 vehicles Autopilot 2 (AP2) Open Pilot for Tesla Model S/X with AP2 - Complete guide for AP2 vehicles Hardware Components Core Components Comma devkit - Main device (Comma Two/Three/EON) EON - Legacy EON device information Panda - CAN interface device The Panda - Additional Panda documentation The EON - Additional EON documentation pre AP Components Tinkla OBD-C Adapter - OBD-C connection adapter Tesla Bosch Radar - Radar retrofit guide Tesla Bosch Radar EON - EON-specific radar guide Pedal Interceptor - Accelerator pedal interceptor Pedal Interceptor EON - EON-specific pedal guide Tinkla Buddy - Instrument cluster integration Tinkla Buddy Installation Tinkla Buddy Configuration Tinkla Buddy Install Kit Tinkla Buddy Admin AP Components AP1 Harness - AP1 wiring harness AP2 Harness - AP2 wiring harness Tinkla Relay - Relay module Legacy Components Tesla Giraffe - Legacy connector EPAS Harness - Electric power steering harness Soft Panda - Software Panda implementation Configuration & Software Tesla Unity Configuration - Main configuration guide Open Pilot Configuration File - Legacy configuration EON bash profile - Shell configuration SSH Into Your Device - Remote access guide Old versions of OP - Legacy Open Pilot versions Technical Information Tesla-Specific Tesla CAN Bus - CAN bus documentation Tesla Model S pre AP OBD2 port - OBD2 connector info Longitudinal Control (ACC) - Cruise control implementation General Cabana - CAN analysis tool AWG chart - Wire gauge reference Power Options For Accessories Noctua fan - Cooling solutions Installation & Maintenance Pre AP: IC Integration with OP - Instrument cluster integration Removing the Instrument Cluster Root Access To IC and CID Map Integration Reference Tinkla General disclaimer - Legal disclaimers and licensing Installed OP Instances - Community installations Tesla Service Center Frustration Templates Template EPAS Harness Template Flashing the Panda Template Getting Started Template Long Control v066 Community Talk: Feedback? Ideas? Comments? User Bog Gyver About This Conversion This wiki was converted from Media Wiki HTML to Markdown for use with modern documentation systems. Total Pages Converted: 60 Images: 135 images copied to images/ directory Conversion Date: 2025-10-09 Notes Internal wiki links have been converted to relative markdown links External links are preserved as-is Images are referenced from the images/ subdirectory Some pages may have formatting quirks from the conversion process Original Wiki This content originally came from the Tinkla wiki at tinkla.us, which documented community efforts to run Open Pilot on Tesla vehicles.","title":"Home"},{"location":"#main-pages","text":"","title":"Main Pages"},{"location":"#getting-started","text":"Welcome to Tinkla! - Main landing page What is Open Pilot - Overview of the project","title":"Getting Started"},{"location":"#tesla-vehicle-support","text":"","title":"Tesla Vehicle Support"},{"location":"#pre-autopilot-pre-ap-tesla-model-s","text":"Open Pilot for pre AP Tesla Model S - Complete guide for pre-AP vehicles","title":"Pre-Autopilot (pre AP) Tesla Model S"},{"location":"#autopilot-1-ap1","text":"Open Pilot for Tesla Model S/X with AP1 - Complete guide for AP1 vehicles","title":"Autopilot 1 (AP1)"},{"location":"#autopilot-2-ap2","text":"Open Pilot for Tesla Model S/X with AP2 - Complete guide for AP2 vehicles","title":"Autopilot 2 (AP2)"},{"location":"#hardware-components","text":"","title":"Hardware Components"},{"location":"#core-components","text":"Comma devkit - Main device (Comma Two/Three/EON) EON - Legacy EON device information Panda - CAN interface device The Panda - Additional Panda documentation The EON - Additional EON documentation","title":"Core Components"},{"location":"#pre-ap-components","text":"Tinkla OBD-C Adapter - OBD-C connection adapter Tesla Bosch Radar - Radar retrofit guide Tesla Bosch Radar EON - EON-specific radar guide Pedal Interceptor - Accelerator pedal interceptor Pedal Interceptor EON - EON-specific pedal guide Tinkla Buddy - Instrument cluster integration Tinkla Buddy Installation Tinkla Buddy Configuration Tinkla Buddy Install Kit Tinkla Buddy Admin","title":"pre AP Components"},{"location":"#ap-components","text":"AP1 Harness - AP1 wiring harness AP2 Harness - AP2 wiring harness Tinkla Relay - Relay module","title":"AP Components"},{"location":"#legacy-components","text":"Tesla Giraffe - Legacy connector EPAS Harness - Electric power steering harness Soft Panda - Software Panda implementation","title":"Legacy Components"},{"location":"#configuration-software","text":"Tesla Unity Configuration - Main configuration guide Open Pilot Configuration File - Legacy configuration EON bash profile - Shell configuration SSH Into Your Device - Remote access guide Old versions of OP - Legacy Open Pilot versions","title":"Configuration &amp; Software"},{"location":"#technical-information","text":"","title":"Technical Information"},{"location":"#tesla-specific","text":"Tesla CAN Bus - CAN bus documentation Tesla Model S pre AP OBD2 port - OBD2 connector info Longitudinal Control (ACC) - Cruise control implementation","title":"Tesla-Specific"},{"location":"#general","text":"Cabana - CAN analysis tool AWG chart - Wire gauge reference Power Options For Accessories Noctua fan - Cooling solutions","title":"General"},{"location":"#installation-maintenance","text":"Pre AP: IC Integration with OP - Instrument cluster integration Removing the Instrument Cluster Root Access To IC and CID Map Integration","title":"Installation &amp; Maintenance"},{"location":"#reference","text":"Tinkla General disclaimer - Legal disclaimers and licensing Installed OP Instances - Community installations Tesla Service Center Frustration","title":"Reference"},{"location":"#templates","text":"Template EPAS Harness Template Flashing the Panda Template Getting Started Template Long Control v066","title":"Templates"},{"location":"#community","text":"Talk: Feedback? Ideas? Comments? User Bog Gyver","title":"Community"},{"location":"#about-this-conversion","text":"This wiki was converted from Media Wiki HTML to Markdown for use with modern documentation systems. Total Pages Converted: 60 Images: 135 images copied to images/ directory Conversion Date: 2025-10-09","title":"About This Conversion"},{"location":"#notes","text":"Internal wiki links have been converted to relative markdown links External links are preserved as-is Images are referenced from the images/ subdirectory Some pages may have formatting quirks from the conversion process","title":"Notes"},{"location":"#original-wiki","text":"This content originally came from the Tinkla wiki at tinkla.us, which documented community efforts to run Open Pilot on Tesla vehicles.","title":"Original Wiki"},{"location":"AP1_Harness/","text":"AP1 Harness Parts Needed For the best experience, just purchase our Tinkla OBD-C Adapter for Tesla Model S with AP1 for $125 from our online store or build your own for about $220 + tools and a lot of crimping :) A Comma Car Harness for**Development Vehicle**- $200.00 1 x TE Connectivity/AMP 1-1743284-2 - $4.42 1 x TE Connectivity/AMP 1-1743282-2 - $1.08 8 x TE Connectivity/AMP 5-963715-1-CT - unfortunately you can only by them in strips of 100 for $9.10 about 20\" of #18 automotive wire Male connector and wires on PCB board The PCB Board As you can see from the parts list, I did not find a male connector that has pins. This one is designed to be used in a PCB board. I had a development PCB board in my workshop, so I just used some string scisors and cut it to fit. If you don't have one, you can order one from Amazon or pick one up from your local electronics store, like Micro Center. The best way is to go with the wires and the connector from the same side of the PCB board, the solder on the back. See picture of how my PCB board looked once I soldered it all together. AP1 Harness AP1 Connector Diagram The Comma 26 Pin Connector Take your time and use a sharp object to take out all the wires that you are not using from the 26 pin connector of the Comma harness. Will make everything look better and fit better under the roof liner. Pay extra attention at the jumper that comes with the harness between the pins 3-5. We need to reuse that one and insert it between the pins 23-25. The Defrost Power The AP1 hardware gets 10A @ 12V power just to be able to defrost the windshield in front of the camera. The wires that come with the Comma car harness are too thin to handle so many amps. Use the #18 wire from the parts list to connect pins 6 (Defog to windshield) and 7 (Defog power in) from the male connector to the female connector. Do not use the Comma harness wires for this! Making the Harness Solder and crimp the wires per the diagram above Note the connector orientation and the pin numbers Make sure the connections are well done and no wires are lose Test with a voltmeter if possible between each corresponding pin of the two black connectors","title":"AP1 Harness"},{"location":"AP1_Harness/#parts-needed","text":"For the best experience, just purchase our Tinkla OBD-C Adapter for Tesla Model S with AP1 for $125 from our online store or build your own for about $220 + tools and a lot of crimping :) A Comma Car Harness for**Development Vehicle**- $200.00 1 x TE Connectivity/AMP 1-1743284-2 - $4.42 1 x TE Connectivity/AMP 1-1743282-2 - $1.08 8 x TE Connectivity/AMP 5-963715-1-CT - unfortunately you can only by them in strips of 100 for $9.10 about 20\" of #18 automotive wire Male connector and wires on PCB board","title":"Parts Needed"},{"location":"AP1_Harness/#the-pcb-board","text":"As you can see from the parts list, I did not find a male connector that has pins. This one is designed to be used in a PCB board. I had a development PCB board in my workshop, so I just used some string scisors and cut it to fit. If you don't have one, you can order one from Amazon or pick one up from your local electronics store, like Micro Center. The best way is to go with the wires and the connector from the same side of the PCB board, the solder on the back. See picture of how my PCB board looked once I soldered it all together. AP1 Harness AP1 Connector Diagram","title":"The PCB Board"},{"location":"AP1_Harness/#the-comma-26-pin-connector","text":"Take your time and use a sharp object to take out all the wires that you are not using from the 26 pin connector of the Comma harness. Will make everything look better and fit better under the roof liner. Pay extra attention at the jumper that comes with the harness between the pins 3-5. We need to reuse that one and insert it between the pins 23-25.","title":"The Comma 26 Pin Connector"},{"location":"AP1_Harness/#the-defrost-power","text":"The AP1 hardware gets 10A @ 12V power just to be able to defrost the windshield in front of the camera. The wires that come with the Comma car harness are too thin to handle so many amps. Use the #18 wire from the parts list to connect pins 6 (Defog to windshield) and 7 (Defog power in) from the male connector to the female connector. Do not use the Comma harness wires for this!","title":"The Defrost Power"},{"location":"AP1_Harness/#making-the-harness","text":"Solder and crimp the wires per the diagram above Note the connector orientation and the pin numbers Make sure the connections are well done and no wires are lose Test with a voltmeter if possible between each corresponding pin of the two black connectors","title":"Making the Harness"},{"location":"AP2_Harness/","text":"For the best experience, just purchase our Tinkla OBD-C Adapter for Tesla with AP2+ for $150 from our online store or build your own for about $440 + tools and a lot of crimping :) Two Options AP2 controls steering using the Chassis CAN and acceleration/braking through the Powertrain CAN, thus it requires two harness for complete control from Open Pilot. Only a Comma three can control multiple pandas using the additional USB-C port. Hence a Comma two can only handle lateral control. Using Open Pilot with just lateral control When using the Open Pilot on a Tesla with AP2/2.5/3, you have the option to configure the software (via the UI toggles) to only do lateral control, and let the built in adaptive cruise control handle the longitudinal control. To do this, you will need a Comma two or Comma three plus a Lateral Control Harness by following the instructions in the Comma repository. Using Open Pilot with full control To allow Open Pilot to fully (lateral and longitdinal) control your Telsa equipped with AP2/2.5/3, you need the following: A Comma three A black panda (for longitudinal control) Two Comma Car Harnesses for Development Vehicles Connectors and pin as listed in this diagram to build both the lateral control harness and the longitdinal control harness] Some quiet time to sit down and build your harnesses","title":"AP2 Harness"},{"location":"AP2_Harness/#two-options","text":"AP2 controls steering using the Chassis CAN and acceleration/braking through the Powertrain CAN, thus it requires two harness for complete control from Open Pilot. Only a Comma three can control multiple pandas using the additional USB-C port. Hence a Comma two can only handle lateral control.","title":"Two Options"},{"location":"AP2_Harness/#using-open-pilot-with-just-lateral-control","text":"When using the Open Pilot on a Tesla with AP2/2.5/3, you have the option to configure the software (via the UI toggles) to only do lateral control, and let the built in adaptive cruise control handle the longitudinal control. To do this, you will need a Comma two or Comma three plus a Lateral Control Harness by following the instructions in the Comma repository.","title":"Using Open Pilot with just lateral control"},{"location":"AP2_Harness/#using-open-pilot-with-full-control","text":"To allow Open Pilot to fully (lateral and longitdinal) control your Telsa equipped with AP2/2.5/3, you need the following: A Comma three A black panda (for longitudinal control) Two Comma Car Harnesses for Development Vehicles Connectors and pin as listed in this diagram to build both the lateral control harness and the longitdinal control harness] Some quiet time to sit down and build your harnesses","title":"Using Open Pilot with full control"},{"location":"AWG_chart/","text":"Please use this chart to select the right wire gauge for your needs. Wire gauge depends on amps and length needed. For all the CAN signal wiring, we recommend 22 gauge shielded twisted pair (2 pairs) cable, like Belden 8723 060100.","title":"AWG Wire Chart"},{"location":"Cabana/","text":"Cabana is a web application that allows you to inspect, label, and plot vehicle data collected by panda which can then be saved locally or committed to Git Hub in the form of a dbc file. Cabana syncs panda data with Open Pilot data for an extremely user-friendly reverse engineering experience. This allows you to easily scrub through video segments to target a specific driving event, such as braking, and label the associated CAN messages. View example here Using cabana live: Mac: Chrome --enable-features=Web USB Linux: sudo /opt/google/chrome/chrome -enable-features=Web USB --no-sandbox Windows: chrome://flags/#enable-experimental-web-platform-features How do I view my drives? Explorer is where to go to view your recent drives. Select your drive and use the slider to skip through. Video playback is possible too, just press V where you want the video to start from. it may take a few seconds to start. Speed is updated when using the slider but stops when viewing video. You can also annotate disengagements (tell comma.ai why you took control of the vehicle) this helps improve the system and further development. **Can I share my drives?**Yes, you can share your drives from via the corresponding Link, but keep in mind that these links can not be withdrawn and could expose your privacy.","title":"Cabana CAN Tool"},{"location":"Comma_devkit/","text":"The Comma devkit (two or three) is the name associated in the Comma.ai community to the device that sits in your windshield and does all the calculations for LKA and ACC. Comma Dev Kit The EON Gold (and Comma two) is based on the Qualcom Snapdragon 821 mobile platform . Phones like Le Eco Le Pro3 have been used to create the Fr EON (the free EON). You can find some instructions here . You would also need a Black Panda in order to have a kit similar to the Comma two or Comma three. If you choose to buy your Comma two or Comma three already made, you can do so from Comma.ai store for $999 USD and up, depending on version. Support for Comma two is supposed to end in summer of 2022. Also, keeping the phone screen off helps keeping the temperature low. I know, in the beginning one wants to see those lines matching the lines in the video, but after a while you stop paying attention to the screen. And if you have the IC integration all the data is on IC anyway. So turn that screen off and you will see the temperature drop about 15F. Installing the Comma devkit Comma devkit installation is pretty simple. Your main objective is to ensure the Comma devkit is level with the ground, and pointed as straight as you can get it. Also do make sure the camera on the left side of the devkit (which is used for driver monitoring) can see you well. If you're uncomfortable \"eyeballing it,\" you may want to use: A measuring tape A roll of masking tape A friend to help Tips Before adhering any components, it is recommended that you clean the area with isopropyl alcohol to remove any oils or other contaminants from the surface. This is particularly important for the main comma mount. Contaminants may cause the adhesive hold to weaken, resulting in your device falling off your windshield. When affixing the main comma mount to the windshield, try to prevent air from being trapped under the adhesive. This can be done by adhering one edge of the mount to the windshield first and \"rolling\" the rest of the mount onto the windshield. Many people recommend leaving mount adhered to your windshield for 24-48 hours before attaching the device. It is also recommended that you keep the mount out of the sun for this \"curing\" time period. Attaching tape to the exterior of your windshield helps to provide shade while the adhesive sets if you can't keep it in the dark. Avoid installing the mount on very cold days. The adhesive may not form a strong bond under cold temperatures. Additionally, the condensation from your breath on the windshield could prevent a strong bond from forming. If necessary, install with with window defrost on to warm up the window and prevent condensation. Be sure to attach all cables firmly. This is one of the main installation errors. The automotive cables should all click when fully seated. The RJ45 (flat Ethernet cable) should also nicely click into both connections. The USB-C connection should be pushed in with some force. Users with errors have frequently discovered that the USB-C connection on the back of the Comma devkit is a tight fit make sure the connector is fully inserted. Instructions Find a place at the bottom of the windshield, along the driver's side pillar that has a similar position on the passenger side (such as the place where the corner of the front hood meets the fender). With the tape starting from that point, mark 3 places along the side of the windshield. Use the edge of the masking tape to mark them. I personally used 3\" from the bottom, the top of the windshield and then about \u2153 from the bottom, \u2154 from the top. It does not matter what the measuring tape says, as long as it says the SAME distance on driver's and passenger's sides. Repeat the process on the other side of the windshield, ensuring you mark the same spots. measure the distance between one edge of the windshield and the other end, keeping the tape at each pair of marked points from before. use masking tape to mark the middle of the windshield. again, use the EDGE of the tape, not the center. Now use a long piece of masking tape to mark the center of the windshield from top to bottom. This (if you did everything correctly) will cover all 3 of your markers from before and provide a straight line. One edge of the masking tape is now the perfect middle of the windshield. Your mount will have to be aligned with that for a perfect position. Take a small piece of tape and mark the middle of the Comma mount. use a slightly longer piece than the mount (maybe \u00bc-\u00bd\" more on each side) and ensure it is straight and down the middle of the Comma mount. If, when looking from inside of the car, your tape is to the RIGHT of the center, then put the tape on the LEFT side of the mount. Reverse if the other way. Using your Comma devkit without the mounting bracket, determine the location along the center of the windshield where you want it placed. Make sure the grove on the support is alongside the center of the windshield. use a small piece of masking tape to mark the upper part of the position where you want your Comma devkit to be. Remove the RED protective tape from the back of the 3M adhesive and be ready to place the Comma mount on the windshield. Align the masking tape we placed on the Comma mount on the inside with the masking tape we have on the outside of the windshield. They should not overlap at all AND you should not see light either. when you are confident on the position press hard on the mount. Remove all masking tape. You are done. You now have a perfectly centered, perfectly vertical Comma devkit. pre AP Model S only: Hide the Thuderbolt3 cable above the Headliner Pull your Thunderbolt3 cable from the footwell gap (where the OBDII port with a Tinkla OBD-C Adapter is) up to where the \"A\" pillar is... Follow the instructions to remove the air bag cover from the \"A\" pillar Pull the cable up the height of the \"A\" pillar across to the mirror holding it close to the headliner. Adjust the length to reach where you will place your Comma devkit. Drape the Thuderbolt3 end over the rear view mirror. Move to the corner where the headliner and the removed airbag panel intersect, this corner is the easiest place to stick a pry tool... Using your pry tool lift the corner and move the pry-tool along the top of the windshield tucking the wire into the headliner as you go. When you reach the mirror base, the Thuderbolt3 cable can be routed down the front of the windshield to emerge at the bottom of the mirror base closer to the center of the windshield. Once the cabling is tucked in the headliner, move back to the \"A\" pillar and tuck the cable into the pillar cover routing it down towards the door seal, then secure the pillar cover to conceal the wiring. Installing Open Pilot for Tesla Comma.ai doesn't fully support Tesla cars. That's why we maintain our own fork, which you will have to install into your Comma devkit. DON\u2019T INSTALL ON ANYTHING OTHER THAN A SUPPORTED TESLA! (Someone bricked their Jeep trying.) If you had Open Pilot for Tesla v0.6.6 (tesla_devel) or v0.7.4 (tesla_alpha) installed If you had Open Pilot for Tesla v0.6.6 (tesla_devel) or v0.7.4 (tesla_alpha) installed on your Comma two/EON Gold before, you HAVE to first update your device's firmware to the latest version before being able to use Tesla Unity. In order to do so, you have to ssh into your device and run following command bash <(curl -s https://tinkla.us/files/nu/update.sh) DON\u2019T RUN THIS COMMAND ON AN OLD EON BASED ON One+ 3T AS IT WILL BRICK IT. THE OLD EON ONLY WORKS WITH THE OLD VERSION OF OPENPILOT FOR TESLA. Installing the Tinkla version of Open Pilot Follow these instructions for setting up a Comma devkit with Tinkla Open Pilot If the devkit came with the official software preinstalled (did not start with \"Getting Started\"), or to remove the \"Dashcam\" software, follow the instructions in section Removing Dashcam Software When your device boots up for the first time, you'll have the choice of either installing \"Dashcam software\" or \"Custom Software (Advanced).\" Let's go through this process to install Open Pilot instead of the Dashcam software (which does not pilot the car). Ensure you're connected either to a Wifi hotspot, or that you can \"Skip\" the wifi hotspot selection (that means the SIM card is connected to a network). Select \"Custom Software (Advanced).\" Enter https://op.tinkla.us and click \"Install Software.\" Your device will then download the software, show \"Installing Tinkla Unity\" on the screen, and install it. Note that when using the SIM card for this, you may need to retry once or twice depending on the quality of the connection. When using a wall charger at your desk, make sure it can output 2-3A (installation draws just a little above 1.0A) Closely follow the training guide. Edit your Config for your specific Tesla Train (calibrate) the system on your car by manually driving faster than 15 mph (~ 25 km/h) for a few minutes. The screen will show what the camera sees after the training is complete. You may now enable Tinkla Unity as per usual, and Open Pilot will take control after emitting a sound. Removing Dashcam Software If you selected the \"Dashcam\" software during setup you can uninstall with the following steps Click on the settings icon (the gear in the top left of the homescreen) Click \"Software\" on the right (Version will say \"xxxx v X.X.X, something different than Tinkla OP v X.X.X)) Scroll down to \"Uninstall xxx\" If the option is grayed out or unavailable, shut off your car. When prompted with a confirmation of uninstalling click, \"Uninstall\" The device will reboot and uninstall the existing software. Once finished it will return to the device's initial state. You can now install Tinkla Unity software through the setup. How can I reset my Comma devkit to factory settings? If something went wrong during the install process, do not despair. You can always reset the Comma devkit to factory settings by following these simple steps: Press and holding Power and Volume Up until your devkit enters the Bootloader mode Go to Factory Reset -> Full Factory Reset Confirm with Yes then use the power button to reboot the devkit. You should now be able to reinstall the software. Configuration and Firmware Patches Edit your Config After the Comma devkit has booted you should go and edit the configuration settings specific to our Tinkla Unity branch for Tesla. Flash your Panda Since version 0.8.13-37, flashing of the panda code is done automatically every time there is a change in the code. If for any reason your devkit shows car offline while connected to your Tesla, and a reboot will not fix that, please follow the instructions below to flash both the bootloader and the code onto your panda. In your Tesla while it says \u201cCar Off\u201d connect your Comma devkit to your car harness (either using the Tinkla OBD-C Adapter for pre AP cars or the specific harness for your AP Tesla. Once the device fully boots up, go to Settings->Tinkla and scroll down to the bottom of the screen where you will see a button called \"Flash Panda\" Once you hit the Flash Panda button, a new (white) screen will open up and at the bottom will will find the Flash button. Select Flash and then wait for the software to flash the Panda. Once complete you will be prompted to reboot the Comma devkit What do the Panda LED colors mean? (on the back of the devkit) White: CAN send enabled Red: This is your panda's heartbeat(power). It fades in and out Green: Bad firmware or firmware flashing (only green, fast) Blue (static): CAN detected Blue (fades in and out): power saving pre AP only: Patch your EPAS In your Tesla while it says \u201cCar Off\u201d connect your Comma devkit to your car harness (etiher using the Tinkla OBD-C Adapter for pre AP cars or the specific harness for your AP Tesla. Once the device fully boots up, go to Settings->Tesla pre AP and scroll down to the bottom of the screen where you will see a button called \"Flash EPAS\" Once you hit the Flash EPAS button, a new (white) screen will open up and at the bottom will will find the Patch button. Press and hold the brake pedal so the car stays on. Note that during the process you might see some warning on the instrument cluster which will go away. Select Patch and then wait for the software to configure the EPAS. Once complete you will be prompted to reboot the Comma devkit. Also, at this point exit the car so that the car goes in Car Off mode. Once this happens your EPAS will be patched and ready to go. Almost there Final steps Finally, check here to learn more about all the controls, functions and features related to longitudinal control: Using adaptive cruise control First Open Pilot Drive Make sure the Comma devkit is mounted properly and connected to the Panda by following #Installing the Comma devkit Turn your car on and verify that the left side indicator shows \"Car Online\". If not, your panda is not flashed, see flashing instructions here Panda Flashing . Open Pilot should switch to \"drive mode\" and show the camera view with white lane marking Read up and understand the controls from Using adaptive cruise control If your car is recognized Calibration will increment at above 15mph. It will take less than 30 seconds to fully calibrate. If you move the mount, it's recommended to reset camera calibration under \"device settings\". When driving, Pull the Cruise Control Stalk to use Open Pilot If your car is not recognized If your Tesla is a pre AP Model S, did you turn on the toggle for**Force Pre AP Tesla Model S**in the**Tesla pre AP** settings ? Ask for help on the #tesla channel of the Comma.ai Discord Experiencing issues? In case you use a Pedal and it just won't work, chances are it doesn't have Tesla firmware on it yet. You can flash it with this guide . On any other issue, please use the search function or ask us on Discord .","title":"Comma Device"},{"location":"Comma_devkit/#comma-dev-kit","text":"The EON Gold (and Comma two) is based on the Qualcom Snapdragon 821 mobile platform . Phones like Le Eco Le Pro3 have been used to create the Fr EON (the free EON). You can find some instructions here . You would also need a Black Panda in order to have a kit similar to the Comma two or Comma three. If you choose to buy your Comma two or Comma three already made, you can do so from Comma.ai store for $999 USD and up, depending on version. Support for Comma two is supposed to end in summer of 2022. Also, keeping the phone screen off helps keeping the temperature low. I know, in the beginning one wants to see those lines matching the lines in the video, but after a while you stop paying attention to the screen. And if you have the IC integration all the data is on IC anyway. So turn that screen off and you will see the temperature drop about 15F.","title":"Comma Dev Kit"},{"location":"Comma_devkit/#installing-the-comma-devkit","text":"Comma devkit installation is pretty simple. Your main objective is to ensure the Comma devkit is level with the ground, and pointed as straight as you can get it. Also do make sure the camera on the left side of the devkit (which is used for driver monitoring) can see you well. If you're uncomfortable \"eyeballing it,\" you may want to use: A measuring tape A roll of masking tape A friend to help","title":"Installing the Comma devkit"},{"location":"Comma_devkit/#tips","text":"Before adhering any components, it is recommended that you clean the area with isopropyl alcohol to remove any oils or other contaminants from the surface. This is particularly important for the main comma mount. Contaminants may cause the adhesive hold to weaken, resulting in your device falling off your windshield. When affixing the main comma mount to the windshield, try to prevent air from being trapped under the adhesive. This can be done by adhering one edge of the mount to the windshield first and \"rolling\" the rest of the mount onto the windshield. Many people recommend leaving mount adhered to your windshield for 24-48 hours before attaching the device. It is also recommended that you keep the mount out of the sun for this \"curing\" time period. Attaching tape to the exterior of your windshield helps to provide shade while the adhesive sets if you can't keep it in the dark. Avoid installing the mount on very cold days. The adhesive may not form a strong bond under cold temperatures. Additionally, the condensation from your breath on the windshield could prevent a strong bond from forming. If necessary, install with with window defrost on to warm up the window and prevent condensation. Be sure to attach all cables firmly. This is one of the main installation errors. The automotive cables should all click when fully seated. The RJ45 (flat Ethernet cable) should also nicely click into both connections. The USB-C connection should be pushed in with some force. Users with errors have frequently discovered that the USB-C connection on the back of the Comma devkit is a tight fit make sure the connector is fully inserted.","title":"Tips"},{"location":"Comma_devkit/#instructions","text":"Find a place at the bottom of the windshield, along the driver's side pillar that has a similar position on the passenger side (such as the place where the corner of the front hood meets the fender). With the tape starting from that point, mark 3 places along the side of the windshield. Use the edge of the masking tape to mark them. I personally used 3\" from the bottom, the top of the windshield and then about \u2153 from the bottom, \u2154 from the top. It does not matter what the measuring tape says, as long as it says the SAME distance on driver's and passenger's sides. Repeat the process on the other side of the windshield, ensuring you mark the same spots. measure the distance between one edge of the windshield and the other end, keeping the tape at each pair of marked points from before. use masking tape to mark the middle of the windshield. again, use the EDGE of the tape, not the center. Now use a long piece of masking tape to mark the center of the windshield from top to bottom. This (if you did everything correctly) will cover all 3 of your markers from before and provide a straight line. One edge of the masking tape is now the perfect middle of the windshield. Your mount will have to be aligned with that for a perfect position. Take a small piece of tape and mark the middle of the Comma mount. use a slightly longer piece than the mount (maybe \u00bc-\u00bd\" more on each side) and ensure it is straight and down the middle of the Comma mount. If, when looking from inside of the car, your tape is to the RIGHT of the center, then put the tape on the LEFT side of the mount. Reverse if the other way. Using your Comma devkit without the mounting bracket, determine the location along the center of the windshield where you want it placed. Make sure the grove on the support is alongside the center of the windshield. use a small piece of masking tape to mark the upper part of the position where you want your Comma devkit to be. Remove the RED protective tape from the back of the 3M adhesive and be ready to place the Comma mount on the windshield. Align the masking tape we placed on the Comma mount on the inside with the masking tape we have on the outside of the windshield. They should not overlap at all AND you should not see light either. when you are confident on the position press hard on the mount. Remove all masking tape. You are done. You now have a perfectly centered, perfectly vertical Comma devkit.","title":"Instructions"},{"location":"Comma_devkit/#pre-ap-model-s-only-hide-the-thuderbolt3-cable-above-the-headliner","text":"Pull your Thunderbolt3 cable from the footwell gap (where the OBDII port with a Tinkla OBD-C Adapter is) up to where the \"A\" pillar is... Follow the instructions to remove the air bag cover from the \"A\" pillar Pull the cable up the height of the \"A\" pillar across to the mirror holding it close to the headliner. Adjust the length to reach where you will place your Comma devkit. Drape the Thuderbolt3 end over the rear view mirror. Move to the corner where the headliner and the removed airbag panel intersect, this corner is the easiest place to stick a pry tool... Using your pry tool lift the corner and move the pry-tool along the top of the windshield tucking the wire into the headliner as you go. When you reach the mirror base, the Thuderbolt3 cable can be routed down the front of the windshield to emerge at the bottom of the mirror base closer to the center of the windshield. Once the cabling is tucked in the headliner, move back to the \"A\" pillar and tuck the cable into the pillar cover routing it down towards the door seal, then secure the pillar cover to conceal the wiring.","title":"pre AP Model S only: Hide the Thuderbolt3 cable above the Headliner"},{"location":"Comma_devkit/#installing-open-pilot-for-tesla","text":"Comma.ai doesn't fully support Tesla cars. That's why we maintain our own fork, which you will have to install into your Comma devkit. DON\u2019T INSTALL ON ANYTHING OTHER THAN A SUPPORTED TESLA! (Someone bricked their Jeep trying.)","title":"Installing Open Pilot for Tesla"},{"location":"Comma_devkit/#if-you-had-open-pilot-for-tesla-v066-tesla_devel-or-v074-tesla_alpha-installed","text":"If you had Open Pilot for Tesla v0.6.6 (tesla_devel) or v0.7.4 (tesla_alpha) installed on your Comma two/EON Gold before, you HAVE to first update your device's firmware to the latest version before being able to use Tesla Unity. In order to do so, you have to ssh into your device and run following command bash <(curl -s https://tinkla.us/files/nu/update.sh) DON\u2019T RUN THIS COMMAND ON AN OLD EON BASED ON One+ 3T AS IT WILL BRICK IT. THE OLD EON ONLY WORKS WITH THE OLD VERSION OF OPENPILOT FOR TESLA.","title":"If you had Open Pilot for Tesla v0.6.6 (tesla_devel) or v0.7.4 (tesla_alpha) installed"},{"location":"Comma_devkit/#installing-the-tinkla-version-of-open-pilot","text":"Follow these instructions for setting up a Comma devkit with Tinkla Open Pilot If the devkit came with the official software preinstalled (did not start with \"Getting Started\"), or to remove the \"Dashcam\" software, follow the instructions in section Removing Dashcam Software When your device boots up for the first time, you'll have the choice of either installing \"Dashcam software\" or \"Custom Software (Advanced).\" Let's go through this process to install Open Pilot instead of the Dashcam software (which does not pilot the car). Ensure you're connected either to a Wifi hotspot, or that you can \"Skip\" the wifi hotspot selection (that means the SIM card is connected to a network). Select \"Custom Software (Advanced).\" Enter https://op.tinkla.us and click \"Install Software.\" Your device will then download the software, show \"Installing Tinkla Unity\" on the screen, and install it. Note that when using the SIM card for this, you may need to retry once or twice depending on the quality of the connection. When using a wall charger at your desk, make sure it can output 2-3A (installation draws just a little above 1.0A) Closely follow the training guide. Edit your Config for your specific Tesla Train (calibrate) the system on your car by manually driving faster than 15 mph (~ 25 km/h) for a few minutes. The screen will show what the camera sees after the training is complete. You may now enable Tinkla Unity as per usual, and Open Pilot will take control after emitting a sound.","title":"Installing the Tinkla version of Open Pilot"},{"location":"Comma_devkit/#removing-dashcam-software","text":"If you selected the \"Dashcam\" software during setup you can uninstall with the following steps Click on the settings icon (the gear in the top left of the homescreen) Click \"Software\" on the right (Version will say \"xxxx v X.X.X, something different than Tinkla OP v X.X.X)) Scroll down to \"Uninstall xxx\" If the option is grayed out or unavailable, shut off your car. When prompted with a confirmation of uninstalling click, \"Uninstall\" The device will reboot and uninstall the existing software. Once finished it will return to the device's initial state. You can now install Tinkla Unity software through the setup.","title":"Removing Dashcam Software"},{"location":"Comma_devkit/#how-can-i-reset-my-comma-devkit-to-factory-settings","text":"If something went wrong during the install process, do not despair. You can always reset the Comma devkit to factory settings by following these simple steps: Press and holding Power and Volume Up until your devkit enters the Bootloader mode Go to Factory Reset -> Full Factory Reset Confirm with Yes then use the power button to reboot the devkit. You should now be able to reinstall the software.","title":"How can I reset my Comma devkit to factory settings?"},{"location":"Comma_devkit/#configuration-and-firmware-patches","text":"","title":"Configuration and Firmware Patches"},{"location":"Comma_devkit/#edit-your-config","text":"After the Comma devkit has booted you should go and edit the configuration settings specific to our Tinkla Unity branch for Tesla.","title":"Edit your Config"},{"location":"Comma_devkit/#flash-your-panda","text":"Since version 0.8.13-37, flashing of the panda code is done automatically every time there is a change in the code. If for any reason your devkit shows car offline while connected to your Tesla, and a reboot will not fix that, please follow the instructions below to flash both the bootloader and the code onto your panda. In your Tesla while it says \u201cCar Off\u201d connect your Comma devkit to your car harness (either using the Tinkla OBD-C Adapter for pre AP cars or the specific harness for your AP Tesla. Once the device fully boots up, go to Settings->Tinkla and scroll down to the bottom of the screen where you will see a button called \"Flash Panda\" Once you hit the Flash Panda button, a new (white) screen will open up and at the bottom will will find the Flash button. Select Flash and then wait for the software to flash the Panda. Once complete you will be prompted to reboot the Comma devkit","title":"Flash your Panda"},{"location":"Comma_devkit/#what-do-the-panda-led-colors-mean-on-the-back-of-the-devkit","text":"White: CAN send enabled Red: This is your panda's heartbeat(power). It fades in and out Green: Bad firmware or firmware flashing (only green, fast) Blue (static): CAN detected Blue (fades in and out): power saving","title":"What do the Panda LED colors mean? (on the back of the devkit)"},{"location":"Comma_devkit/#pre-ap-only-patch-your-epas","text":"In your Tesla while it says \u201cCar Off\u201d connect your Comma devkit to your car harness (etiher using the Tinkla OBD-C Adapter for pre AP cars or the specific harness for your AP Tesla. Once the device fully boots up, go to Settings->Tesla pre AP and scroll down to the bottom of the screen where you will see a button called \"Flash EPAS\" Once you hit the Flash EPAS button, a new (white) screen will open up and at the bottom will will find the Patch button. Press and hold the brake pedal so the car stays on. Note that during the process you might see some warning on the instrument cluster which will go away. Select Patch and then wait for the software to configure the EPAS. Once complete you will be prompted to reboot the Comma devkit. Also, at this point exit the car so that the car goes in Car Off mode. Once this happens your EPAS will be patched and ready to go.","title":"pre AP only: Patch your EPAS"},{"location":"Comma_devkit/#almost-there","text":"","title":"Almost there"},{"location":"Comma_devkit/#final-steps","text":"Finally, check here to learn more about all the controls, functions and features related to longitudinal control: Using adaptive cruise control","title":"Final steps"},{"location":"Comma_devkit/#first-open-pilot-drive","text":"Make sure the Comma devkit is mounted properly and connected to the Panda by following #Installing the Comma devkit Turn your car on and verify that the left side indicator shows \"Car Online\". If not, your panda is not flashed, see flashing instructions here Panda Flashing . Open Pilot should switch to \"drive mode\" and show the camera view with white lane marking Read up and understand the controls from Using adaptive cruise control","title":"First Open Pilot Drive"},{"location":"Comma_devkit/#if-your-car-is-recognized","text":"Calibration will increment at above 15mph. It will take less than 30 seconds to fully calibrate. If you move the mount, it's recommended to reset camera calibration under \"device settings\". When driving, Pull the Cruise Control Stalk to use Open Pilot","title":"If your car is recognized"},{"location":"Comma_devkit/#if-your-car-is-not-recognized","text":"If your Tesla is a pre AP Model S, did you turn on the toggle for**Force Pre AP Tesla Model S**in the**Tesla pre AP** settings ? Ask for help on the #tesla channel of the Comma.ai Discord","title":"If your car is not recognized"},{"location":"Comma_devkit/#experiencing-issues","text":"In case you use a Pedal and it just won't work, chances are it doesn't have Tesla firmware on it yet. You can flash it with this guide . On any other issue, please use the search function or ask us on Discord .","title":"Experiencing issues?"},{"location":"EON/","text":"The original EON is not supported in the latest releases of software from Open Pilot. The Tinkla Unity software will not run on the original EON. You can still find some old versions of Open Pilot for Tesla (v0.6.6 and v0.7.4) but you will not be able to take advantage of the newer features. Also the EON requires the EPAS harness to work on pre AP Tesla Model S. The EON is the name associated in the Comma.ai community to the device that sits in your windshield and does all the calculations for LKA and ACC. Comma.ai EON Dev Kit EON Dev Kit (or Fr EON) The EON is based on the Qualcom Snapdragon 821 mobile platform . Phones like One Plus 3T or Le Eco Le Pro3 have been used to create the Fr EON (the free EON). You can find some instructions here . If you choose to buy your EON already made, you can do so from Comma.ai store for $599 USD. Also, as we run more and more processing on the EON, it gets hotter and hotter. Some of us have opted to replace the original fan (which is also noisy when you're inside of a Tesla) with super quiet Noctua fans . $15 from Amazon and soldering two wires and you're good to go! We might have to actually double that to two Noctua fans in the near future. Also, keeping the phone screen off helps keeping the temperature low. I know, in the beginning one wants to see those lines matching the lines in the video, but after a while you stop paying attention to the screen. And if you have the IC integration all the data is on IC anyway. So turn that screen off and you will see the temperature drop about 15F. Code for power management of battery (only charging when below 60% and stopping the charge when it reaches 80%) has helped keep the battery temperature lower and hence the CPU cooler. And this is a free upgrade, as the code is already in my repo. Here is a helpful EON bash profile (.bash_profile). Installing the EON EON installation is pretty simple. Your main objective is to ensure the EON is level with the ground, and pointed as straight as you can get it. If you're uncomfortable \"eyeballing it,\" you may want to use: A measuring tape A roll of masking tape A friend to help Instructions Find a place at the bottom of the windshield, along the driver's side pillar that has a similar position on the passenger side (such as the place where the corner of the front hood meets the fender). With the tape starting from that point, mark 3 places along the side of the windshield. Use the edge of the masking tape to mark them. I personally used 3\" from the bottom, the top of the windshield and then about \u2153 from the bottom, \u2154 from the top. It does not matter what the measuring tape says, as long as it says the SAME distance on driver's and passenger's sides. Repeat the process on the other side of the windshield, ensuring you mark the same spots. measure the distance between one edge of the windshield and the other end, keeping the tape at each pair of marked points from before. use masking tape to mark the middle of the windshield. again, use the EDGE of the tape, not the center. Now use a long piece of masking tape to mark the center of the windshield from top to bottom. This (if you did everything correctly) will cover all 3 of your markers from before and provide a straight line. One edge of the masking tape is now the perfect middle of the windshield. Your mount will have to be aligned with that for a perfect position. Take a small piece of tape and mark the middle of the Go Pro mount. use a slightly longer piece than the go-pro (maybe \u00bc-\u00bd\" more on each side) and ensure it is straight and down the middle of the Go Pro. If, when looking from inside of the car, your tape is to the RIGHT of the center, then put the tape on the LEFT side of the Go Pro. Reverse if the other way. Using your EON without the mounting bracket, determine the location along the center of the windshield where you want it placed. Make sure the grove on the support is alongside the center of the windshield. use a small piece of masking tape to mark the upper part of the position where you want your EON to be. Remove the RED protective tape from the back of the 3M adhesive and be ready to place the Go Pro on the windshield. Align the masking tape we placed on the Go Pro mount on the inside with the masking tape we have on the outside of the windshield. They should not overlap at all AND you should not see light either. when you are confident on the position press hard on the mount. Remove all masking tape. You are done. You now have a perfectly centered, perfectly vertical EON. Hide the USB/antenna cable above the Headliner Pull your USB and GPS antenna cables from the footwell gap (where the OBDII port with a giraffe or giraffe-less cable, and Panda are) up to where the \"A\" pillar is... Follow the instructions to remove the air bag cover from the \"A\" pillar Pull the USB/antenna cables up the height of the \"A\" pillar across the the mirror holding them close to the headliner. Adjust the length and to reach where you will place your panda and your EON. The GPS receiver can be placed under the mirror*Frit*, it won't effect performance (the pattern is only to prevent glare on the mirror). Drape the receiver and USB plug ends over the rear view mirror. Move to the corner where the headliner and the removed airbag panel intersect, this corner is the easiest place to stick a pry tool... Using your pry tool lift the corner and move the pry-tool along the top of the windshield tucking the two wires into the headliner as you go. When you reach the mirror base, this can be lifted slightly route the GPS into the headliner crossing in between headliner and mirror base, while the EON USB cable can be routed down the front of the windshield to emerge at the bottom of the mirror base closer to the centre of the windshield. Once the cabling is tucked in the headliner, move back to the \"A\" pillar and tuck the cable into the pillar cover routing it down towards the door seal, then secure the pillar cover to conceal the wiring. Installing Open Pilot for Tesla Comma.ai doesn't support Tesla cars. That's why we maintain our own fork, which you will have to manually check out after setting up your EON. DON\u2019T INSTALL ON ANYTHING OTHER THAN A TESLA! (Someone bricked their Jeep trying.) Start with Stock Open Pilot Follow the instructions for setting up an EON with Open Pilot using these instructions: Comma EON Initial Setup with Open Pilot Then we will #Git the Tesla OP Fork Git the Tesla OP Fork SSH into your EON and execute the following commands (you need internet connectivity on your EON): cd /data rm -rf /data/openpilot git clone --depth 1 https://github.com/Bog Gyver/openpilot.git -b tesla_0.6.6 /data/openpilot reboot The first reboot will take around 20 minutes to set everything up. Edit your Config After the EON has booted you can edit your config , which now has been automatically created. At the top find user_handle = your_tinkla_username , set force fingerprint to True, and change your_tinkla_username to your Tinkla username (preferred, if available) or to your Discord handle. nano /data/bb_openpilot.cfg Make sure to set use_tesla_gps = True in case you're using a White Panda (Grey Panda has GPS built in). With GPS info of your drives you're helping Comma to improve their models (Open Pilot uploads your drives to their servers). Keep in mind that config changes only apply after rebooting the EON. Flash your Panda After installing or updating Open Pilot on your EON, you need to also update the software on your Panda. Here's how: In your Tesla while it says \u201cCar Off\u201d connect your Panda to your Giraffe rev B OBD (or EPAS OBD). Connect your EON to the Panda via USB. Then SSH in and run: cd /data/openpilot/panda/board killall boardd make clean make && sleep 1 && (make recover || make recover) && echo Success! Rebooting in 2s... && sleep 2 && reboot The kill command ensures that the EON stops regular communication to the Panda. That's also why a reboot is needed at the end. If any error occurs (which of course should not happen) the reboot will be skipped so you can troubleshoot. Assertion Errors should be fixed by rebooting EON and trying a second time. Optionally you may also power cycle your Panda by reseating it. Final steps Finally, check here to learn more about all the controls, functions and features related to longitudinal control: Using adaptive cruise control First Open Pilot Drive Make sure the EON is mounted properly and connected to the Panda by following #Installing the EON Make sure the EON has Internet access (either your wifi at home or a SIM card). Connect to a mobile hotspot if you don't have a SIM card1. Reboot your EON before turning your car on for good measure Turn your car on and verify that the Panda LEDs are pulsing red/blue/purple. If they are green, your panda is not flashed, see flashing instructions here Panda Flashing . Open Pilot should switch to \"drive mode\" and show the camera view with white lane marking Make sure that your EON is connected to the Internet or Calibration will not start Read up and understand the controls from Using adaptive cruise control IF YOUR CAR IS RECOGNIZED: Calibration will increment at above 15mph. It will take less than 30 seconds to fully calibrate. If you move the mount, it's recommended to reset camera calibration under \"device settings\". When driving, Double Pull the Cruise Control Stalk to use Open Pilot IF YOUR CAR IS NOT RECOGNIZED Ask for help on the #tesla channel of the Comma.ai Discord Experiencing issues? In case you use a Pedal and it just won't work, chances are it doesn't have Tesla firmware on it yet. You can flash it with this guide . Various other problems can be related to wiring, so double check each installation page, especially EPAS Harness . On any other issue, please use the search function or ask us on Discord .","title":"EON"},{"location":"EON/#eon-dev-kit-or-fr-eon","text":"The EON is based on the Qualcom Snapdragon 821 mobile platform . Phones like One Plus 3T or Le Eco Le Pro3 have been used to create the Fr EON (the free EON). You can find some instructions here . If you choose to buy your EON already made, you can do so from Comma.ai store for $599 USD. Also, as we run more and more processing on the EON, it gets hotter and hotter. Some of us have opted to replace the original fan (which is also noisy when you're inside of a Tesla) with super quiet Noctua fans . $15 from Amazon and soldering two wires and you're good to go! We might have to actually double that to two Noctua fans in the near future. Also, keeping the phone screen off helps keeping the temperature low. I know, in the beginning one wants to see those lines matching the lines in the video, but after a while you stop paying attention to the screen. And if you have the IC integration all the data is on IC anyway. So turn that screen off and you will see the temperature drop about 15F. Code for power management of battery (only charging when below 60% and stopping the charge when it reaches 80%) has helped keep the battery temperature lower and hence the CPU cooler. And this is a free upgrade, as the code is already in my repo. Here is a helpful EON bash profile (.bash_profile).","title":"EON Dev Kit (or Fr EON)"},{"location":"EON/#installing-the-eon","text":"EON installation is pretty simple. Your main objective is to ensure the EON is level with the ground, and pointed as straight as you can get it. If you're uncomfortable \"eyeballing it,\" you may want to use: A measuring tape A roll of masking tape A friend to help","title":"Installing the EON"},{"location":"EON/#instructions","text":"Find a place at the bottom of the windshield, along the driver's side pillar that has a similar position on the passenger side (such as the place where the corner of the front hood meets the fender). With the tape starting from that point, mark 3 places along the side of the windshield. Use the edge of the masking tape to mark them. I personally used 3\" from the bottom, the top of the windshield and then about \u2153 from the bottom, \u2154 from the top. It does not matter what the measuring tape says, as long as it says the SAME distance on driver's and passenger's sides. Repeat the process on the other side of the windshield, ensuring you mark the same spots. measure the distance between one edge of the windshield and the other end, keeping the tape at each pair of marked points from before. use masking tape to mark the middle of the windshield. again, use the EDGE of the tape, not the center. Now use a long piece of masking tape to mark the center of the windshield from top to bottom. This (if you did everything correctly) will cover all 3 of your markers from before and provide a straight line. One edge of the masking tape is now the perfect middle of the windshield. Your mount will have to be aligned with that for a perfect position. Take a small piece of tape and mark the middle of the Go Pro mount. use a slightly longer piece than the go-pro (maybe \u00bc-\u00bd\" more on each side) and ensure it is straight and down the middle of the Go Pro. If, when looking from inside of the car, your tape is to the RIGHT of the center, then put the tape on the LEFT side of the Go Pro. Reverse if the other way. Using your EON without the mounting bracket, determine the location along the center of the windshield where you want it placed. Make sure the grove on the support is alongside the center of the windshield. use a small piece of masking tape to mark the upper part of the position where you want your EON to be. Remove the RED protective tape from the back of the 3M adhesive and be ready to place the Go Pro on the windshield. Align the masking tape we placed on the Go Pro mount on the inside with the masking tape we have on the outside of the windshield. They should not overlap at all AND you should not see light either. when you are confident on the position press hard on the mount. Remove all masking tape. You are done. You now have a perfectly centered, perfectly vertical EON.","title":"Instructions"},{"location":"EON/#hide-the-usbantenna-cable-above-the-headliner","text":"Pull your USB and GPS antenna cables from the footwell gap (where the OBDII port with a giraffe or giraffe-less cable, and Panda are) up to where the \"A\" pillar is... Follow the instructions to remove the air bag cover from the \"A\" pillar Pull the USB/antenna cables up the height of the \"A\" pillar across the the mirror holding them close to the headliner. Adjust the length and to reach where you will place your panda and your EON. The GPS receiver can be placed under the mirror*Frit*, it won't effect performance (the pattern is only to prevent glare on the mirror). Drape the receiver and USB plug ends over the rear view mirror. Move to the corner where the headliner and the removed airbag panel intersect, this corner is the easiest place to stick a pry tool... Using your pry tool lift the corner and move the pry-tool along the top of the windshield tucking the two wires into the headliner as you go. When you reach the mirror base, this can be lifted slightly route the GPS into the headliner crossing in between headliner and mirror base, while the EON USB cable can be routed down the front of the windshield to emerge at the bottom of the mirror base closer to the centre of the windshield. Once the cabling is tucked in the headliner, move back to the \"A\" pillar and tuck the cable into the pillar cover routing it down towards the door seal, then secure the pillar cover to conceal the wiring.","title":"Hide the USB/antenna cable above the Headliner"},{"location":"EON/#installing-open-pilot-for-tesla","text":"Comma.ai doesn't support Tesla cars. That's why we maintain our own fork, which you will have to manually check out after setting up your EON. DON\u2019T INSTALL ON ANYTHING OTHER THAN A TESLA! (Someone bricked their Jeep trying.)","title":"Installing Open Pilot for Tesla"},{"location":"EON/#start-with-stock-open-pilot","text":"Follow the instructions for setting up an EON with Open Pilot using these instructions: Comma EON Initial Setup with Open Pilot Then we will #Git the Tesla OP Fork","title":"Start with Stock Open Pilot"},{"location":"EON/#git-the-tesla-op-fork","text":"SSH into your EON and execute the following commands (you need internet connectivity on your EON): cd /data rm -rf /data/openpilot git clone --depth 1 https://github.com/Bog Gyver/openpilot.git -b tesla_0.6.6 /data/openpilot reboot The first reboot will take around 20 minutes to set everything up.","title":"Git the Tesla OP Fork"},{"location":"EON/#edit-your-config","text":"After the EON has booted you can edit your config , which now has been automatically created. At the top find user_handle = your_tinkla_username , set force fingerprint to True, and change your_tinkla_username to your Tinkla username (preferred, if available) or to your Discord handle. nano /data/bb_openpilot.cfg Make sure to set use_tesla_gps = True in case you're using a White Panda (Grey Panda has GPS built in). With GPS info of your drives you're helping Comma to improve their models (Open Pilot uploads your drives to their servers). Keep in mind that config changes only apply after rebooting the EON.","title":"Edit your Config"},{"location":"EON/#flash-your-panda","text":"After installing or updating Open Pilot on your EON, you need to also update the software on your Panda. Here's how: In your Tesla while it says \u201cCar Off\u201d connect your Panda to your Giraffe rev B OBD (or EPAS OBD). Connect your EON to the Panda via USB. Then SSH in and run: cd /data/openpilot/panda/board killall boardd make clean make && sleep 1 && (make recover || make recover) && echo Success! Rebooting in 2s... && sleep 2 && reboot The kill command ensures that the EON stops regular communication to the Panda. That's also why a reboot is needed at the end. If any error occurs (which of course should not happen) the reboot will be skipped so you can troubleshoot. Assertion Errors should be fixed by rebooting EON and trying a second time. Optionally you may also power cycle your Panda by reseating it.","title":"Flash your Panda"},{"location":"EON/#final-steps","text":"Finally, check here to learn more about all the controls, functions and features related to longitudinal control: Using adaptive cruise control","title":"Final steps"},{"location":"EON/#first-open-pilot-drive","text":"Make sure the EON is mounted properly and connected to the Panda by following #Installing the EON Make sure the EON has Internet access (either your wifi at home or a SIM card). Connect to a mobile hotspot if you don't have a SIM card1. Reboot your EON before turning your car on for good measure Turn your car on and verify that the Panda LEDs are pulsing red/blue/purple. If they are green, your panda is not flashed, see flashing instructions here Panda Flashing . Open Pilot should switch to \"drive mode\" and show the camera view with white lane marking Make sure that your EON is connected to the Internet or Calibration will not start Read up and understand the controls from Using adaptive cruise control IF YOUR CAR IS RECOGNIZED: Calibration will increment at above 15mph. It will take less than 30 seconds to fully calibrate. If you move the mount, it's recommended to reset camera calibration under \"device settings\". When driving, Double Pull the Cruise Control Stalk to use Open Pilot IF YOUR CAR IS NOT RECOGNIZED Ask for help on the #tesla channel of the Comma.ai Discord Experiencing issues? In case you use a Pedal and it just won't work, chances are it doesn't have Tesla firmware on it yet. You can flash it with this guide . Various other problems can be related to wiring, so double check each installation page, especially EPAS Harness . On any other issue, please use the search function or ask us on Discord .","title":"First Open Pilot Drive"},{"location":"EON_bash_profile/","text":"A set of shortcuts for bash on EON Here is a set of shortcuts I used constantly on my EON, mainly when connected from the phone. Every time you will SSH it will take you automatically to /data/openpilot/car/tesla. Some notable ones: Commands fp - flashes your Panda and reboots EON on success (stops on error to show what went wrong) so \"text to search\" - Searches all source code for the text to search gcp - a sequence of commands that allows you to commit and push the code to the repo gcpa \"my commit comment\" - a sequence of commands that allows you to commit all changes and files and push to the repo killop - kills Open Pilot tmux session runop - runs Open Pilot in shell session; amazing for debug purposes mrw - mounts file system in read/write mode mro - mounts file system in read only mode Edit Sessions vic - vi carcontroller.py vis - vi carstate.py vii - vi interface.py vit - vi teslacan.py vips - vi safety_tesla.h Change Directory cdo - change directory to /data/openpilot cdp - change directory to /data/openpilot/ cdt - change directory to /data/openpilot/car/tesla cdm - change directory to /data/openpilot/car/modules Source Code To save this file on your EON in your home directory first you have to SSH into your EON and then execute the following commands: mount -o rw,remount /system nano ~/.bash_profile && source ~/.bash_profile The first command makes the file system writable. The second one opens the editor and the source command at the end ensures that you can use the commands we are about to add right away after saving the opened file. In the editor, replace all the contents with the following code and then exit and save: export EDITOR='vim' export TERM='xterm-256color' export PS1=\"\\u@\\h:\\[\\e [36m\\]\\w\\[\\e [0m\\]\\$ \" export PREFIX='/usr' export VALGRIND_LIB='/usr/lib/valgrind' # add these symlinks if you want export PYTHONPATH=\"/data/pythonpath\" export GIT_SSH_COMMAND=\"ssh -i /data/gitkey\" export LANG=\"en_US.UTF-8\" export VIMINIT='source $MYVIMRC' export MYVIMRC=\"/data/data/com.termux/files/home/.vimrc\" # Disable history writing export PYTHONSTARTUP=\"/data/data/com.termux/files/home/.pythonrc\" function fp() { cd /data/openpilot/panda/board killall boardd make clean make && sleep 1 && (make recover || make recover) && echo Success! Rebooting in 2s... && sleep 2 && reboot } function gcpa() { git update-index --assume-unchanged /data/openpilot/.gitignore git update-index --assume-unchanged /data/openpilot/launch_chffrplus.sh git update-index --assume-unchanged /data/openpilot/selfdrive/visiond/visiond git commit -a -m \"$1\" git push } function gcp() { git commit -m \"$1\" git push } function so() { grep -rni --color=auto --include=\\*.{py,h,c} /data/openpilot/ -e \"$1\" } cd /data/openpilot/selfdrive/car/tesla export PYTHONPATH=\"/data/openpilot/\" alias vic=\"vi /data/openpilot/selfdrive/car/tesla/carcontroller.py\" alias vis=\"vi /data/openpilot/selfdrive/car/tesla/carstate.py\" alias vii=\"vi /data/openpilot/selfdrive/car/tesla/interface.py\" alias vit=\"vi /data/openpilot/selfdrive/car/tesla/teslacan.py\" alias vio=\"vi /data/bb_openpilot.cfg\" alias killop=\"tmux kill-session -t comma\" alias vips=\"vi /data/openpilot/panda/board/safety/safety_tesla.h\" alias cdo=\"cd /data/openpilot\" alias cdp=\"cd /data/openpilot/panda/board\" alias cdt=\"cd /data/openpilot/selfdrive/car/tesla\" alias cdm=\"cd /data/openpilot/selfdrive/car/modules\" alias mrw=\"mount -o rw,remount /system\" alias mro=\"mount -o ro,remount /system\" alias runop=\"/data/data/com.termux/files/continue.sh\"","title":"EON Bash Profile"},{"location":"EON_bash_profile/#a-set-of-shortcuts-for-bash-on-eon","text":"Here is a set of shortcuts I used constantly on my EON, mainly when connected from the phone. Every time you will SSH it will take you automatically to /data/openpilot/car/tesla. Some notable ones:","title":"A set of shortcuts for bash on EON"},{"location":"EON_bash_profile/#commands","text":"fp - flashes your Panda and reboots EON on success (stops on error to show what went wrong) so \"text to search\" - Searches all source code for the text to search gcp - a sequence of commands that allows you to commit and push the code to the repo gcpa \"my commit comment\" - a sequence of commands that allows you to commit all changes and files and push to the repo killop - kills Open Pilot tmux session runop - runs Open Pilot in shell session; amazing for debug purposes mrw - mounts file system in read/write mode mro - mounts file system in read only mode","title":"Commands"},{"location":"EON_bash_profile/#edit-sessions","text":"vic - vi carcontroller.py vis - vi carstate.py vii - vi interface.py vit - vi teslacan.py vips - vi safety_tesla.h","title":"Edit Sessions"},{"location":"EON_bash_profile/#change-directory","text":"cdo - change directory to /data/openpilot cdp - change directory to /data/openpilot/ cdt - change directory to /data/openpilot/car/tesla cdm - change directory to /data/openpilot/car/modules","title":"Change Directory"},{"location":"EON_bash_profile/#source-code","text":"To save this file on your EON in your home directory first you have to SSH into your EON and then execute the following commands: mount -o rw,remount /system nano ~/.bash_profile && source ~/.bash_profile The first command makes the file system writable. The second one opens the editor and the source command at the end ensures that you can use the commands we are about to add right away after saving the opened file. In the editor, replace all the contents with the following code and then exit and save: export EDITOR='vim' export TERM='xterm-256color' export PS1=\"\\u@\\h:\\[\\e [36m\\]\\w\\[\\e [0m\\]\\$ \" export PREFIX='/usr' export VALGRIND_LIB='/usr/lib/valgrind' # add these symlinks if you want export PYTHONPATH=\"/data/pythonpath\" export GIT_SSH_COMMAND=\"ssh -i /data/gitkey\" export LANG=\"en_US.UTF-8\" export VIMINIT='source $MYVIMRC' export MYVIMRC=\"/data/data/com.termux/files/home/.vimrc\" # Disable history writing export PYTHONSTARTUP=\"/data/data/com.termux/files/home/.pythonrc\" function fp() { cd /data/openpilot/panda/board killall boardd make clean make && sleep 1 && (make recover || make recover) && echo Success! Rebooting in 2s... && sleep 2 && reboot } function gcpa() { git update-index --assume-unchanged /data/openpilot/.gitignore git update-index --assume-unchanged /data/openpilot/launch_chffrplus.sh git update-index --assume-unchanged /data/openpilot/selfdrive/visiond/visiond git commit -a -m \"$1\" git push } function gcp() { git commit -m \"$1\" git push } function so() { grep -rni --color=auto --include=\\*.{py,h,c} /data/openpilot/ -e \"$1\" } cd /data/openpilot/selfdrive/car/tesla export PYTHONPATH=\"/data/openpilot/\" alias vic=\"vi /data/openpilot/selfdrive/car/tesla/carcontroller.py\" alias vis=\"vi /data/openpilot/selfdrive/car/tesla/carstate.py\" alias vii=\"vi /data/openpilot/selfdrive/car/tesla/interface.py\" alias vit=\"vi /data/openpilot/selfdrive/car/tesla/teslacan.py\" alias vio=\"vi /data/bb_openpilot.cfg\" alias killop=\"tmux kill-session -t comma\" alias vips=\"vi /data/openpilot/panda/board/safety/safety_tesla.h\" alias cdo=\"cd /data/openpilot\" alias cdp=\"cd /data/openpilot/panda/board\" alias cdt=\"cd /data/openpilot/selfdrive/car/tesla\" alias cdm=\"cd /data/openpilot/selfdrive/car/modules\" alias mrw=\"mount -o rw,remount /system\" alias mro=\"mount -o ro,remount /system\" alias runop=\"/data/data/com.termux/files/continue.sh\"","title":"Source Code"},{"location":"EPAS_harness/","text":"Tesla Model S manufactured after 7/14 can use the A-pillar harness for Open Pilot. This harness takes minutes to install with only 1 screew to remove (in order to remove the A pillar cover). This new harness also simplifies the install of the Tesla Bosch Radar. Please ask in the discord group about availability and compatibility. IMPORTANT: Only use twisted-pair (and if possible shielded) cables for any CAN bus communication line, like the EPAS harness. Do not gamble with low quality cables. I recommend using Belden 8723 060-U500. Buy a pre-made EPAS Harness You can buy a pre-made EPAS Harness for use with a Giraffe from EV Cables Company (managed by @Star Log#6425) or skip the Giraffe and buy a Giraffeless cable from EV Cables Company or from Flyboy222pa on e Bay . Make your own EPAS Harness AWG Chart- You can follow @Deftdawg's EPAS creation video - When creating harnesses, please use the AWG chart to select the right wire gauge for your amps and length needs.- **NOTE:**It is not recommended to solder the JST2 plugs prior to fishing the wire into the driver footwell, so pause watching this video around the 34minute mark. The fishing process can easily destroy JST2 solder joints, so it's better to fish the wire first and then strip and solder the connections on when the wire is already into the cabin. - **SECOND NOTE:**There is another way to fish the EPAS cable through the firewall that will take a bit more work, and we don't currently have instructions written. If you'd like to help us document by performing this method and taking pictures, we'd appreciate it. - @Raf & @erflesby's guide here: Putting together a tesla EPAS wire harness Use velcro ties to secure the EPAS Cable to the existing harness in the car until you are sure everything works and you won't be needing to remove EPAS cable to work on it further. Fish the unfinished end of the cable under the washer container, then through the first hood metal support piece to the gap and then pull all of the slack through that gap. Reinsert the unfinished end back into the gap while keeping a finger or screw driver under it to keep the cable from falling down flat into the gap, this will help the cable not catch on where the second metal hood support meets the body as you push the cable towards the cabin. Once the cable emerges next to the door seal, pull it through from the cabin side and work it in behind the seal and the diagnostics port. Once the cable is in the gap between the driver left side footwell cover and the panel containing the OBD2 port, do your soldering of the JST2 connector. Prior to connecting the cabling, it's a good idea to test your EPAS cable for continuity and shorts [this is for your sanity, nothing bad will happen if you skip this]- **Shorts:**with the EPAS cable not plugged into the Car or the giraffe, put spare pins into 2 and 5 and touch your leads to them. If you get continuity make sure that the pins are not in contact, if they are not in contact double check the insulation on your solder connections to your JST2 plug. **Continuity:**with the spare pins still inserted in 2 and 5, jumper the JST2 plug end. Touch your leads to the 2 and 5 pins, if you get continuity make sure that the pins are not in contact, if they are not, then the cable is good. If you get no continuity, check that your solder connections to the JST2 plug haven't been broken. Plug your panda into your giraffe, plug your giraffe into your OBD2 plug... The car may give you some error messages about parking brake, etc... Connect your EON to the panda via the USB cable. Turn on tethering in the EON and connect to the EON hotspot, then ssh to 192.168.43.1 port 8022 using the Open Pilot RSA key and Flashing the Panda manually (currently automatic flashing is not supported). Once flashing is complete, you can disconnect your EON again, remove and reinsert your giraffe, hopefully the car should not complain (if it does let us know, but continue anyway). With a good cable, you can remove any testing jumpers and spare pins and connect to to the EPAS servo unit and connect it to the giraffe. Again the car should not complain. If you get an error that \"Power Assist is not available\", it means that your CAN \u00b1 pins (2 and 5) need to be flipped. You test this by cross wiring a JST2 connector to a JST2 plug and then inserting that between your JST2 connector and EPAS cable... If you do this, you may need to put the car in drive and manually feel if power steering works before the error clears (if steering is normal the error should clear, if not it will feel very heavy). The easiest way to resolve this is to disconnect the JST2 cable from the giraffe and use a small edge to lift the plastic lock tab while depressing the spring clip to release the JST2 connects and then insert black in the red position and vice-versa, the plug the JST2 cable back into the giraffe, put the car in drive and recheck the steering. Install the EON in your windshield. Mouser shopping list:- Female connector Female pins Male connector Male pins Rubber seal plug Rubber seal for cable You can follow @Robert Cotran's full OP installation (including the EPAS harness) video. Other resources: @Raf's Installing EPAS cable guide in pictures doc","title":"EPAS Harness"},{"location":"EPAS_harness/#buy-a-pre-made-epas-harness","text":"You can buy a pre-made EPAS Harness for use with a Giraffe from EV Cables Company (managed by @Star Log#6425) or skip the Giraffe and buy a Giraffeless cable from EV Cables Company or from Flyboy222pa on e Bay .","title":"Buy a pre-made EPAS Harness"},{"location":"EPAS_harness/#make-your-own-epas-harness","text":"AWG Chart- You can follow @Deftdawg's EPAS creation video - When creating harnesses, please use the AWG chart to select the right wire gauge for your amps and length needs.- **NOTE:**It is not recommended to solder the JST2 plugs prior to fishing the wire into the driver footwell, so pause watching this video around the 34minute mark. The fishing process can easily destroy JST2 solder joints, so it's better to fish the wire first and then strip and solder the connections on when the wire is already into the cabin. - **SECOND NOTE:**There is another way to fish the EPAS cable through the firewall that will take a bit more work, and we don't currently have instructions written. If you'd like to help us document by performing this method and taking pictures, we'd appreciate it. - @Raf & @erflesby's guide here: Putting together a tesla EPAS wire harness Use velcro ties to secure the EPAS Cable to the existing harness in the car until you are sure everything works and you won't be needing to remove EPAS cable to work on it further. Fish the unfinished end of the cable under the washer container, then through the first hood metal support piece to the gap and then pull all of the slack through that gap. Reinsert the unfinished end back into the gap while keeping a finger or screw driver under it to keep the cable from falling down flat into the gap, this will help the cable not catch on where the second metal hood support meets the body as you push the cable towards the cabin. Once the cable emerges next to the door seal, pull it through from the cabin side and work it in behind the seal and the diagnostics port. Once the cable is in the gap between the driver left side footwell cover and the panel containing the OBD2 port, do your soldering of the JST2 connector. Prior to connecting the cabling, it's a good idea to test your EPAS cable for continuity and shorts [this is for your sanity, nothing bad will happen if you skip this]- **Shorts:**with the EPAS cable not plugged into the Car or the giraffe, put spare pins into 2 and 5 and touch your leads to them. If you get continuity make sure that the pins are not in contact, if they are not in contact double check the insulation on your solder connections to your JST2 plug. **Continuity:**with the spare pins still inserted in 2 and 5, jumper the JST2 plug end. Touch your leads to the 2 and 5 pins, if you get continuity make sure that the pins are not in contact, if they are not, then the cable is good. If you get no continuity, check that your solder connections to the JST2 plug haven't been broken. Plug your panda into your giraffe, plug your giraffe into your OBD2 plug... The car may give you some error messages about parking brake, etc... Connect your EON to the panda via the USB cable. Turn on tethering in the EON and connect to the EON hotspot, then ssh to 192.168.43.1 port 8022 using the Open Pilot RSA key and Flashing the Panda manually (currently automatic flashing is not supported). Once flashing is complete, you can disconnect your EON again, remove and reinsert your giraffe, hopefully the car should not complain (if it does let us know, but continue anyway). With a good cable, you can remove any testing jumpers and spare pins and connect to to the EPAS servo unit and connect it to the giraffe. Again the car should not complain. If you get an error that \"Power Assist is not available\", it means that your CAN \u00b1 pins (2 and 5) need to be flipped. You test this by cross wiring a JST2 connector to a JST2 plug and then inserting that between your JST2 connector and EPAS cable... If you do this, you may need to put the car in drive and manually feel if power steering works before the error clears (if steering is normal the error should clear, if not it will feel very heavy). The easiest way to resolve this is to disconnect the JST2 cable from the giraffe and use a small edge to lift the plastic lock tab while depressing the spring clip to release the JST2 connects and then insert black in the red position and vice-versa, the plug the JST2 cable back into the giraffe, put the car in drive and recheck the steering. Install the EON in your windshield. Mouser shopping list:- Female connector Female pins Male connector Male pins Rubber seal plug Rubber seal for cable You can follow @Robert Cotran's full OP installation (including the EPAS harness) video. Other resources: @Raf's Installing EPAS cable guide in pictures doc","title":"Make your own EPAS Harness"},{"location":"Installed_OP_Instances/","text":"","title":"User Installations"},{"location":"Longitudinal_Control__ACC/","text":"Longitudinal control, or addaptive cruise control (ACC), is the capability to accelerate and slow down the car based on traffic, user max speed settings and map information integration (curvature, traffic, etc). This is an ongoing effort. These pre-AP cars lack electronic pedal control for (acceleration and braking) and radar . As of 2019 we have both software-only and hardware-based Adaptive Cruise Control. Without electric brakes (i Booster) the car only uses regenerative braking. This is not enough for suddent slowdowns. YOU MUST BE READY TO MANUALLY BRAKE AT ANY MOMENT. Vision Radar With Spam ACC The easiest setup is to use the vision only \"mock\" radar in Open Pilot. It works OK on highway if there are not many speed changes. The radar accuracy has improved since 0.5.11 but still has a 1-2 seconds delay vs real time. Also, it only tracks one car, the lead car. In order to use this for longitudinal control, we use CAN messages to create fake cruise stalk messages, increasing/decreasin the speed by 1 (half action) or 5 (full action). This creates the desired outcome but the speed changes are not very smooth. Also, the Tesla CC (and thus OP ACC using cruise stalk spamming) only works above 18 MPH (29 km/h). Vision Radar With Pedal The next step up is to replace the CC stalk spamming with a pedal interceptor . This allows speed control from 1 MPH (1.6 km/h) but you need to keep in mind that regenerative braking only works above 5 MPH (8 km/h). The cost of this updgrade is about $100.00 USD. Tesla Bosch Radar With Pedal Next upgrade would be to add a Tesla Bosch Radar . This increases the cars/objects tracked from 1 to 32 and allows real time monitoring of distance and relative speed for lead car and cars on the side lanes, increasing the smoothness and precision of the ACC. This is still limitted in braking power. If you have IC/CID integration , this feature shows up to 6 cars on the IC. The cost of this upgrade is about $500.00 USD and requires some extensive work (including removing and re-installing the front bumper). Tesla Bosch Radar With i Booster Final upgrade for ACC in order to obtaing full stop and go capabilities is to replace your old vacuum based braking system with an electronic braking system (i Booster). This code is in development as of May 2019. The cost for this upgrade is about $6-700.00 USD and requires root access and knowledge on how to flush your brake lines. This feature will give you full stop-n-go capability. Using Adaptive Cruise Control To repeat, without electric brakes (i Booster) the car only uses regenerative braking. This is not enough for sudden slowdowns. YOU MUST BE READY TO MANUALLY BRAKE AT ANY MOMENT. Adaptive Cruise Control allows the car to match speed with cars in front of you, slows down for turns based on Comma OP logic and also accelerates up to the MAX set speed. We have two types of adaptive cruise control based on your car configuration and options installed: ACC which is based on Tesla CC and PCC which uses the pedal interceptor . Follow these steps to use ACC: Press the cruise stalk IN so that the orange \"cruise control ready\" LED on the stalk is lit. Enable the ACC option on the EON screen if necessary. Accelerate above 18 MPH. Enable Open Pilot using a DOUBLE stalk pull (pull the cruise control stalk BACKWARDS TWICE in quick succession.) You will see the blue 'Cruise' icon appear on your dash. If you have IC/CID integration , the speed will be set to the speed limit for that road + the set offset in the Open Pilot screen in CID. ACC is now active. The initial max speed may be conservative. Press UP on the stalk to increase it. You can also accelerate manually to temporarily drive faster than current cruise speed. This will not disable ACC. Cruise is disabled if you brake or the car slows below 18 MPH. If ACC \"AUTO\" mode is enabled, manually accelerate above 18 MPH to resume. Follow these steps to use PCC: Press the cruise stalk IN so that the orange \"cruise control ready\" LED on the stalk is not lit (or set the Open Pilot Configuration File to use pedal always over CC) Enable the PCC option on the EON screen if necessary. Accelerate above 1 MPH. Enable Open Pilot using a DOUBLE stalk pull (pull the cruise control stalk BACKWARDS TWICE in quick succession.) You will see the blue 'Cruise' icon appear on your dash. If you have IC/CID integration , the speed will be set to the speed limit for that road + the set offset in the Open Pilot screen in CID. PCC is now active. The initial max speed may be conservative. Press UP on the stalk to increase it. Please note: As long as your foot touches the accelerator pedal, it will completely override PCC control. Cruise is disabled if you brake. Controls while ACC or PCC are enabled: Control Action Cruise stalk IN Master toggle for cruise control. Must be engaged for ACC to work, if you have a Pedal then engaged is for regular CC (no steering or speed control). Must be disengaged for PCC to work. When force_pedal_over_cc is true, PCC will be used regardless of the stalk position. Cruise stalk SINGLE PULL Enable OP steering. Disables ACC or PCC if it was active at the time of pulling. Cruise stalk DOUBLE PULL Enable OP steering and ACC or PCC and updates the max allowed cruise speed based on your current speed. Cruise stalk UP Increase cruise speed, increasing max allowed ACC/PCC speed if necessary. Cruise stalk DOWN Decrease cruise speed and max allowed ACC/PCC speed. Cruise stalk PUSH Disable Open Pilot (both steering and ACC/PCC). Cruise stalk DOUBLE \u00bd DOWN If the on screen ACC button has \"CC\" displaying, this will engage regular stock Tesla CC without auto-steer or regenerative braking. Brake pedal Pause both ACC/PCC and traditional cruise. Accelerator (When in AUTO mode) Accel over 18 MPH to unpause ACC. No effect on PCC. Overrides the long control for both ACC and PCC. On screen ACC/PCC button Toggle between \"FOLLOW\", \"AUTO\", and \"CC\" modes for ACC and \"FOLLOW\" and \"OP\" modes for PCC. **FOLLOW**mode attempts to match speed with cars in front of you and disengages if you steer or brake. **AUTO**mode does the same, but automatically re-engages when you accelerate again. **CC**mode for ACC will engage regular Cruise Control:Auto-Steering Offand Speed Control Off. **OP**mode is the built in Comma OP logic. On CID buttons Toggle between 2.5, 2, 1.5 and 1 second follow distance options. Using Regular Cruise Control Beginning in Open Pilot v0.6.6, we have brought back Tesla's stock Cruise Control as an option to maintain your car's speed when OP can not see well enough to stay engaged or where you deem conditions are not safe enough to allow OP to steer the car for you, i.e. when there is snow or rain and OP can't clearly detect the road lines. OP auto-detects if you have a Pedal interceptor and if you do, when you press the cruise stalk IN so that the orange \"cruise control ready\" LED on the stalk is lit, PCC is off and regular CC is available. YOU ARE IN CONTROL, not OP. Follow these steps to use stock CC: Press the cruise stalk IN so that the orange \"cruise control ready\" LED on the stalk is lit. (If you have a Pedal and Open Pilot Configuration File is set to use pedal always over CC, this won't work.) Set the ACC option on the EON screen to CC if necessary. (If you have a Pedal, CC should be selected by default) Accelerate above 18 MPH. Enable Cruise Control pressing DOUBLE \u00bd DOWN on the stalk (press the cruise control stalk halfway DOWN TWICE in quick succession.) You will see the blue 'Cruise' icon appear on your dash. If you have IC/CID integration , the speed will be set to the speed you were going. Tesla's stock CC is now active. Press UP or DOWN on the stalk to increase or decrease speed. Please note: CC is not controlled by Open Pilot, you are in control. Cruise is disabled if you brake.","title":"Longitudinal Control"},{"location":"Longitudinal_Control__ACC/#vision-radar-with-spam-acc","text":"The easiest setup is to use the vision only \"mock\" radar in Open Pilot. It works OK on highway if there are not many speed changes. The radar accuracy has improved since 0.5.11 but still has a 1-2 seconds delay vs real time. Also, it only tracks one car, the lead car. In order to use this for longitudinal control, we use CAN messages to create fake cruise stalk messages, increasing/decreasin the speed by 1 (half action) or 5 (full action). This creates the desired outcome but the speed changes are not very smooth. Also, the Tesla CC (and thus OP ACC using cruise stalk spamming) only works above 18 MPH (29 km/h).","title":"Vision Radar With Spam ACC"},{"location":"Longitudinal_Control__ACC/#vision-radar-with-pedal","text":"The next step up is to replace the CC stalk spamming with a pedal interceptor . This allows speed control from 1 MPH (1.6 km/h) but you need to keep in mind that regenerative braking only works above 5 MPH (8 km/h). The cost of this updgrade is about $100.00 USD.","title":"Vision Radar With Pedal"},{"location":"Longitudinal_Control__ACC/#tesla-bosch-radar-with-pedal","text":"Next upgrade would be to add a Tesla Bosch Radar . This increases the cars/objects tracked from 1 to 32 and allows real time monitoring of distance and relative speed for lead car and cars on the side lanes, increasing the smoothness and precision of the ACC. This is still limitted in braking power. If you have IC/CID integration , this feature shows up to 6 cars on the IC. The cost of this upgrade is about $500.00 USD and requires some extensive work (including removing and re-installing the front bumper).","title":"Tesla Bosch Radar With Pedal"},{"location":"Longitudinal_Control__ACC/#tesla-bosch-radar-with-i-booster","text":"Final upgrade for ACC in order to obtaing full stop and go capabilities is to replace your old vacuum based braking system with an electronic braking system (i Booster). This code is in development as of May 2019. The cost for this upgrade is about $6-700.00 USD and requires root access and knowledge on how to flush your brake lines. This feature will give you full stop-n-go capability.","title":"Tesla Bosch Radar With i Booster"},{"location":"Longitudinal_Control__ACC/#using-adaptive-cruise-control","text":"To repeat, without electric brakes (i Booster) the car only uses regenerative braking. This is not enough for sudden slowdowns. YOU MUST BE READY TO MANUALLY BRAKE AT ANY MOMENT. Adaptive Cruise Control allows the car to match speed with cars in front of you, slows down for turns based on Comma OP logic and also accelerates up to the MAX set speed. We have two types of adaptive cruise control based on your car configuration and options installed: ACC which is based on Tesla CC and PCC which uses the pedal interceptor . Follow these steps to use ACC: Press the cruise stalk IN so that the orange \"cruise control ready\" LED on the stalk is lit. Enable the ACC option on the EON screen if necessary. Accelerate above 18 MPH. Enable Open Pilot using a DOUBLE stalk pull (pull the cruise control stalk BACKWARDS TWICE in quick succession.) You will see the blue 'Cruise' icon appear on your dash. If you have IC/CID integration , the speed will be set to the speed limit for that road + the set offset in the Open Pilot screen in CID. ACC is now active. The initial max speed may be conservative. Press UP on the stalk to increase it. You can also accelerate manually to temporarily drive faster than current cruise speed. This will not disable ACC. Cruise is disabled if you brake or the car slows below 18 MPH. If ACC \"AUTO\" mode is enabled, manually accelerate above 18 MPH to resume. Follow these steps to use PCC: Press the cruise stalk IN so that the orange \"cruise control ready\" LED on the stalk is not lit (or set the Open Pilot Configuration File to use pedal always over CC) Enable the PCC option on the EON screen if necessary. Accelerate above 1 MPH. Enable Open Pilot using a DOUBLE stalk pull (pull the cruise control stalk BACKWARDS TWICE in quick succession.) You will see the blue 'Cruise' icon appear on your dash. If you have IC/CID integration , the speed will be set to the speed limit for that road + the set offset in the Open Pilot screen in CID. PCC is now active. The initial max speed may be conservative. Press UP on the stalk to increase it. Please note: As long as your foot touches the accelerator pedal, it will completely override PCC control. Cruise is disabled if you brake. Controls while ACC or PCC are enabled: Control Action Cruise stalk IN Master toggle for cruise control. Must be engaged for ACC to work, if you have a Pedal then engaged is for regular CC (no steering or speed control). Must be disengaged for PCC to work. When force_pedal_over_cc is true, PCC will be used regardless of the stalk position. Cruise stalk SINGLE PULL Enable OP steering. Disables ACC or PCC if it was active at the time of pulling. Cruise stalk DOUBLE PULL Enable OP steering and ACC or PCC and updates the max allowed cruise speed based on your current speed. Cruise stalk UP Increase cruise speed, increasing max allowed ACC/PCC speed if necessary. Cruise stalk DOWN Decrease cruise speed and max allowed ACC/PCC speed. Cruise stalk PUSH Disable Open Pilot (both steering and ACC/PCC). Cruise stalk DOUBLE \u00bd DOWN If the on screen ACC button has \"CC\" displaying, this will engage regular stock Tesla CC without auto-steer or regenerative braking. Brake pedal Pause both ACC/PCC and traditional cruise. Accelerator (When in AUTO mode) Accel over 18 MPH to unpause ACC. No effect on PCC. Overrides the long control for both ACC and PCC. On screen ACC/PCC button Toggle between \"FOLLOW\", \"AUTO\", and \"CC\" modes for ACC and \"FOLLOW\" and \"OP\" modes for PCC. **FOLLOW**mode attempts to match speed with cars in front of you and disengages if you steer or brake. **AUTO**mode does the same, but automatically re-engages when you accelerate again. **CC**mode for ACC will engage regular Cruise Control:Auto-Steering Offand Speed Control Off. **OP**mode is the built in Comma OP logic. On CID buttons Toggle between 2.5, 2, 1.5 and 1 second follow distance options.","title":"Using Adaptive Cruise Control"},{"location":"Longitudinal_Control__ACC/#using-regular-cruise-control","text":"Beginning in Open Pilot v0.6.6, we have brought back Tesla's stock Cruise Control as an option to maintain your car's speed when OP can not see well enough to stay engaged or where you deem conditions are not safe enough to allow OP to steer the car for you, i.e. when there is snow or rain and OP can't clearly detect the road lines. OP auto-detects if you have a Pedal interceptor and if you do, when you press the cruise stalk IN so that the orange \"cruise control ready\" LED on the stalk is lit, PCC is off and regular CC is available. YOU ARE IN CONTROL, not OP. Follow these steps to use stock CC: Press the cruise stalk IN so that the orange \"cruise control ready\" LED on the stalk is lit. (If you have a Pedal and Open Pilot Configuration File is set to use pedal always over CC, this won't work.) Set the ACC option on the EON screen to CC if necessary. (If you have a Pedal, CC should be selected by default) Accelerate above 18 MPH. Enable Cruise Control pressing DOUBLE \u00bd DOWN on the stalk (press the cruise control stalk halfway DOWN TWICE in quick succession.) You will see the blue 'Cruise' icon appear on your dash. If you have IC/CID integration , the speed will be set to the speed you were going. Tesla's stock CC is now active. Press UP or DOWN on the stalk to increase or decrease speed. Please note: CC is not controlled by Open Pilot, you are in control. Cruise is disabled if you brake.","title":"Using Regular Cruise Control"},{"location":"Main_Page/","text":"If you're looking for instructions for the old versions of Open Pilot that run on EON with white or gray panda, that page is availablehere. Talk: Feedback? Ideas? Comments? What is Open Pilot Open Pilot is open source software built to improve upon the existing driver assistance in most new cars on the road today. Now Open Pilot is available for pre-autopilot Tesla Model S as well as Tesla Model S/X with autopilot hardware 1 or 2. Currently, openpilot performs the functions of Adaptive Cruise Control (ACC), Automated Lane Centering (ALC), Forward Collision Warning (FCW) and Lane Departure Warning (LDW) for a growing variety of supported car makes, models and model years. In addition, while openpilot is engaged, a camera based Driver Monitoring (DM) feature alerts distracted and asleep drivers. See more about the vehicle integration and limitations. Getting Started Open Pilot for pre AP Tesla Model S Open Pilot for Tesla Model S/X with AP1 Open Pilot for Tesla Model S/X with AP2 Software Design History v0.9.6-61 (2024-01-17) * in line with latest code from Comma * adds support for C3X * adds fixes for \"steering temporary unavailable\" * you can now chose between OP/AP1/ACC on cars with AP: - OP - single stalk pull - AP - double stalk pull - ACC (Tesla stock) - up/down stalk movement * improved IC integration for cars with AP: - when OP/AP now engaged, IC shows AP data - when OP is engaed, IC shows OP data - when AP is engaged, IC shows AP data * option to ignore radar errors (useful in winter time when radar might get dirty) v0.8.13-57 (2022-11-17) * Fix pedal pressed message on ACC * Adjust top speed with speed limit for AP1 * Show set speed in lower right corner for RHD cars * Brake factor speed adjustable (1.1 below 70km/h, 1.4 above 110km/h) v0.8.13-56 (2022-11-08) * Sound files volume fix * Show TACC icon on IC for AP cars when OP is available * Display shutdown * Engage at 0 MPH (AP cars) * Fleet based speed (AP cars) * Slow down in turns based on Sunny Pilot * prevent i Booster from pressing both pedals * Improved acceleration handling for AP1 * Add message ID for the CAN Error * Reduce min accel to -4.5 * Improve follow distance * Better and smoother pedal with 4 profiles * Universal calibration tool for pedal interceptor * i Booster control improvement * Add 5 pedal profiles and 3 acceleration profiles for better long control wiht pedal * Add alert when maximum regen is used with pedal to show braking limit * Prevent PCC engagement with uncalibrated pedals * Cancel automatic lane change on blinker or wheel touch * Toggle to ignore wrong date/time on device * Increase steering angle limits on Panda * Fix Controls Mismatch when taking over steering v0.8.13-55 (2022-09-21) * Sound toggles (to mute certain sounds) * Sound files v0.8.13-54 (2022-09-19) * Add capabilities for Str params * Implement fixed fingerprint option to avoid fingerprinting issues v0.8.13-53 (2022-08-05) * i Booster ECU fixes * Try to fix Controls Mismatch issues * Add toggle for radar error with AP v0.8.13-52 (2022-08-05) * Reset Pedal PID on engagement * Toggle for Model S Performance for pedal (bug fix) * Pedal profile for MS Performance (bug fix) * Toggle to prevent auto updates * Toggle for dev unit (bug fix) * Autoresume speed from stand still v0.8.13-51 (2022-07-05) * new PID for pedal, including way to save state * toggle for Model S Performance for pedal * pedal profile for MS Performance v0.8.13-48 (2022-05-18) * limit i Booster travel to a max of 15mm (90psi on my car) * set Hold values for i Booster to 6.5mm (14psi) * change lane poly calculation logic for IC integrtion v0.8.13-47 (2022-05-11) do not send i Booster brake command when real accelerator pedal is pressed v0.8.13-46 (2022-05-10) do not send i Booster brake command when accelerator pedal is pressed increase brake hold value v0.8.13-45 (2022-05-09) update firmware for Vacuum Sensor board with brake release condition allow 0x553 for i Booster in panda allow 0x555 for IVS in panda v0.8.13-44 (2022-05-04) update firmware for Vacuum Sensor board fix CRC for i Booster v0.8.13-43 (2022-04-21) fix Pedal over CC issues when MCU2 or no Tinkla Buddy add firmware for Vacuum Sensor board fix CRC for i Booster v0.8.13-41 (2022-04-19) fix startup screen for C3 fix modem initialization for C3 (comma three: correctly set initial EPS bearer settings for AT&T sim cards) fix logic for enabling OP on pre AP MS add C3 Tinkla Splash v0.8.13-38 (2022-04-05) toggle to allow move of maps on left always show OP data on IC when engaged (AP1/AP2) Comma three support fix top speed indicator when using pedal with Tinkla Buddy v0.8.13-37 (2022-04-01) added configuration value for Hands On Level before human takeover fixed acceleration for AP1 stop-and-go which was limited at 1.2m/s^2 added testing toggle for full Long Control from planner vs actuator (AP1 or pre AP with i Booster) fixed release scripts fixed automatic flashing of panda code v0.8.13-34 (2022-03-27) full support for OP long control with AP1 follow distance is adjustable from CC stalk (when available) UI shows multiple road lanes when detected by OP fix bug where ACC would show disabled message after brake press even when not enabled variable acceleration based on speed for AP1 OP based long control improve pedal tune (by vandreykiv) fix variables default value not showing correctly in UI v0.8.13-33 (2022-03-26) new events to show when Standard CC is enabled added shutdown timeout for device (vandreykiv) v0.8.13-32 (2022-03-20) allows Standard CC (no LKAS) to be used with pedal when cruise enabled allows Standard CC (no LKAS) to be used with ACC by double press down allows for pedal to be used over CC (when setting enabled) v0.8.13-31 (2022-03-18) based on v0.8.13 (latest release from Comma) requires EON Gold/Black Panda or Comma two/three no need for EPAS harness Panda flash built in UI Pedal flash built in UI EPAS patching built in UI Radar VIN Learner built in UI radar behind nosecone setting as part of VIN Learn (set via UI) works with either human long control, ACC or pedal no more ssh to install or update no more ssh to change any settings, all done through UI automatic change top speed based on speed limit and offset (either units or %) automatic lane change with adjustable delay human steering override with adjustable delay for re-engagement steering never disengages unless you cancel it via stalk adjustable follow distance though UI allows for CC without LKAS when using Pedal pedal can be on either CAN0 or CAN2 (set via UI) support for i Booster ECU (in dev)","title":"Overview"},{"location":"Main_Page/#what-is-open-pilot","text":"Open Pilot is open source software built to improve upon the existing driver assistance in most new cars on the road today. Now Open Pilot is available for pre-autopilot Tesla Model S as well as Tesla Model S/X with autopilot hardware 1 or 2. Currently, openpilot performs the functions of Adaptive Cruise Control (ACC), Automated Lane Centering (ALC), Forward Collision Warning (FCW) and Lane Departure Warning (LDW) for a growing variety of supported car makes, models and model years. In addition, while openpilot is engaged, a camera based Driver Monitoring (DM) feature alerts distracted and asleep drivers. See more about the vehicle integration and limitations.","title":"What is Open Pilot"},{"location":"Main_Page/#getting-started","text":"Open Pilot for pre AP Tesla Model S Open Pilot for Tesla Model S/X with AP1 Open Pilot for Tesla Model S/X with AP2","title":"Getting Started"},{"location":"Main_Page/#software-design-history","text":"","title":"Software Design History"},{"location":"Main_Page/#v096-61-2024-01-17","text":"* in line with latest code from Comma * adds support for C3X * adds fixes for \"steering temporary unavailable\" * you can now chose between OP/AP1/ACC on cars with AP: - OP - single stalk pull - AP - double stalk pull - ACC (Tesla stock) - up/down stalk movement * improved IC integration for cars with AP: - when OP/AP now engaged, IC shows AP data - when OP is engaed, IC shows OP data - when AP is engaged, IC shows AP data * option to ignore radar errors (useful in winter time when radar might get dirty)","title":"v0.9.6-61 (2024-01-17)"},{"location":"Main_Page/#v0813-57-2022-11-17","text":"* Fix pedal pressed message on ACC * Adjust top speed with speed limit for AP1 * Show set speed in lower right corner for RHD cars * Brake factor speed adjustable (1.1 below 70km/h, 1.4 above 110km/h)","title":"v0.8.13-57 (2022-11-17)"},{"location":"Main_Page/#v0813-56-2022-11-08","text":"* Sound files volume fix * Show TACC icon on IC for AP cars when OP is available * Display shutdown * Engage at 0 MPH (AP cars) * Fleet based speed (AP cars) * Slow down in turns based on Sunny Pilot * prevent i Booster from pressing both pedals * Improved acceleration handling for AP1 * Add message ID for the CAN Error * Reduce min accel to -4.5 * Improve follow distance * Better and smoother pedal with 4 profiles * Universal calibration tool for pedal interceptor * i Booster control improvement * Add 5 pedal profiles and 3 acceleration profiles for better long control wiht pedal * Add alert when maximum regen is used with pedal to show braking limit * Prevent PCC engagement with uncalibrated pedals * Cancel automatic lane change on blinker or wheel touch * Toggle to ignore wrong date/time on device * Increase steering angle limits on Panda * Fix Controls Mismatch when taking over steering","title":"v0.8.13-56 (2022-11-08)"},{"location":"Main_Page/#v0813-55-2022-09-21","text":"* Sound toggles (to mute certain sounds) * Sound files","title":"v0.8.13-55 (2022-09-21)"},{"location":"Main_Page/#v0813-54-2022-09-19","text":"* Add capabilities for Str params * Implement fixed fingerprint option to avoid fingerprinting issues","title":"v0.8.13-54 (2022-09-19)"},{"location":"Main_Page/#v0813-53-2022-08-05","text":"* i Booster ECU fixes * Try to fix Controls Mismatch issues * Add toggle for radar error with AP","title":"v0.8.13-53 (2022-08-05)"},{"location":"Main_Page/#v0813-52-2022-08-05","text":"* Reset Pedal PID on engagement * Toggle for Model S Performance for pedal (bug fix) * Pedal profile for MS Performance (bug fix) * Toggle to prevent auto updates * Toggle for dev unit (bug fix) * Autoresume speed from stand still","title":"v0.8.13-52 (2022-08-05)"},{"location":"Main_Page/#v0813-51-2022-07-05","text":"* new PID for pedal, including way to save state * toggle for Model S Performance for pedal * pedal profile for MS Performance","title":"v0.8.13-51 (2022-07-05)"},{"location":"Main_Page/#v0813-48-2022-05-18","text":"* limit i Booster travel to a max of 15mm (90psi on my car) * set Hold values for i Booster to 6.5mm (14psi) * change lane poly calculation logic for IC integrtion","title":"v0.8.13-48 (2022-05-18)"},{"location":"Main_Page/#v0813-47-2022-05-11","text":"do not send i Booster brake command when real accelerator pedal is pressed","title":"v0.8.13-47 (2022-05-11)"},{"location":"Main_Page/#v0813-46-2022-05-10","text":"do not send i Booster brake command when accelerator pedal is pressed increase brake hold value","title":"v0.8.13-46 (2022-05-10)"},{"location":"Main_Page/#v0813-45-2022-05-09","text":"update firmware for Vacuum Sensor board with brake release condition allow 0x553 for i Booster in panda allow 0x555 for IVS in panda","title":"v0.8.13-45 (2022-05-09)"},{"location":"Main_Page/#v0813-44-2022-05-04","text":"update firmware for Vacuum Sensor board fix CRC for i Booster","title":"v0.8.13-44 (2022-05-04)"},{"location":"Main_Page/#v0813-43-2022-04-21","text":"fix Pedal over CC issues when MCU2 or no Tinkla Buddy add firmware for Vacuum Sensor board fix CRC for i Booster","title":"v0.8.13-43 (2022-04-21)"},{"location":"Main_Page/#v0813-41-2022-04-19","text":"fix startup screen for C3 fix modem initialization for C3 (comma three: correctly set initial EPS bearer settings for AT&T sim cards) fix logic for enabling OP on pre AP MS add C3 Tinkla Splash","title":"v0.8.13-41 (2022-04-19)"},{"location":"Main_Page/#v0813-38-2022-04-05","text":"toggle to allow move of maps on left always show OP data on IC when engaged (AP1/AP2) Comma three support fix top speed indicator when using pedal with Tinkla Buddy","title":"v0.8.13-38 (2022-04-05)"},{"location":"Main_Page/#v0813-37-2022-04-01","text":"added configuration value for Hands On Level before human takeover fixed acceleration for AP1 stop-and-go which was limited at 1.2m/s^2 added testing toggle for full Long Control from planner vs actuator (AP1 or pre AP with i Booster) fixed release scripts fixed automatic flashing of panda code","title":"v0.8.13-37 (2022-04-01)"},{"location":"Main_Page/#v0813-34-2022-03-27","text":"full support for OP long control with AP1 follow distance is adjustable from CC stalk (when available) UI shows multiple road lanes when detected by OP fix bug where ACC would show disabled message after brake press even when not enabled variable acceleration based on speed for AP1 OP based long control improve pedal tune (by vandreykiv) fix variables default value not showing correctly in UI","title":"v0.8.13-34 (2022-03-27)"},{"location":"Main_Page/#v0813-33-2022-03-26","text":"new events to show when Standard CC is enabled added shutdown timeout for device (vandreykiv)","title":"v0.8.13-33 (2022-03-26)"},{"location":"Main_Page/#v0813-32-2022-03-20","text":"allows Standard CC (no LKAS) to be used with pedal when cruise enabled allows Standard CC (no LKAS) to be used with ACC by double press down allows for pedal to be used over CC (when setting enabled)","title":"v0.8.13-32 (2022-03-20)"},{"location":"Main_Page/#v0813-31-2022-03-18","text":"based on v0.8.13 (latest release from Comma) requires EON Gold/Black Panda or Comma two/three no need for EPAS harness Panda flash built in UI Pedal flash built in UI EPAS patching built in UI Radar VIN Learner built in UI radar behind nosecone setting as part of VIN Learn (set via UI) works with either human long control, ACC or pedal no more ssh to install or update no more ssh to change any settings, all done through UI automatic change top speed based on speed limit and offset (either units or %) automatic lane change with adjustable delay human steering override with adjustable delay for re-engagement steering never disengages unless you cancel it via stalk adjustable follow distance though UI allows for CC without LKAS when using Pedal pedal can be on either CAN0 or CAN2 (set via UI) support for i Booster ECU (in dev)","title":"v0.8.13-31 (2022-03-18)"},{"location":"Map_Integration/","text":"About map integration","title":"Map Integration"},{"location":"MediaWiki_Bad_image_list/","text":"The format is as follows: Only list items (lines starting with *) are considered. The first link on a line must be a link to a bad file. Any subsequent links on the same line are considered to be exceptions, i.e. pages where the file may occur inline.","title":"MediaWiki Bad image list"},{"location":"MediaWiki_Group-contributors-member/","text":"contributor","title":"MediaWiki Group contributors member"},{"location":"MediaWiki_Group-contributors/","text":"Contributors","title":"MediaWiki Group contributors"},{"location":"MediaWiki_Grouppage-contributors/","text":"Project:Tinkla","title":"MediaWiki Grouppage contributors"},{"location":"Noctua_fan/","text":"The Noctua fan","title":"Cooling (Noctua)"},{"location":"Old_versions_of_OP/","text":"These instructions are for the old versions of Open Pilot that run on EON with white or gray panda. For the latest code and instructions please visit the main page. Talk: Feedback? Ideas? Comments? Services:Tokens|Vitals| Open VPN | Tesla Remote |Installs| ****Quick Start**** The Tesla Giraffe install guidewill start your journey to driving with Open Pilot. Plug your Comma.ai Panda into your Giraffe Thenmake and install the EPAS Harness. Install the EONin your windshield. Then install the Tesla version of OP Finally take your Tesla w/OP for a spin! And if you want to have IC integration (root access not required), now you can with Tinkla Buddy Getting Pre-AP up to AP1 Please read and understand the Disclaimers and Licensing. Out of the Box Well, just few easy mods to your Tesla and Open Pilot does a fairly good job at lane keep assist (LKA) and introduces a limited adaptive cruise control (ACC) based on the Open Pilot vision radar and just regenerative (regen) braking. Also, the system has a built in lane departure warning (LDW). All you need is: an EON, (not a comma two devkit) a Panda, a Tesla Giraffe, and a fairly easy to make EPAS harness. The cost for this complete setup is about $1,000 USD when getting all the components from Comma.ai and ebay (for the harness). Map Integration Comma.ai has brought map integrationfor longitudinal control (slowing down in turns for example) and there are plans to start bringing map info into lateral control as well to improve turning. Map integration is a key component for us too in order to improve the turning capabilities of the system. 0 - 18 MPH Upgrade The \"Out of the Box\" setup is the basic install for your tesla and can control your acceleration above 18 MPH. The Pedal Interceptoris a small unit that gets connected between your accelerator pedal on your Model S and the Giraffe. While the stock cruise control on Tesla only works above 18 MPH, with the pedal we can control speed down to 1 MPH (though the regen brakes only work above 5 MPH). The benefit of the pedal is better (and smoother) adaptive cruise control over just the stock Tesla cruise control. Tesla Radar Retrofit With a few more wires and a harness (plus some e Bay parts) you can add a Tesla Bosch radarto your pre-AP1 car. With full radar integration now available in Open Pilot, you get more accurate lead car detection which leads to a better ACC (still limited to regen braking). Also, if you have Instrument Cluster integration, now you can see 3 lanes full of cars on your IC. Instrument Cluster Tinkla Buddywill allow you to visualize the path and cars on your Tesla's Instrument Cluster. Stop-and-Go The next hurdle for us is integration with i Booster brakes for full stop and go traffic. This will require replacement of the standard vacuum brakes on your pre-AP1 Model S to the i Booster system that Tesla used in the AP1 cars and beyond. This will be about \\(500-\\) 800 in parts and some more involved mechanical work as you would need to flush your brakes and such. Also, root access is needed for this upgrade. Parking Sensors Finally, we will be integrating the AP1 style parking sensors into the Open Pilot code, allowing us to use the data from the 12 sensors to detect cars around us. This is one step we're hoping to start soon. Depending on where you source the sensors and harness, this alone can be somewhere between $500 and $1,500. AP1 Integration Once all this is done, we will be able to fully integrate with AP1 cars as well. With Tesla no longer paying any attention to the older Model S (the AP1 was based on the Mobile Eye platform that Tesla dumped in October 2016 and has received limited code updates ever since), the only option to get new features and functionality is by joining the Open Pilot group .","title":"Old Versions"},{"location":"Old_versions_of_OP/#getting-pre-ap-up-to-ap1","text":"Please read and understand the Disclaimers and Licensing.","title":"Getting Pre-AP up to AP1"},{"location":"Old_versions_of_OP/#out-of-the-box","text":"Well, just few easy mods to your Tesla and Open Pilot does a fairly good job at lane keep assist (LKA) and introduces a limited adaptive cruise control (ACC) based on the Open Pilot vision radar and just regenerative (regen) braking. Also, the system has a built in lane departure warning (LDW). All you need is: an EON, (not a comma two devkit) a Panda, a Tesla Giraffe, and a fairly easy to make EPAS harness. The cost for this complete setup is about $1,000 USD when getting all the components from Comma.ai and ebay (for the harness).","title":"Out of the Box"},{"location":"Old_versions_of_OP/#map-integration","text":"Comma.ai has brought map integrationfor longitudinal control (slowing down in turns for example) and there are plans to start bringing map info into lateral control as well to improve turning. Map integration is a key component for us too in order to improve the turning capabilities of the system.","title":"Map Integration"},{"location":"Old_versions_of_OP/#0-18-mph-upgrade","text":"The \"Out of the Box\" setup is the basic install for your tesla and can control your acceleration above 18 MPH. The Pedal Interceptoris a small unit that gets connected between your accelerator pedal on your Model S and the Giraffe. While the stock cruise control on Tesla only works above 18 MPH, with the pedal we can control speed down to 1 MPH (though the regen brakes only work above 5 MPH). The benefit of the pedal is better (and smoother) adaptive cruise control over just the stock Tesla cruise control.","title":"0 - 18 MPH Upgrade"},{"location":"Old_versions_of_OP/#tesla-radar-retrofit","text":"With a few more wires and a harness (plus some e Bay parts) you can add a Tesla Bosch radarto your pre-AP1 car. With full radar integration now available in Open Pilot, you get more accurate lead car detection which leads to a better ACC (still limited to regen braking). Also, if you have Instrument Cluster integration, now you can see 3 lanes full of cars on your IC.","title":"Tesla Radar Retrofit"},{"location":"Old_versions_of_OP/#instrument-cluster","text":"Tinkla Buddywill allow you to visualize the path and cars on your Tesla's Instrument Cluster.","title":"Instrument Cluster"},{"location":"Old_versions_of_OP/#stop-and-go","text":"The next hurdle for us is integration with i Booster brakes for full stop and go traffic. This will require replacement of the standard vacuum brakes on your pre-AP1 Model S to the i Booster system that Tesla used in the AP1 cars and beyond. This will be about \\(500-\\) 800 in parts and some more involved mechanical work as you would need to flush your brakes and such. Also, root access is needed for this upgrade.","title":"Stop-and-Go"},{"location":"Old_versions_of_OP/#parking-sensors","text":"Finally, we will be integrating the AP1 style parking sensors into the Open Pilot code, allowing us to use the data from the 12 sensors to detect cars around us. This is one step we're hoping to start soon. Depending on where you source the sensors and harness, this alone can be somewhere between $500 and $1,500.","title":"Parking Sensors"},{"location":"Old_versions_of_OP/#ap1-integration","text":"Once all this is done, we will be able to fully integrate with AP1 cars as well. With Tesla no longer paying any attention to the older Model S (the AP1 was based on the Mobile Eye platform that Tesla dumped in October 2016 and has received limited code updates ever since), the only option to get new features and functionality is by joining the Open Pilot group .","title":"AP1 Integration"},{"location":"OpenPilot_Configuration_File/","text":"This file is only used in the older versions of Tesla Openpilot (v0.6.6 and v0.7.4). The newer versions of Open Pilot based on Tesla Unity do all these configurations via the user interface. The Open Pilot settings for Tesla are located in /data/bb_openpilot.cfg . You can edit this file for your car and it will not be modified as you change through versions of OP. If new options are added in the future, just the new options and comments will be added to your config without changing your other edits. Loading...","title":"OP Config File"},{"location":"OpenPilot_for_Tesla_Model_S-X_with_AP1/","text":"Quick Start Purchase an AP1 Harnessharness from our online store and install it into your car Install the Comma two/Comma threein your windshield. Connect your Comma Three or Comma Two to the AP1 Harnessusing short USB-C cable that came with your Comma device. Install the Tesla version of OP Finally take your Tesla w/OP for a spin! Improving your AP1 Please read and understand the Disclaimers and Licensing. With Tesla no longer paying any attention to the older Model S (the AP1 was based on the Mobile Eye platform that Tesla dumped in October 2016 and has received limited code updates ever since), the only option to get new features and functionality is by joining our community and running the Tinkla branch of Open Pilot created specifically and only for Tesla vehicles.","title":"AP1 Model S/X"},{"location":"OpenPilot_for_Tesla_Model_S-X_with_AP1/#quick-start","text":"Purchase an AP1 Harnessharness from our online store and install it into your car Install the Comma two/Comma threein your windshield. Connect your Comma Three or Comma Two to the AP1 Harnessusing short USB-C cable that came with your Comma device. Install the Tesla version of OP Finally take your Tesla w/OP for a spin!","title":"Quick Start"},{"location":"OpenPilot_for_Tesla_Model_S-X_with_AP1/#improving-your-ap1","text":"Please read and understand the Disclaimers and Licensing. With Tesla no longer paying any attention to the older Model S (the AP1 was based on the Mobile Eye platform that Tesla dumped in October 2016 and has received limited code updates ever since), the only option to get new features and functionality is by joining our community and running the Tinkla branch of Open Pilot created specifically and only for Tesla vehicles.","title":"Improving your AP1"},{"location":"OpenPilot_for_Tesla_Model_S-X_with_AP2/","text":"Quick Start Buy an AP2 Harness from our online store Install the Comma three in your windshield. Connect your Comma Three to the AP2 Harness using long USB-C cable. Connect your Comma Three to the Black Panda and then to the second port of the AP2 Harness using long USB-C cable. [Comma_devkit#Installing_Open Pilot_for_Tesla|Install the Tesla version of OP]] Finally take your Tesla w/OP for a spin! Improving your AP2 Please read and understand the Disclaimers and Licensing . More info coming soon","title":"AP2 Model S/X"},{"location":"OpenPilot_for_Tesla_Model_S-X_with_AP2/#quick-start","text":"Buy an AP2 Harness from our online store Install the Comma three in your windshield. Connect your Comma Three to the AP2 Harness using long USB-C cable. Connect your Comma Three to the Black Panda and then to the second port of the AP2 Harness using long USB-C cable. [Comma_devkit#Installing_Open Pilot_for_Tesla|Install the Tesla version of OP]] Finally take your Tesla w/OP for a spin!","title":"Quick Start"},{"location":"OpenPilot_for_Tesla_Model_S-X_with_AP2/#improving-your-ap2","text":"Please read and understand the Disclaimers and Licensing . More info coming soon","title":"Improving your AP2"},{"location":"OpenPilot_for_preAP_Tesla_ModelS/","text":"****Quick Start**** The Tinkla OBD-C Adapter will start your journey to driving with Open Pilot. Check your car's OBD2 port for the correct pins. Install the EON Gold/Comma two/Comma three in your windshield. Plug your Comma Three , Comma Two or EON Gold with Black Panda into the Tinkla OBD-C Adapter using the USB-C cable that came with your Comma device + an approved USB-C Extension cable Install the Tesla version of OP Edit the Tesla specific configuration settings Flash and patch your panda and EPAS (pedal and radar too if installed) Finally take your Tesla w/OP for a spin! And if you want to have IC integration (root access not required), now you can with Tinkla Buddy Getting Pre-AP up to AP1 Please read and understand the Disclaimers and Licensing . Out of the Box Well, just few easy mods to your Tesla and Open Pilot does a fairly good job at lane keep assist (LKA) and introduces a limited adaptive cruise control (ACC) based on the Open Pilot vision radar and just regenerative (regen) braking. Also, the system has a built in lane departure warning (LDW). All you need is: a supported Comma device (Comma two, Comma three, EON Gold with Black Panda) a Tinkla OBD-C Adapter a 10ft Thunderbolt3 cable 0 - 18 MPH Upgrade The \"Out of the Box\" setup is the basic install for your tesla and can control your acceleration above 18 MPH. The Pedal Interceptor is a small unit that gets connected between your accelerator pedal on your Model S and the Giraffe. While the stock cruise control on Tesla only works above 18 MPH, with the pedal we can control speed down to 1 MPH (though the regen brakes only work above 5 MPH). The benefit of the pedal is better (and smoother) adaptive cruise control over just the stock Tesla cruise control. Tesla Radar Retrofit With a few more wires and a harness (plus some e Bay parts) you can add a Tesla Bosch radar to your pre-AP1 car. With full radar integration now available in Open Pilot, you get more accurate lead car detection which leads to a better ACC (still limited to regen braking). Also, if you have Instrument Cluster integration, now you can see the detected cars on your IC. Instrument Cluster Tinkla Buddywill allow you to visualize the path and cars on your Tesla's Instrument Cluster. Tinkla Buddy only works with the older MCU1 units. It does not work with MCU2 due to the changes Tesla made in the architecture of the device. Stop-and-Go The next hurdle for us is integration with i Booster brakes for full stop and go traffic. This will require replacement of the standard vacuum brakes on your pre-AP1 Model S to the i Booster system that Tesla used in the AP1 cars and beyond. This will be about \\(800-\\) 1000 in parts and some more involved mechanical work as you would need to flush your brakes and such. Code for the SGH Innovations' i Booster with ECU is being tested at the moment.","title":"preAP Model S"},{"location":"OpenPilot_for_preAP_Tesla_ModelS/#getting-pre-ap-up-to-ap1","text":"Please read and understand the Disclaimers and Licensing .","title":"Getting Pre-AP up to AP1"},{"location":"OpenPilot_for_preAP_Tesla_ModelS/#out-of-the-box","text":"Well, just few easy mods to your Tesla and Open Pilot does a fairly good job at lane keep assist (LKA) and introduces a limited adaptive cruise control (ACC) based on the Open Pilot vision radar and just regenerative (regen) braking. Also, the system has a built in lane departure warning (LDW). All you need is: a supported Comma device (Comma two, Comma three, EON Gold with Black Panda) a Tinkla OBD-C Adapter a 10ft Thunderbolt3 cable","title":"Out of the Box"},{"location":"OpenPilot_for_preAP_Tesla_ModelS/#0-18-mph-upgrade","text":"The \"Out of the Box\" setup is the basic install for your tesla and can control your acceleration above 18 MPH. The Pedal Interceptor is a small unit that gets connected between your accelerator pedal on your Model S and the Giraffe. While the stock cruise control on Tesla only works above 18 MPH, with the pedal we can control speed down to 1 MPH (though the regen brakes only work above 5 MPH). The benefit of the pedal is better (and smoother) adaptive cruise control over just the stock Tesla cruise control.","title":"0 - 18 MPH Upgrade"},{"location":"OpenPilot_for_preAP_Tesla_ModelS/#tesla-radar-retrofit","text":"With a few more wires and a harness (plus some e Bay parts) you can add a Tesla Bosch radar to your pre-AP1 car. With full radar integration now available in Open Pilot, you get more accurate lead car detection which leads to a better ACC (still limited to regen braking). Also, if you have Instrument Cluster integration, now you can see the detected cars on your IC.","title":"Tesla Radar Retrofit"},{"location":"OpenPilot_for_preAP_Tesla_ModelS/#instrument-cluster","text":"Tinkla Buddywill allow you to visualize the path and cars on your Tesla's Instrument Cluster. Tinkla Buddy only works with the older MCU1 units. It does not work with MCU2 due to the changes Tesla made in the architecture of the device.","title":"Instrument Cluster"},{"location":"OpenPilot_for_preAP_Tesla_ModelS/#stop-and-go","text":"The next hurdle for us is integration with i Booster brakes for full stop and go traffic. This will require replacement of the standard vacuum brakes on your pre-AP1 Model S to the i Booster system that Tesla used in the AP1 cars and beyond. This will be about \\(800-\\) 1000 in parts and some more involved mechanical work as you would need to flush your brakes and such. Code for the SGH Innovations' i Booster with ECU is being tested at the moment.","title":"Stop-and-Go"},{"location":"Panda/","text":"The newer Comma devkits (Comma two and Comma three) have a built-in Panda which is similar in hardware to the Black Panda. This article is for the older versions of Panda used with EON, like the White Panda and the Grey Panda. The Panda is an OBD II dongle created by Comma.ai. It allows the EON to talk to the car via CAN bus messaging. It supports 3 CAN buses, 2 LIN buses, and 1 GMLAN. The software for the Panda is opensource (and heavily modified for Tesla). When installed on a Tesla, the Panda (by itself) creates all the messages to emulate a DAS (the Auto Pilot computer) as well as to keep the Bosch radar talking. It has CAN0 connected to the Tesla Chassis CAN, CAN1 connected to the Bosch radar, and CAN2 connected to the Tesla EPAS (the electric power steering). There are two \"flavors\" of Panda: White Panda: $99 USD - The white panda has Wi Fi and USB capabilities and can work directly with your computer running Cabana . Grey Panda: $199 USD - The grey panda has high precision GPS (to be used with maps integration) but no wifi and can't be used with Cabana . Both versions are currently fully supported because we actually use the Tesla GPS for maps integration. I have both pandas due to the amount of development I do. I use the Grey Panda for driving the car and I use the White Panda for debugging/monitoring/reverse engineering CAN messages (in conjunction with an OBD II splitter). The Comma.ai Panda can be purchased from the Comma.ai store . Flashing the Panda After installing or updating Open Pilot on your EON, you need to also update the software on your Panda. Here's how: In your Tesla while it says \u201cCar Off\u201d connect your Panda to your Giraffe rev B OBD (or EPAS OBD). Connect your EON to the Panda via USB. Then SSH in and run: cd /data/openpilot/panda/board killall boardd make clean make && sleep 1 && (make recover || make recover) && echo Success! Rebooting in 2s... && sleep 2 && reboot The kill command ensures that the EON stops regular communication to the Panda. That's also why a reboot is needed at the end. If any error occurs (which of course should not happen) the reboot will be skipped so you can troubleshoot. Assertion Errors should be fixed by rebooting EON and trying a second time. Optionally you may also power cycle your Panda by reseating it. Future updates Tesla OP is constantly being developed, tweaked, and improved. Therefore, there will be future updates which will require pulling an update and flashing your Panda. To save ourselves some time, the developers have introduced an easy way to run the commands in the \"Flashing the Panda\" section. Simply follow the instructions in EON_bash_profile to setup a .bash_profile for your EON. Then you simply run the following command while your Tesla says \u201cCar Off\u201d and your Panda is connected to your Giraffe's OBD and your EON: fp","title":"Panda"},{"location":"Panda/#flashing-the-panda","text":"After installing or updating Open Pilot on your EON, you need to also update the software on your Panda. Here's how: In your Tesla while it says \u201cCar Off\u201d connect your Panda to your Giraffe rev B OBD (or EPAS OBD). Connect your EON to the Panda via USB. Then SSH in and run: cd /data/openpilot/panda/board killall boardd make clean make && sleep 1 && (make recover || make recover) && echo Success! Rebooting in 2s... && sleep 2 && reboot The kill command ensures that the EON stops regular communication to the Panda. That's also why a reboot is needed at the end. If any error occurs (which of course should not happen) the reboot will be skipped so you can troubleshoot. Assertion Errors should be fixed by rebooting EON and trying a second time. Optionally you may also power cycle your Panda by reseating it.","title":"Flashing the Panda"},{"location":"Panda/#future-updates","text":"Tesla OP is constantly being developed, tweaked, and improved. Therefore, there will be future updates which will require pulling an update and flashing your Panda. To save ourselves some time, the developers have introduced an easy way to run the commands in the \"Flashing the Panda\" section. Simply follow the instructions in EON_bash_profile to setup a .bash_profile for your EON. Then you simply run the following command while your Tesla says \u201cCar Off\u201d and your Panda is connected to your Giraffe's OBD and your EON: fp","title":"Future updates"},{"location":"Pedal_Interceptor/","text":"This page is describing the usage of the Tesla Pedal Interceptor with Tesla Unity. If you are looking to use the Pedal Interceptor with the older version of Tesla OP that works on EON, please look at the Pedal Interceptor for EON page. The Comma Pedal is used to provide advanced acceleration and regen braking capability on Tesla cars running Openpilot that do not have i Booster installed. Without electric brakes (i Booster) the car only uses regenerative braking. This is not enough for sudden slowdowns. YOU MUST BE READY TO MANUALLY BRAKE AT ANY MOMENT. What it Does The Comma Pedal is an accelerator pedal interceptor. It is a device that is inserted between a car's electronic accelerator pedal and the DU (Drive Unit). It detects the voltage from the accelerator pedal which represents the pedal's position. It then writes that same voltage back out to the DU as if the accelerator pedal had produced it. The Comma Pedal has 4 main systems: 2 Analog to Digital Convertors- This is used to read the voltage from the car's accelerator pedal into the Comma Pedal's processor. The accelerator pedal produces an output Voltage between 0 and 5 Volts. 2 Digital to Analog Convertors- This is used to send voltage back to the car's DU as if the accelerator pedal had produced it. 1 CAN Bus- The CAN Bus is the car's communication network. The Comma Pedal communicates with Openpilot using the CAN Bus. It connects to the Tinkla OBD-C Adapter. 1 USB- This is used to program and monitor the Comma Pedal, itself. When Openpilot is NOT engaged, the Comma Pedal reads the voltage from the accelerator pedal and just passes it along to the DU. When Openpilot IS engaged with longitudinal control , it gets the virtual accelerator pedal position from Openpilot and passes it on to the DU. The Comma Pedal is also constantly sending the physical accelerator pedal's position to the CAN bus for Openpilot to read. This way you can increase speed temporarily without having to adjust max speed or disengage longitudinal control. Obtaining a Comma Pedal You cannot buy a pre-built Comma Pedal from Comma. Fortunately we have a solution for you that only requires you to strip some wires and secure them with a screwdriver: you can find the Tinkla Pedal Interceptor here in the Tinkla Store you can find the connectors (limited quantity) here in the Tinkla Store You could also build it yourself (not recommended) or have one fabricated through a service like Macrofab . Wiring a Tesla Pedal If you purchased a Tinkla Pedal Interceptor together with the Tesla Pedal Connectors from our online store, you are in for a treat. Attaching the connectors to the pedal board is as easy as strip-twist-screw. The color codes for the Tesla Pedal Connectors wires are as follow: Red - 5V Black - GND Yellow - Sensor 1 Blue - Sensor 2 The above image shows the correct connections between the connectors and the Tinkla Pedal Interceptor board. In order to create your Tesla Pedal you need: 1x Comma Pedal board (for sources see above section) 1x box to hold the board if your Pedal doesn't already have a case (current ones ship with 3D printed cases). You will need to cut some small openings on the sides (and in front of the RJ45) if you use this one. 1x set of \"WPT-929\" connectors (actually Molex ) - fast shipping , slow shipping ~3ft of wire for the connectors in case your Pedal and connectors don't come with them (~AWG24) 1x SN-28B crimping tool (same one as used for EPAS cable - fast shipping , slow shipping ) 1x ethernet cable ~2ft (not crossover) Use the diagram to connect the female WPT-929 pedal connector to the IN side of the pedal board and the male WSP-929 connector to the OUT side of the pedal connector. Connecting the Pedal for Tinkla Unity Connecting the CAN BUS from the Pedal to the Tinkla OBD-C Adapteris done via the RJ45 port using a standard ethernet cable. Plug in the ethernet cable into the RJ45 port of the Pedal and the other end into the RJ45 port of the Tinkla OBD-C Adapter. Installing the Tesla Pedal To install the Pedal, there are two steps: connecting the board to the accelerator pedal connecting the board to the Tinkla OBD-C Adapter This video for a similar product shows you what you have to do in order to install the Pedal interceptor between the accelerator pedal and the car's existing connector. Take your time and watch the video first. The process is not complicated if you just follow it step by step. Once that is complete, connect your ethernet cable to the Pedal and the other end to the RJ45 port on the Tinkla OBD-C Adapter. Flashing the firmware for Tesla Pedal with Tesla Unity code Flashing via CAN With the introduction of Tesla Unity code, flashing the Tesla Pedal with the latest firmware is as easy as pressing a button in the Tesla pre AP settings page. To flash the latest firmware to your Tesla Pedal: Ensure your Pedal is installed in your vehicle and connected to the Tinkla OBD-C Adapteror to your specific harness. Ensure that all the settings are configured correctly for your pedal, especially enabling the pedal and setting up which CAN port it is connected to. Using the**Flash Pedal**button under the**Tesla pre AP**tab of settings start the firmware flashing process Before hitting the**Flash**button, ensure your car is on (in P - Park) and continue to keep your foot on the brake throughout the process. Hit the**Flash**button and the screen will show the progress. Your car might emit warnings and sounds during this process, which is normal. Once process is complete, allow the car to go in \"CAR OFF\" mode and reboot your Comma devkit. You are now ready to use your Tesla Pedal Interceptor. Flashing via USB Flashing via USB involves more steps and is only necessary if flashing via CAN is not possible. If you built your Pedal yourself or it was shipped without any firmware, it will boot in DFU mode. To know which mode you're in look at the LED on the Pedal board: no light = DFU mode, slow blink = normal flash mode, fast blink = normal operations. Entering Pedal Interceptor DFU Mode (image by @jfrux) To enter DFU mode, you will need a USB-A to USB-A cable and to remove the Pedal Interceptor from your car. Connect one end of the USB cable to the pedal interceptor, then jump the small pin indicated in the attached image to one of the pins labeled 5V with a small wire. While holding that jump wire, connect the Pedal Interceptor to your computer via USB. This usually takes two people, one to do the jump and one to plug the USB into the laptop. Always have the USB plugged into the Pedal first, then laptop (it makes your life a lot easier). For how to put the pedal interceptor in the DFU mode, follow the instructions for applying 5 Volt to a special point on the board . While in DFU mode, and connected to your computer running Mac OS or Linux, you can flash your pedal using the same Unity code from your computer. To do so you will need a local copy of the Unity code and to run few commands. Please see the sequence below that you have to run in a terminal window on your laptop. cd ~ rm -rf openpilot git clone https://github.com/boggyver/openpilot.git --depth 1 -b tesla_unity_release C2 cd openpilot/panda/board/pedal ./recover.sh Sometimes you have to issue the command multiple times until it completes successfully. With the updated bootloader you'll be able to flash future updates via CAN. Once done, unplug USB from the Pedal and install in car. Using the Tesla Pedal Without electric brakes (i Booster) the car only uses regenerative braking. This is not enough for suddent slowdowns. YOU MUST BE READY TO MANUALLY BRAKE AT ANY MOMENT. Out of the box, OP will use the Tesla CC (with stalk spamming) to control CC. This in our OP implementation is called Adaptive Cruise Control or ACC. CC on Tesla only works above 18 MPH (29 km/h). If you turn off the Tesla CC by pressing on the CC stalk, OP will switch to Tesla Pedal mode (PCC). This will provide you with smooth adaptive cruise control by sending the right commands to your Tesla Pedal. Tesla Pedal works down to 1 MPH, but be careful, regen brakes stop working at 5 MPH (8 km/h).","title":"Pedal Interceptor"},{"location":"Pedal_Interceptor/#what-it-does","text":"The Comma Pedal is an accelerator pedal interceptor. It is a device that is inserted between a car's electronic accelerator pedal and the DU (Drive Unit). It detects the voltage from the accelerator pedal which represents the pedal's position. It then writes that same voltage back out to the DU as if the accelerator pedal had produced it. The Comma Pedal has 4 main systems: 2 Analog to Digital Convertors- This is used to read the voltage from the car's accelerator pedal into the Comma Pedal's processor. The accelerator pedal produces an output Voltage between 0 and 5 Volts. 2 Digital to Analog Convertors- This is used to send voltage back to the car's DU as if the accelerator pedal had produced it. 1 CAN Bus- The CAN Bus is the car's communication network. The Comma Pedal communicates with Openpilot using the CAN Bus. It connects to the Tinkla OBD-C Adapter. 1 USB- This is used to program and monitor the Comma Pedal, itself. When Openpilot is NOT engaged, the Comma Pedal reads the voltage from the accelerator pedal and just passes it along to the DU. When Openpilot IS engaged with longitudinal control , it gets the virtual accelerator pedal position from Openpilot and passes it on to the DU. The Comma Pedal is also constantly sending the physical accelerator pedal's position to the CAN bus for Openpilot to read. This way you can increase speed temporarily without having to adjust max speed or disengage longitudinal control.","title":"What it Does"},{"location":"Pedal_Interceptor/#obtaining-a-comma-pedal","text":"You cannot buy a pre-built Comma Pedal from Comma. Fortunately we have a solution for you that only requires you to strip some wires and secure them with a screwdriver: you can find the Tinkla Pedal Interceptor here in the Tinkla Store you can find the connectors (limited quantity) here in the Tinkla Store You could also build it yourself (not recommended) or have one fabricated through a service like Macrofab .","title":"Obtaining a Comma Pedal"},{"location":"Pedal_Interceptor/#wiring-a-tesla-pedal","text":"If you purchased a Tinkla Pedal Interceptor together with the Tesla Pedal Connectors from our online store, you are in for a treat. Attaching the connectors to the pedal board is as easy as strip-twist-screw. The color codes for the Tesla Pedal Connectors wires are as follow: Red - 5V Black - GND Yellow - Sensor 1 Blue - Sensor 2 The above image shows the correct connections between the connectors and the Tinkla Pedal Interceptor board. In order to create your Tesla Pedal you need: 1x Comma Pedal board (for sources see above section) 1x box to hold the board if your Pedal doesn't already have a case (current ones ship with 3D printed cases). You will need to cut some small openings on the sides (and in front of the RJ45) if you use this one. 1x set of \"WPT-929\" connectors (actually Molex ) - fast shipping , slow shipping ~3ft of wire for the connectors in case your Pedal and connectors don't come with them (~AWG24) 1x SN-28B crimping tool (same one as used for EPAS cable - fast shipping , slow shipping ) 1x ethernet cable ~2ft (not crossover) Use the diagram to connect the female WPT-929 pedal connector to the IN side of the pedal board and the male WSP-929 connector to the OUT side of the pedal connector.","title":"Wiring a Tesla Pedal"},{"location":"Pedal_Interceptor/#connecting-the-pedal-for-tinkla-unity","text":"Connecting the CAN BUS from the Pedal to the Tinkla OBD-C Adapteris done via the RJ45 port using a standard ethernet cable. Plug in the ethernet cable into the RJ45 port of the Pedal and the other end into the RJ45 port of the Tinkla OBD-C Adapter.","title":"Connecting the Pedal for Tinkla Unity"},{"location":"Pedal_Interceptor/#installing-the-tesla-pedal","text":"To install the Pedal, there are two steps: connecting the board to the accelerator pedal connecting the board to the Tinkla OBD-C Adapter This video for a similar product shows you what you have to do in order to install the Pedal interceptor between the accelerator pedal and the car's existing connector. Take your time and watch the video first. The process is not complicated if you just follow it step by step. Once that is complete, connect your ethernet cable to the Pedal and the other end to the RJ45 port on the Tinkla OBD-C Adapter.","title":"Installing the Tesla Pedal"},{"location":"Pedal_Interceptor/#flashing-the-firmware-for-tesla-pedal-with-tesla-unity-code","text":"","title":"Flashing the firmware for Tesla Pedal with Tesla Unity code"},{"location":"Pedal_Interceptor/#flashing-via-can","text":"With the introduction of Tesla Unity code, flashing the Tesla Pedal with the latest firmware is as easy as pressing a button in the Tesla pre AP settings page. To flash the latest firmware to your Tesla Pedal: Ensure your Pedal is installed in your vehicle and connected to the Tinkla OBD-C Adapteror to your specific harness. Ensure that all the settings are configured correctly for your pedal, especially enabling the pedal and setting up which CAN port it is connected to. Using the**Flash Pedal**button under the**Tesla pre AP**tab of settings start the firmware flashing process Before hitting the**Flash**button, ensure your car is on (in P - Park) and continue to keep your foot on the brake throughout the process. Hit the**Flash**button and the screen will show the progress. Your car might emit warnings and sounds during this process, which is normal. Once process is complete, allow the car to go in \"CAR OFF\" mode and reboot your Comma devkit. You are now ready to use your Tesla Pedal Interceptor.","title":"Flashing via CAN"},{"location":"Pedal_Interceptor/#flashing-via-usb","text":"Flashing via USB involves more steps and is only necessary if flashing via CAN is not possible. If you built your Pedal yourself or it was shipped without any firmware, it will boot in DFU mode. To know which mode you're in look at the LED on the Pedal board: no light = DFU mode, slow blink = normal flash mode, fast blink = normal operations. Entering Pedal Interceptor DFU Mode (image by @jfrux) To enter DFU mode, you will need a USB-A to USB-A cable and to remove the Pedal Interceptor from your car. Connect one end of the USB cable to the pedal interceptor, then jump the small pin indicated in the attached image to one of the pins labeled 5V with a small wire. While holding that jump wire, connect the Pedal Interceptor to your computer via USB. This usually takes two people, one to do the jump and one to plug the USB into the laptop. Always have the USB plugged into the Pedal first, then laptop (it makes your life a lot easier). For how to put the pedal interceptor in the DFU mode, follow the instructions for applying 5 Volt to a special point on the board . While in DFU mode, and connected to your computer running Mac OS or Linux, you can flash your pedal using the same Unity code from your computer. To do so you will need a local copy of the Unity code and to run few commands. Please see the sequence below that you have to run in a terminal window on your laptop. cd ~ rm -rf openpilot git clone https://github.com/boggyver/openpilot.git --depth 1 -b tesla_unity_release C2 cd openpilot/panda/board/pedal ./recover.sh Sometimes you have to issue the command multiple times until it completes successfully. With the updated bootloader you'll be able to flash future updates via CAN. Once done, unplug USB from the Pedal and install in car.","title":"Flashing via USB"},{"location":"Pedal_Interceptor/#using-the-tesla-pedal","text":"Without electric brakes (i Booster) the car only uses regenerative braking. This is not enough for suddent slowdowns. YOU MUST BE READY TO MANUALLY BRAKE AT ANY MOMENT. Out of the box, OP will use the Tesla CC (with stalk spamming) to control CC. This in our OP implementation is called Adaptive Cruise Control or ACC. CC on Tesla only works above 18 MPH (29 km/h). If you turn off the Tesla CC by pressing on the CC stalk, OP will switch to Tesla Pedal mode (PCC). This will provide you with smooth adaptive cruise control by sending the right commands to your Tesla Pedal. Tesla Pedal works down to 1 MPH, but be careful, regen brakes stop working at 5 MPH (8 km/h).","title":"Using the Tesla Pedal"},{"location":"Pedal_Interceptor_EON/","text":"The Comma Pedal is used to provide advanced acceleration and regen braking capability on Tesla cars running Openpilot that do not have i Booster installed. Without electric brakes (i Booster) the car only uses regenerative braking. This is not enough for sudden slowdowns. YOU MUST BE READY TO MANUALLY BRAKE AT ANY MOMENT. What it Does The Comma Pedal is an accelerator pedal interceptor. It is a device that is inserted between a car's electronic accelerator pedal and the DU (Drive Unit). It detects the voltage from the accelerator pedal which represents the pedal's position. It then writes that same voltage back out to the DU as if the accelerator pedal had produced it. The Comma Pedal has 4 main systems: 2 Analog to Digital Convertors- This is used to read the voltage from the car's accelerator pedal into the Comma Pedal's processor. The accelerator pedal produces an output Voltage between 0 and 5 Volts. 2 Digital to Analog Convertors- This is used to send voltage back to the car's DU as if the accelerator pedal had produced it. 1 CAN Bus- The CAN Bus is the car's communication network. The Comma Pedal communicates with Openpilot using the CAN Bus. It connects to the Tesla Giraffe on CAN3. 1 USB- This is used to program and monitor the Comma Pedal, itself. When Openpilot is NOT engaged, the Comma Pedal reads the voltage from the accelerator pedal and just passes it along to the DU. When Openpilot IS engaged with longitudinal control , it gets the virtual accelerator pedal position from Openpilot and passes it on to the DU. The Comma Pedal is also constantly sending the physical accelerator pedal's position to the CAN bus for Openpilot to read. This way you can increase speed temporarily without having to adjust max speed or disengage longitudinal control. Obtaining a Comma Pedal You cannot buy a pre-built Comma Pedal from Comma. Fortunately there are other people in the community manufacturing and selling them: https://www.ebay.com/itm/comma-pedal-/224754086101?mkcid=16&mkevt=1&_trksid=p2349624.m46890.l49286&mkrid=711-127632-2357-0 for the pedal hardware https://www.ebay.com/itm/Tesla-Openpilot-Pedal-Interceptor-Connectors-/124807073952?mkcid=16&mkevt=1&_trksid=p2349624.m46890.l49286&mkrid=711-127632-2357-0 for the Tesla specific connectors Since they're currently always sold out as soon as new ones get in stock, you could also build it yourself (not recommended) or have one fabricated through a service like Macrofab . Wiring a Tesla Pedal In order to create your Tesla Pedal you need: 1x Comma Pedal board (for sources see above section) 1x box to hold the board if your Pedal doesn't already have a case (current ones ship with 3D printed cases). You will need to cut some small openings on the sides (and in front of the RJ45) if you use this one. 1x set of \"WPT-929\" connectors (actually Molex ) - fast shipping , slow shipping ~3ft of wire for the connectors in case your Pedal and connectors don't come with them (~AWG24) 1x SN-28B crimping tool (same one as used for EPAS cable - fast shipping , slow shipping ) **EITHER**1x ethernet cable ~2ft (not crossover) for current gen Pedal and Tesla Giraffe (rev B) which have RJ45 ports **OR**1x JST2 male and 1x female connector plus some twisted pair wire if RJ45 is not present. You can buy this and cut it and you're done (not twisted but will work just fine) Use the diagram to connect the female WPT-929 pedal connector to the IN side of the pedal board and the male WSP-929 connector to the OUT side of the pedal connector. Connecting the Pedal for Old EON with Giraffe or Harness Connecting the CAN BUS from the Pedal to the Giraffe depends on your setup, as explained in the parts list above. Via RJ45: Plug in the ethernet cable into the RJ45 port of the Pedal and the other end into the RJ45 port of the Giraffe that is labelled with \"comma\".Via JST2: Solder positions 3 and 6 of the fake-ethernet port of the Pedal board to the two JST2 connectors (male and female) with enough length to reach EPAS cable/Giraffe. We need both because you will plug the female one in the Giraffe's EPAS connector and then the EPAS Harness into the male JST2. Red should be CAN+ and black should be CAN- (that's the convention also used in the image showing the CAN wire soldered to pins 3 and 6 of the fake ethernet port on the Pedal board). Installing the Tesla Pedal for old EON setup with Giraffe or Harness To install the Pedal, there are two steps: connecting the board to the accelerator pedal connecting the board to the Tesla Giraffe for old EON This video for a similar product shows you what you have to do in order to install the Pedal interceptor between the accelerator pedal and the car's existing connector. Take your time and watch the video first. The process is not complicated if you just follow it step by step. Once that is complete, connect your ethernet cable to the Pedal and the other end to the Giraffe's RJ45 Port labelled \"comma\". Older Giraffes and Pedals without RJ45 ports connect over JST2: Disconnect the EPAS cable from the Tesla Giraffe and connect the female JST2 from your Pedal to the Giraffe. Then connect the EPAS cable to the male JST2 from your Pedal. If your Pedal needs to be flashed, don't put your trim back on just yet. Instead connect the Giraffe and Panda to the car and and follow instructions below. This makes it easier to get to the Pedal in case necessary. Once you're ready to cover everything up, make sure you don't forget to reconnect the footwell LED and that all your cables are positioned well, so that they don't rub against sharp edges and that there's no tension on them. Flashing the firmware for Tesla Pedal for older EON versions You have to use a Tesla specific firmware on the Pedal in order to work for Tesla. You can flash the Pedal directly from the EON, this is why**we highly recommend installing the Pedal in your car before flashing (see section above)**. If, for whatever reason, you need to flash your Pedal outside the car, use below instructions in conjunction with this guide by @jfrux Step 1: Get the code SSH into your EON, then download our latest Pedal code (use git pull in /data/panda if you already cloned the repo). git clone --depth 1 https://github.com/Bog Gyver/panda.git -b tesla_pedal /data/panda Step 2: Prepare your hardware Connect your EON to your car (Panda) if not already done. Then press the brake pedal to power up the Pedal. Now kill all OP processes on the EON to free the CAN bus and change to the directory where all flashing related files are located. tmux kill-session -t comma cd /data/panda/board/pedal Step 3.1: Flashing via CAN Flashing via CAN1is the recommended (easy) way but**only possible with Pedals ordered after 7 th Sept. 2019**. Older Pedals and those built yourself need to follow Step 3.2 instead. They will then also gain the ability to be flashed via CAN for future updates. Run and wait for this command to finish: make canflash In case flashing is stuck at checking for flasher , press CTRL+C to abort and re run above command. Power cycling Panda by reseating it may also help. If CAN flashing doesn't work for whatever reason you can always try Step 3.2 as a fallback. 1Original resource: Comma Pedal: Updating the Firmware over CAN by @jfrux Step 3.2: Flashing via USB Flashing via USB involves more steps and is only necessary if flashing via CAN is not possible yet (see explanation in Step 3.1). If you built your Pedal yourself or it was shipped without any firmware, it will boot in DFU mode. To know which mode you're in look at the LED on the Pedal board: no light = DFU mode, slow blink = normal flash mode, fast blink = normal operations. If your Pedal LED is blinking, you can put your Pedal into DFU mode via CAN: ./enter_canloader.py --recover It's possible that the LED won't turn off on the first try, but usually does so after entering the command a second time*. In case you get an Assertion Error, reboot EON and start over from step 2. Also power cycle your Panda by reseating it if the issue persists.While in DFU mode, connect your EON via USB to the Pedal (unplug from Panda or use a second USB cable) ensuring that the car does not go in Car Off mode (don't lift your butt off the driver's seat) since Pedal would lose power and therefore also DFU mode. Now run this command to flash the bootloader and operational code: make recover Sometimes you have to issue the command multiple times until it completes successfully. With the updated bootloader you'll be able to flash future updates via CAN. Once done, unplug USB from the Pedal and back into the Panda. *If you can't or don't want to put the Pedal into DFU mode via CAN, you can also do so by applying 5 Volt to a special point on the board while connecting it to USB (to power it up). Car must obviously be off or disconnected for this. That usually requires 2 people: one to keep the jumper for 5V in place and the other to connect the USB. Step 4: Cleanup If all went good you can reboot EON to restore the OP processes that were closed in step 2. Once the pedal is back in operational mode (rapid LED blinking), PRND letters should be white. If it's not, first try to reboot pedal: Open the driver door while not sitting in the driver seat to make the car go in \"Car Off\" mode, then step on the brake to turn it back on. If you still experience red PRND letters after a successful flash and pedal being in operational mode, it means a bad connection between the car and the accelerator, so check your pedal Molex connectors. Using the Tesla Pedal Without electric brakes (i Booster) the car only uses regenerative braking. This is not enough for suddent slowdowns. YOU MUST BE READY TO MANUALLY BRAKE AT ANY MOMENT. Out of the box, OP will use the Tesla CC (with stalk spamming) to control CC. This in our OP implementation is called Adaptive Cruise Control or ACC. CC on Tesla only works above 18 MPH (29 km/h). If you turn off the Tesla CC by pressing on the CC stalk, OP will switch to Tesla Pedal mode (PCC). This will provide you with smooth adaptive cruise control by sending the right commands to your Tesla Pedal. Tesla Pedal works down to 1 MPH, but be careful, regen brakes stop working at 5 MPH (8 km/h).","title":"Pedal (EON)"},{"location":"Pedal_Interceptor_EON/#what-it-does","text":"The Comma Pedal is an accelerator pedal interceptor. It is a device that is inserted between a car's electronic accelerator pedal and the DU (Drive Unit). It detects the voltage from the accelerator pedal which represents the pedal's position. It then writes that same voltage back out to the DU as if the accelerator pedal had produced it. The Comma Pedal has 4 main systems: 2 Analog to Digital Convertors- This is used to read the voltage from the car's accelerator pedal into the Comma Pedal's processor. The accelerator pedal produces an output Voltage between 0 and 5 Volts. 2 Digital to Analog Convertors- This is used to send voltage back to the car's DU as if the accelerator pedal had produced it. 1 CAN Bus- The CAN Bus is the car's communication network. The Comma Pedal communicates with Openpilot using the CAN Bus. It connects to the Tesla Giraffe on CAN3. 1 USB- This is used to program and monitor the Comma Pedal, itself. When Openpilot is NOT engaged, the Comma Pedal reads the voltage from the accelerator pedal and just passes it along to the DU. When Openpilot IS engaged with longitudinal control , it gets the virtual accelerator pedal position from Openpilot and passes it on to the DU. The Comma Pedal is also constantly sending the physical accelerator pedal's position to the CAN bus for Openpilot to read. This way you can increase speed temporarily without having to adjust max speed or disengage longitudinal control.","title":"What it Does"},{"location":"Pedal_Interceptor_EON/#obtaining-a-comma-pedal","text":"You cannot buy a pre-built Comma Pedal from Comma. Fortunately there are other people in the community manufacturing and selling them: https://www.ebay.com/itm/comma-pedal-/224754086101?mkcid=16&mkevt=1&_trksid=p2349624.m46890.l49286&mkrid=711-127632-2357-0 for the pedal hardware https://www.ebay.com/itm/Tesla-Openpilot-Pedal-Interceptor-Connectors-/124807073952?mkcid=16&mkevt=1&_trksid=p2349624.m46890.l49286&mkrid=711-127632-2357-0 for the Tesla specific connectors Since they're currently always sold out as soon as new ones get in stock, you could also build it yourself (not recommended) or have one fabricated through a service like Macrofab .","title":"Obtaining a Comma Pedal"},{"location":"Pedal_Interceptor_EON/#wiring-a-tesla-pedal","text":"In order to create your Tesla Pedal you need: 1x Comma Pedal board (for sources see above section) 1x box to hold the board if your Pedal doesn't already have a case (current ones ship with 3D printed cases). You will need to cut some small openings on the sides (and in front of the RJ45) if you use this one. 1x set of \"WPT-929\" connectors (actually Molex ) - fast shipping , slow shipping ~3ft of wire for the connectors in case your Pedal and connectors don't come with them (~AWG24) 1x SN-28B crimping tool (same one as used for EPAS cable - fast shipping , slow shipping ) **EITHER**1x ethernet cable ~2ft (not crossover) for current gen Pedal and Tesla Giraffe (rev B) which have RJ45 ports **OR**1x JST2 male and 1x female connector plus some twisted pair wire if RJ45 is not present. You can buy this and cut it and you're done (not twisted but will work just fine) Use the diagram to connect the female WPT-929 pedal connector to the IN side of the pedal board and the male WSP-929 connector to the OUT side of the pedal connector.","title":"Wiring a Tesla Pedal"},{"location":"Pedal_Interceptor_EON/#connecting-the-pedal-for-old-eon-with-giraffe-or-harness","text":"Connecting the CAN BUS from the Pedal to the Giraffe depends on your setup, as explained in the parts list above. Via RJ45: Plug in the ethernet cable into the RJ45 port of the Pedal and the other end into the RJ45 port of the Giraffe that is labelled with \"comma\".Via JST2: Solder positions 3 and 6 of the fake-ethernet port of the Pedal board to the two JST2 connectors (male and female) with enough length to reach EPAS cable/Giraffe. We need both because you will plug the female one in the Giraffe's EPAS connector and then the EPAS Harness into the male JST2. Red should be CAN+ and black should be CAN- (that's the convention also used in the image showing the CAN wire soldered to pins 3 and 6 of the fake ethernet port on the Pedal board).","title":"Connecting the Pedal for Old EON with Giraffe or Harness"},{"location":"Pedal_Interceptor_EON/#installing-the-tesla-pedal-for-old-eon-setup-with-giraffe-or-harness","text":"To install the Pedal, there are two steps: connecting the board to the accelerator pedal connecting the board to the Tesla Giraffe for old EON This video for a similar product shows you what you have to do in order to install the Pedal interceptor between the accelerator pedal and the car's existing connector. Take your time and watch the video first. The process is not complicated if you just follow it step by step. Once that is complete, connect your ethernet cable to the Pedal and the other end to the Giraffe's RJ45 Port labelled \"comma\". Older Giraffes and Pedals without RJ45 ports connect over JST2: Disconnect the EPAS cable from the Tesla Giraffe and connect the female JST2 from your Pedal to the Giraffe. Then connect the EPAS cable to the male JST2 from your Pedal. If your Pedal needs to be flashed, don't put your trim back on just yet. Instead connect the Giraffe and Panda to the car and and follow instructions below. This makes it easier to get to the Pedal in case necessary. Once you're ready to cover everything up, make sure you don't forget to reconnect the footwell LED and that all your cables are positioned well, so that they don't rub against sharp edges and that there's no tension on them.","title":"Installing the Tesla Pedal for old EON setup with Giraffe or Harness"},{"location":"Pedal_Interceptor_EON/#flashing-the-firmware-for-tesla-pedal-for-older-eon-versions","text":"You have to use a Tesla specific firmware on the Pedal in order to work for Tesla. You can flash the Pedal directly from the EON, this is why**we highly recommend installing the Pedal in your car before flashing (see section above)**. If, for whatever reason, you need to flash your Pedal outside the car, use below instructions in conjunction with this guide by @jfrux","title":"Flashing the firmware for Tesla Pedal for older EON versions"},{"location":"Pedal_Interceptor_EON/#step-1-get-the-code","text":"SSH into your EON, then download our latest Pedal code (use git pull in /data/panda if you already cloned the repo). git clone --depth 1 https://github.com/Bog Gyver/panda.git -b tesla_pedal /data/panda","title":"Step 1: Get the code"},{"location":"Pedal_Interceptor_EON/#step-2-prepare-your-hardware","text":"Connect your EON to your car (Panda) if not already done. Then press the brake pedal to power up the Pedal. Now kill all OP processes on the EON to free the CAN bus and change to the directory where all flashing related files are located. tmux kill-session -t comma cd /data/panda/board/pedal","title":"Step 2: Prepare your hardware"},{"location":"Pedal_Interceptor_EON/#step-31-flashing-via-can","text":"Flashing via CAN1is the recommended (easy) way but**only possible with Pedals ordered after 7 th Sept. 2019**. Older Pedals and those built yourself need to follow Step 3.2 instead. They will then also gain the ability to be flashed via CAN for future updates. Run and wait for this command to finish: make canflash In case flashing is stuck at checking for flasher , press CTRL+C to abort and re run above command. Power cycling Panda by reseating it may also help. If CAN flashing doesn't work for whatever reason you can always try Step 3.2 as a fallback. 1Original resource: Comma Pedal: Updating the Firmware over CAN by @jfrux","title":"Step 3.1: Flashing via CAN"},{"location":"Pedal_Interceptor_EON/#step-32-flashing-via-usb","text":"Flashing via USB involves more steps and is only necessary if flashing via CAN is not possible yet (see explanation in Step 3.1). If you built your Pedal yourself or it was shipped without any firmware, it will boot in DFU mode. To know which mode you're in look at the LED on the Pedal board: no light = DFU mode, slow blink = normal flash mode, fast blink = normal operations. If your Pedal LED is blinking, you can put your Pedal into DFU mode via CAN: ./enter_canloader.py --recover It's possible that the LED won't turn off on the first try, but usually does so after entering the command a second time*. In case you get an Assertion Error, reboot EON and start over from step 2. Also power cycle your Panda by reseating it if the issue persists.While in DFU mode, connect your EON via USB to the Pedal (unplug from Panda or use a second USB cable) ensuring that the car does not go in Car Off mode (don't lift your butt off the driver's seat) since Pedal would lose power and therefore also DFU mode. Now run this command to flash the bootloader and operational code: make recover Sometimes you have to issue the command multiple times until it completes successfully. With the updated bootloader you'll be able to flash future updates via CAN. Once done, unplug USB from the Pedal and back into the Panda. *If you can't or don't want to put the Pedal into DFU mode via CAN, you can also do so by applying 5 Volt to a special point on the board while connecting it to USB (to power it up). Car must obviously be off or disconnected for this. That usually requires 2 people: one to keep the jumper for 5V in place and the other to connect the USB.","title":"Step 3.2: Flashing via USB"},{"location":"Pedal_Interceptor_EON/#step-4-cleanup","text":"If all went good you can reboot EON to restore the OP processes that were closed in step 2. Once the pedal is back in operational mode (rapid LED blinking), PRND letters should be white. If it's not, first try to reboot pedal: Open the driver door while not sitting in the driver seat to make the car go in \"Car Off\" mode, then step on the brake to turn it back on. If you still experience red PRND letters after a successful flash and pedal being in operational mode, it means a bad connection between the car and the accelerator, so check your pedal Molex connectors.","title":"Step 4: Cleanup"},{"location":"Pedal_Interceptor_EON/#using-the-tesla-pedal","text":"Without electric brakes (i Booster) the car only uses regenerative braking. This is not enough for suddent slowdowns. YOU MUST BE READY TO MANUALLY BRAKE AT ANY MOMENT. Out of the box, OP will use the Tesla CC (with stalk spamming) to control CC. This in our OP implementation is called Adaptive Cruise Control or ACC. CC on Tesla only works above 18 MPH (29 km/h). If you turn off the Tesla CC by pressing on the CC stalk, OP will switch to Tesla Pedal mode (PCC). This will provide you with smooth adaptive cruise control by sending the right commands to your Tesla Pedal. Tesla Pedal works down to 1 MPH, but be careful, regen brakes stop working at 5 MPH (8 km/h).","title":"Using the Tesla Pedal"},{"location":"Power_Options_For_Accessories/","text":"What is Tinkla Buddy? Tinkla Buddy Install Kit Installing your Tinkla Buddy Configuring your Tinkla Buddy Tesla w/Cold Weather Package or Tesla Model X (Fuse Box in cabin) If you have a Tesla with the Cold Weather package then there is a fuse box near the accelerator which makes this a 30 minute install.[1] Model X You will need a new Fuse Holder and a ring terminal for Power. Step 1 - Remove Console trim and Footwell trim You need to remove two pieces of trim on the center console and footwell: the soft touch faux leather trim that runs along the side and beside the driver\u2019s seat and the hard plastic that it overlaps slightly. Remove the soft faux leather one first. Start at the very end near the driver seat and pull it away from the center console (see right pic). It\u2019s held on with pegs. Removing the plastic bit is a little more complicated. First, grip it from the exposed opening and pull it away from the center console and dash. It makes contact with the airbag and trim under the dash. You\u2019ll need to angle it upwards and rotate it up while also pulling the bottom towards you. Push the accelerator pedal out of the way to pull the trim towards you. This will also be 100% easier if you set your footwell carpet aside. You\u2019ll want to place the soft leather piece somewhere it won\u2019t get scratched like the back seat. Now that you have the side panels off, you can see the exposed fuse box near the accelerator (below). Step 2 - Remove the trim panel under the steering wheel. You\u2019ll want to remove this screw on the right, and a corresponding one on the left below the dash (red arrows). Note the power adapter for the footwell light (black connector in right pic). You\u2019ll use a flathead screwdriver to remove it. Afterwards your footwell looks like the right pic. On the left is a view of the accelerator pedal with the fuse box just to the right of it. Also shown at the top of the pedal is the connector where you plug your comma pedal in. If you haven\u2019t done so yet, this is an opportune time to put the pedal in, too. Step 3 - Now it\u2019s time to get power If your fuse adaptor has a butt connector, you\u2019re half way there. First, cut and strip the end of the wire coming from your USB power supply (if not already stripped). Crimp it into the butt connector. Then, choose a suitable fuse in the fusebox. The 5A brown fuse on right should work. Put the 5A fuse in the free slot of your adaptor. Then, plug the adaptor in as shown (the fuses are pointing down). Finally, route the loop connector to the 10mm screw just below and to the right of the fuse box. Screw it in and you have ground. Once you're done running power we can move on to powering up your Tinkla Buddy . Tesla S built 2016+ (Fuse Box in cabin) If you have a 2016 or later Tesla then there should be a fuse box behind the passenger kick panel and you'll need to re-crimp your 12v red wire which will make this about an hour install. Once you're done running power we can move on to powering up your Tinkla Buddy . Tesla w/o Fuse Box in Cabin If you don't have a fuse box in the cabin then pull a wire through a gasket on the firewall behind the washer fluid reservoir in the Frunk. Depending on your method of poking a hole in the gasket and your method of pulling your 16-18 gauge wire through your hole, this can take between 1-2 hours if not longer. Tools required: 13mm socket (for the ground) Plastic pry tool Fishing tape (or metal hanger) Sharp tool to poke a hole in a rubber gasket. Above you can see Fuse Box 2 in the Frunk. The red wire from TBuddy is tapped into an empty F36 fuse. (this car doesn't have Air Suspension.) Above is a zoomed out view of where the red wire runs to get to Fuse Box 2 The picture above is looking behind the washer fluid reservoir, you can see a gasket that will give us access to the cabin. Above is a closer view of the gasket in the frunk that we can use to route cables into the cabin. Above is the cabin side of the gasket, hiding low and left when you take off the driver's side kneeboard. Above is a zoomed out view of the compartment behind the kneeboard. there is a plastic panel on the left which is easy to remove and has two 13mm bolts you can use for ground. \u2191 Installing tinkla buddy with in-car fuses by @erflesby","title":"Power Options"},{"location":"Power_Options_For_Accessories/#tesla-wcold-weather-package-or-tesla-model-x-fuse-box-in-cabin","text":"If you have a Tesla with the Cold Weather package then there is a fuse box near the accelerator which makes this a 30 minute install.[1] Model X You will need a new Fuse Holder and a ring terminal for Power.","title":"Tesla w/Cold Weather Package or Tesla Model X (Fuse Box in cabin)"},{"location":"Power_Options_For_Accessories/#step-1-remove-console-trim-and-footwell-trim","text":"You need to remove two pieces of trim on the center console and footwell: the soft touch faux leather trim that runs along the side and beside the driver\u2019s seat and the hard plastic that it overlaps slightly. Remove the soft faux leather one first. Start at the very end near the driver seat and pull it away from the center console (see right pic). It\u2019s held on with pegs. Removing the plastic bit is a little more complicated. First, grip it from the exposed opening and pull it away from the center console and dash. It makes contact with the airbag and trim under the dash. You\u2019ll need to angle it upwards and rotate it up while also pulling the bottom towards you. Push the accelerator pedal out of the way to pull the trim towards you. This will also be 100% easier if you set your footwell carpet aside. You\u2019ll want to place the soft leather piece somewhere it won\u2019t get scratched like the back seat. Now that you have the side panels off, you can see the exposed fuse box near the accelerator (below).","title":"Step 1 - Remove Console trim and Footwell trim"},{"location":"Power_Options_For_Accessories/#step-2-remove-the-trim-panel-under-the-steering-wheel","text":"You\u2019ll want to remove this screw on the right, and a corresponding one on the left below the dash (red arrows). Note the power adapter for the footwell light (black connector in right pic). You\u2019ll use a flathead screwdriver to remove it. Afterwards your footwell looks like the right pic. On the left is a view of the accelerator pedal with the fuse box just to the right of it. Also shown at the top of the pedal is the connector where you plug your comma pedal in. If you haven\u2019t done so yet, this is an opportune time to put the pedal in, too.","title":"Step 2 - Remove the trim panel under the steering wheel."},{"location":"Power_Options_For_Accessories/#step-3-now-its-time-to-get-power","text":"If your fuse adaptor has a butt connector, you\u2019re half way there. First, cut and strip the end of the wire coming from your USB power supply (if not already stripped). Crimp it into the butt connector. Then, choose a suitable fuse in the fusebox. The 5A brown fuse on right should work. Put the 5A fuse in the free slot of your adaptor. Then, plug the adaptor in as shown (the fuses are pointing down). Finally, route the loop connector to the 10mm screw just below and to the right of the fuse box. Screw it in and you have ground. Once you're done running power we can move on to powering up your Tinkla Buddy .","title":"Step 3 - Now it\u2019s time to get power"},{"location":"Power_Options_For_Accessories/#tesla-s-built-2016-fuse-box-in-cabin","text":"If you have a 2016 or later Tesla then there should be a fuse box behind the passenger kick panel and you'll need to re-crimp your 12v red wire which will make this about an hour install. Once you're done running power we can move on to powering up your Tinkla Buddy .","title":"Tesla S built 2016+ (Fuse Box in cabin)"},{"location":"Power_Options_For_Accessories/#tesla-wo-fuse-box-in-cabin","text":"If you don't have a fuse box in the cabin then pull a wire through a gasket on the firewall behind the washer fluid reservoir in the Frunk. Depending on your method of poking a hole in the gasket and your method of pulling your 16-18 gauge wire through your hole, this can take between 1-2 hours if not longer. Tools required: 13mm socket (for the ground) Plastic pry tool Fishing tape (or metal hanger) Sharp tool to poke a hole in a rubber gasket. Above you can see Fuse Box 2 in the Frunk. The red wire from TBuddy is tapped into an empty F36 fuse. (this car doesn't have Air Suspension.) Above is a zoomed out view of where the red wire runs to get to Fuse Box 2 The picture above is looking behind the washer fluid reservoir, you can see a gasket that will give us access to the cabin. Above is a closer view of the gasket in the frunk that we can use to route cables into the cabin. Above is the cabin side of the gasket, hiding low and left when you take off the driver's side kneeboard. Above is a zoomed out view of the compartment behind the kneeboard. there is a plastic panel on the left which is easy to remove and has two 13mm bolts you can use for ground. \u2191 Installing tinkla buddy with in-car fuses by @erflesby","title":"Tesla w/o Fuse Box in Cabin"},{"location":"PreAP__IC_Integration_with_OP/","text":"Install a Tinkla Buddyfor integration without root access. IC with Open Pilot integration (requires Tinkla Buddy). This view is generated by Open Pilot on your IC and uses the same API as the official Auto Pilot. As you can see, LKA and ACC are engaged with a target of 76 MPH max. The cars shown are the ones detected by Open Pilot using cloud data from a Tesla Bosch aftermarket radar.","title":"IC Integration"},{"location":"Removing_the_Instrument_Cluster/","text":"What is Tinkla Buddy? Tinkla Buddy Install Kit Installing your Tinkla Buddy Configuring your Tinkla Buddy Step-by-Step guide to remove the Instrument Cluster There are multiple videos on how to remove the Instrument Cluster [IC], here is one for the Model S: Tools worth investing in: Air Shim (aka Inflatable Pry Bar) Trim pry tools TORX T20 Screwdriver ****Step 1**** Remove the \u201cfaux leather\u201d knee-board trim just below the IC and steering wheel. It\u2019s the large piece with a soft touch feel to it. This piece is held in place by pegs. It\u2019s easiest to start over on the right side just below the hazard lights button, to the left of the MCU. Put your palms facing away from you, touching the soft surface, and grab the top ledge of the trim with your fingers and pull back. It will eventually pop out, and you can work your way to the left and remove the parts under the vent to the left of the steering wheel. To be safe, put the piece of trim in a safe place where it won\u2019t get scratched. Back seat, or trunk, are good options. At the same time, go ahead and remove the small \u201chatch\u201d cover trim panel on the left side of the dash where the door meets the dash. There is a screw in here (red arrow) that holds the top dash trim to the frame which is essential to remove! The video instructions to remove the IC did not include this screw. The upper right and right pics show other screws that will need to be removed. Go ahead and remove the two on the left now. ****Step 2**** Next you have the small piece of trim just above the steering wheel. Note that this can be very tight. It\u2019s held on only with pegs. The IC disassembly video didn\u2019t show this part (it was already loose). You can see two plastic tabs on the left and right side. Don\u2019t grab and pull straight back. Instead, grip them from the bottom and pull the bottom up at a slight angle. The tabs will pop out quickly (see pics below). Remove more screws! There are two screws under the small trim piece you just removed, on the right and left sides. Remove both of them. Also, in the right pic below, remove the screw on the right. ****Step 3**** It\u2019s dash time! There is a thin plastic panel above the IC, on the bottom of the sun guard. Pry it off with a trim removal tool. It\u2019s held in place with 4 pegs. Next take out two more screws holding the frame to the trim. Then, put in your air-shim tool and pump it up! This is the part where you want to make sure you removed that one screw in the side hatch! Pump it up until you reveal the screws shown in the pics above. At this point, you should be able to remove the silver colored IC shroud. ****Step 4**** Almost there. Now remove your two AC vent trim pieces. Be careful with this part, as these are the pieces that make your car look pretty. They don\u2019t make Lacewood anymore in my case. Put these somewhere soft where they won\u2019t scratch, like on the carpet. Use a pry tool to pull them away from the dash on the bottom. Make sure you\u2019ve removed the screw holding them into the dash on the top as well (it\u2019s one reason we raised the dash in the last step). Now you have access to the final two screws.","title":"Removing IC"},{"location":"Removing_the_Instrument_Cluster/#step-by-step-guide-to-remove-the-instrument-cluster","text":"There are multiple videos on how to remove the Instrument Cluster [IC], here is one for the Model S: Tools worth investing in: Air Shim (aka Inflatable Pry Bar) Trim pry tools TORX T20 Screwdriver ****Step 1**** Remove the \u201cfaux leather\u201d knee-board trim just below the IC and steering wheel. It\u2019s the large piece with a soft touch feel to it. This piece is held in place by pegs. It\u2019s easiest to start over on the right side just below the hazard lights button, to the left of the MCU. Put your palms facing away from you, touching the soft surface, and grab the top ledge of the trim with your fingers and pull back. It will eventually pop out, and you can work your way to the left and remove the parts under the vent to the left of the steering wheel. To be safe, put the piece of trim in a safe place where it won\u2019t get scratched. Back seat, or trunk, are good options. At the same time, go ahead and remove the small \u201chatch\u201d cover trim panel on the left side of the dash where the door meets the dash. There is a screw in here (red arrow) that holds the top dash trim to the frame which is essential to remove! The video instructions to remove the IC did not include this screw. The upper right and right pics show other screws that will need to be removed. Go ahead and remove the two on the left now. ****Step 2**** Next you have the small piece of trim just above the steering wheel. Note that this can be very tight. It\u2019s held on only with pegs. The IC disassembly video didn\u2019t show this part (it was already loose). You can see two plastic tabs on the left and right side. Don\u2019t grab and pull straight back. Instead, grip them from the bottom and pull the bottom up at a slight angle. The tabs will pop out quickly (see pics below). Remove more screws! There are two screws under the small trim piece you just removed, on the right and left sides. Remove both of them. Also, in the right pic below, remove the screw on the right. ****Step 3**** It\u2019s dash time! There is a thin plastic panel above the IC, on the bottom of the sun guard. Pry it off with a trim removal tool. It\u2019s held in place with 4 pegs. Next take out two more screws holding the frame to the trim. Then, put in your air-shim tool and pump it up! This is the part where you want to make sure you removed that one screw in the side hatch! Pump it up until you reveal the screws shown in the pics above. At this point, you should be able to remove the silver colored IC shroud. ****Step 4**** Almost there. Now remove your two AC vent trim pieces. Be careful with this part, as these are the pieces that make your car look pretty. They don\u2019t make Lacewood anymore in my case. Put these somewhere soft where they won\u2019t scratch, like on the carpet. Use a pry tool to pull them away from the dash on the bottom. Make sure you\u2019ve removed the screw holding them into the dash on the top as well (it\u2019s one reason we raised the dash in the last step). Now you have access to the final two screws.","title":"Step-by-Step guide to remove the Instrument Cluster"},{"location":"Root_Access_To_IC_and_CID/","text":"Install a Tinkla Buddy for integration without root access. IC with Open Pilot integration (requires Tinkla Buddy). This view is generated by Open Pilot on your IC and uses the same API as the official Auto Pilot. As you can see, LKA and ACC are engaged with a target of 76 MPH max. The cars shown are the ones detected by Open Pilot using cloud data from a Tesla Bosch aftermarket radar.","title":"Root Access"},{"location":"SSH_Into_Your_Device/","text":"SSH when device is running a version after 0.8.3 You need a Git Hub account. Make one if you don't already have one. Enable SSH on your comma two: Settings -> Network -> Enable SSH Enter your Git Hub username for SSH: Settings -> Network -> SSH Keys (hit**Remove**and then**Add**if needed). Obtain the IP of your devices from**Settings -> Network** Ping the device address from your computer to make sure it is reachable. Under a Unix/Linux, mac OS terminal or Windows 10 with Open SSH, use the command: ssh root@<IP address of comma two> -p 8022 -i <path to private github key> for Comma two/EON Gold or ssh root@<IP address of comma three> -p 8022 -i <path to private github key> for Comma three. If you assign a fixed IP through your router reservations, then you can configure ssh so you can ssh by just doing**ssh eon**. To do so, add the following lines to your**~/.ssh/config**file: Host eon Host Name <IP address of comma two> Port 8022 Identity File <path to private github key> Strict Host Key Checking no For more info visit the comma wiki SSH when devices is running a version before 0.8.3 Download the private key from the openpilot repo . Save the key file as a text file and name it something like key.pem. Open a terminal Run**chmod 600 key.pem**(otherwise, the system will think the text file is not safe). Get the IP address of your comma two from**Settings > Wi Fi > Open Wi Fi Settings > More Options > Options (top right icon) > Advanced**(please make sure your comma two and your computer connect to the same Wi Fi). Ping the device address from your computer to make sure it is reachable. Under a Unix/Linux, mac OS terminal or Windows 10 with Open SSH, use the command: ssh root@<IP address of comma two> -p 8022 -i key.pem","title":"SSH Access"},{"location":"SSH_Into_Your_Device/#ssh-when-device-is-running-a-version-after-083","text":"You need a Git Hub account. Make one if you don't already have one. Enable SSH on your comma two: Settings -> Network -> Enable SSH Enter your Git Hub username for SSH: Settings -> Network -> SSH Keys (hit**Remove**and then**Add**if needed). Obtain the IP of your devices from**Settings -> Network** Ping the device address from your computer to make sure it is reachable. Under a Unix/Linux, mac OS terminal or Windows 10 with Open SSH, use the command: ssh root@<IP address of comma two> -p 8022 -i <path to private github key> for Comma two/EON Gold or ssh root@<IP address of comma three> -p 8022 -i <path to private github key> for Comma three. If you assign a fixed IP through your router reservations, then you can configure ssh so you can ssh by just doing**ssh eon**. To do so, add the following lines to your**~/.ssh/config**file: Host eon Host Name <IP address of comma two> Port 8022 Identity File <path to private github key> Strict Host Key Checking no For more info visit the comma wiki","title":"SSH when device is running a version after 0.8.3"},{"location":"SSH_Into_Your_Device/#ssh-when-devices-is-running-a-version-before-083","text":"Download the private key from the openpilot repo . Save the key file as a text file and name it something like key.pem. Open a terminal Run**chmod 600 key.pem**(otherwise, the system will think the text file is not safe). Get the IP address of your comma two from**Settings > Wi Fi > Open Wi Fi Settings > More Options > Options (top right icon) > Advanced**(please make sure your comma two and your computer connect to the same Wi Fi). Ping the device address from your computer to make sure it is reachable. Under a Unix/Linux, mac OS terminal or Windows 10 with Open SSH, use the command: ssh root@<IP address of comma two> -p 8022 -i key.pem","title":"SSH when devices is running a version before 0.8.3"},{"location":"SoftPanda/","text":"DISCLAMER: Improper changes to IC or CID can result in the system (and thus your car) being rederend unusable. Potentially not even Tesla can revert some of the changes if done incorrectly. You are doing this at your own risk. You alone are ultimately responsible, not the creator of this site, Comma.ai, Comma.ai community, Tesla, or anyone else. Soft Panda is a piece of software that makes the car's interfaces look and feel like Open Pilot shipped with the car. The IC integration runs the Auto Pilot view, powered by Open Pilot. CID integration adds settings for Open Pilot in the car's menu. Additionally, soft Panda adds map based speed control as well as control over max speed offset. To install and use the soft Panda for IC/CID integration you have to have root access and modify important files on the IC and CID of your Tesla car. Please read carefully the whole document as well as the disclaimers. If you have questions or doubts, please reach out to our user group on the Comma.ai Tesla channel on Discord. Before Attempting Integreation with Soft Panda, have you considered trying Tinkla Buddy? Seriously, Tinkla Buddy is worth a shot. Changes to Open Pilot Configuration File The following options must be set to true in the Open Pilot Configuration File for the IC/CID integration to work: enable_das_emulation = True has_tesla_ic_integration = True # if this is false, the corresponding setting on CID will switch to on after every restart use_tesla_map_data = True Download soft Panda Executable Download the soft Panda executable to**/var/root/bin**on your CID with the following commands: cd /var/root/bin curl -O https://tinkla.us/files/soft Panda Download Language Strings File Find and download the Qt Car_xx.qm specific to your language (for example English is**en**) on both IC and CID and place it in**/var/root/lang**on both systems. English -Qt Car_en.qm German -Qt Car_de.qm Spanish -Qt Car_es.qm To get the files you can do this**on both IC and CID**(change the file URL to the language your car displays) cd /var/root/lang curl -O https://tinkla.us/files/Qt Car_en.qm ssh ic cd /var/root/lang curl -O https://tinkla.us/files/Qt Car_en.qm Changes on IC DISCLAMER: Improper changes to IC or CID can result in the system (and thus your car) being rederend unusable. Potentially not even Tesla can revert some of the changes if done incorrectly. You are doing this at your own risk. You alone are ultimately responsible, not the creator of this site, Comma.ai, Comma.ai community, Tesla, or anyone else. Add the following 5 lines at the top of this** special file on**IC . Make sure both language file names match your car's language. /bin/mount | /bin/grep -c /var/root/lang/Qt Car >/dev/null || /bin/mount --bind /var/root/lang/Qt Car_en.qm /usr/tesla/UI/bin/Qt Car_en.qm QCPORT=\":20201\" export QCPORT QCHPPORT=\":31515\" export QCHPPORT Changes on CID DISCLAMER: Improper changes to IC or CID can result in the system (and thus your car) being rederend unusable. Potentially not even Tesla can revert some of the changes if done incorrectly. You are doing this at your own risk. You alone are ultimately responsible, not the creator of this site, Comma.ai, Comma.ai community, Tesla, or anyone else. CID integration (Open Pilot Menu) is currently only supported on**2019.4.2**and below. Add the following 4 lines at the top of this** special file on**CID . Make sure both language file names match your car's language. /bin/mount | /bin/grep -c /var/root/lang/Qt Car >/dev/null || /bin/mount --bind /var/root/lang/Qt Car_en.qm /usr/tesla/UI/bin/Qt Car_en.qm QCPORT=\":20201\" export QCPORT NOTE: Do NOT declare QCHPPORT on CID!!! Updating Maps If you have older version of maps on your CID, you might need to update them. Startup Script Use/var/root/scripts/start Soft Panda.shscript. Changing the cron In order to start the script you need to modify your cron and add the following 2 lines: @reboot /sbin/start-stop-daemon --start --quiet --make-pidfile --oknodo --background --pidfile /var/run/soft Panda.pid --exec /bin/bash /var/root/scripts/start Soft Panda.sh */1 * * * * /sbin/start-stop-daemon --start --quiet --make-pidfile --oknodo --background --pidfile /var/run/soft Panda.pid --exec /bin/bash /var/root/scripts/start Soft Panda.sh A simple restart script The soft Panda startup script creates a lock file and prevents two restarts in less than 10 minutes to allow you to still access your car computers in the event of a mistake. To manually restart the process you have to delete the lock file and then kill the soft Panda process. Or just create a bash file with this content and run it. Optional Flags Here are the optional flags for soft Panda Ether Can Proxy NOTE: If you are running Tesla software 2019.16 or later, you have to enable the -fix1916 flag! -run On Ic: sets the spammer to run on IC instead of CID (CID default) -trigger On Can: start the spam only when receiving a certain CAN message from EON (OFF by default) -auto Restart Qt Car Cluster: sends command to restart Qt Car Cluster when app starts (OFF by default) -only Car Config3: sends spam only for Das Hw in GTW_car Config3 (OFF by default) -spam Frequency XX: spam frequency in Hz (100Hz by default) -autopilot Y: autopilot mode (1:Highway, 2:Enhanced DEFAULT, 3:Self Drive) -bridge ZZZZZ: bridge mode where the packets received on 20101 are sent to port ZZZZZ (20102-27000) -h Bridge ZZZZZ: bridge mode where the packets received on 31415 are sent to port ZZZZZ (31515-32000) -send After Receive: sends modded message right after it is received (OFF by default) -bind To Port WWWWW: Binds to a certain port and local IP address for sending (OFF by default) -send Di Acc Status: Send the DI_acc Status message; experimental for now (OFF by default) -modify Di State: Modifies the DI_state message for long control showing on IC (OFF by default) -include Parrot: Include data from parrot to be sent through the bridge (OFF by default) -include Lb: Include data from LB to be sent through the bridge (OFF by default) -forward Debug: forward also the debug messages show in Developer Mode (OFF by default) -forward Unique: forward only unique CAN messages in each direction (OFF by default) -fix1916: fix DI_Status CAN change that started with 2019.16 (OFF by default) -tpms Conti: Allows tire pressure display on Baloong TPMS system, DO NOT USE ON CONTI Help, All Screens Are Black! It\u2019s not uncommon to see both IC and CID black the first time you start your car after enabling everything. This is caused by the CID not receiving messages from the gateway to wake up, which in turn is caused by soft Panda having either not started or crashed. (Remember in the steps above we tell the CID to only listen to the gateway on the port soft Panda proxies data to it on). The car will still drive with no screens, if you push the brake and wait 30 seconds for the gateway to give up trying to contact the screens. Quickfix: Reboot the CID using the steering wheel (sometimes the speakers give a slight pop when the reboot command is executed). If everything is setup properly, the screens should come up. Steering wheel reboots are not preferred as they aren\u2019t graceful restarts. Preferred fix: ssh into the CID and restart soft Panda, or troubleshoot what happened and then restart it.","title":"SoftPanda"},{"location":"SoftPanda/#changes-to-open-pilot-configuration-file","text":"The following options must be set to true in the Open Pilot Configuration File for the IC/CID integration to work: enable_das_emulation = True has_tesla_ic_integration = True # if this is false, the corresponding setting on CID will switch to on after every restart use_tesla_map_data = True","title":"Changes to Open Pilot Configuration File"},{"location":"SoftPanda/#download-soft-panda-executable","text":"Download the soft Panda executable to**/var/root/bin**on your CID with the following commands: cd /var/root/bin curl -O https://tinkla.us/files/soft Panda","title":"Download soft Panda Executable"},{"location":"SoftPanda/#download-language-strings-file","text":"Find and download the Qt Car_xx.qm specific to your language (for example English is**en**) on both IC and CID and place it in**/var/root/lang**on both systems. English -Qt Car_en.qm German -Qt Car_de.qm Spanish -Qt Car_es.qm To get the files you can do this**on both IC and CID**(change the file URL to the language your car displays) cd /var/root/lang curl -O https://tinkla.us/files/Qt Car_en.qm ssh ic cd /var/root/lang curl -O https://tinkla.us/files/Qt Car_en.qm","title":"Download Language Strings File"},{"location":"SoftPanda/#changes-on-ic","text":"DISCLAMER: Improper changes to IC or CID can result in the system (and thus your car) being rederend unusable. Potentially not even Tesla can revert some of the changes if done incorrectly. You are doing this at your own risk. You alone are ultimately responsible, not the creator of this site, Comma.ai, Comma.ai community, Tesla, or anyone else. Add the following 5 lines at the top of this** special file on**IC . Make sure both language file names match your car's language. /bin/mount | /bin/grep -c /var/root/lang/Qt Car >/dev/null || /bin/mount --bind /var/root/lang/Qt Car_en.qm /usr/tesla/UI/bin/Qt Car_en.qm QCPORT=\":20201\" export QCPORT QCHPPORT=\":31515\" export QCHPPORT","title":"Changes on IC"},{"location":"SoftPanda/#changes-on-cid","text":"DISCLAMER: Improper changes to IC or CID can result in the system (and thus your car) being rederend unusable. Potentially not even Tesla can revert some of the changes if done incorrectly. You are doing this at your own risk. You alone are ultimately responsible, not the creator of this site, Comma.ai, Comma.ai community, Tesla, or anyone else. CID integration (Open Pilot Menu) is currently only supported on**2019.4.2**and below. Add the following 4 lines at the top of this** special file on**CID . Make sure both language file names match your car's language. /bin/mount | /bin/grep -c /var/root/lang/Qt Car >/dev/null || /bin/mount --bind /var/root/lang/Qt Car_en.qm /usr/tesla/UI/bin/Qt Car_en.qm QCPORT=\":20201\" export QCPORT NOTE: Do NOT declare QCHPPORT on CID!!!","title":"Changes on CID"},{"location":"SoftPanda/#updating-maps","text":"If you have older version of maps on your CID, you might need to update them.","title":"Updating Maps"},{"location":"SoftPanda/#startup-script","text":"Use/var/root/scripts/start Soft Panda.shscript.","title":"Startup Script"},{"location":"SoftPanda/#changing-the-cron","text":"In order to start the script you need to modify your cron and add the following 2 lines: @reboot /sbin/start-stop-daemon --start --quiet --make-pidfile --oknodo --background --pidfile /var/run/soft Panda.pid --exec /bin/bash /var/root/scripts/start Soft Panda.sh */1 * * * * /sbin/start-stop-daemon --start --quiet --make-pidfile --oknodo --background --pidfile /var/run/soft Panda.pid --exec /bin/bash /var/root/scripts/start Soft Panda.sh","title":"Changing the cron"},{"location":"SoftPanda/#a-simple-restart-script","text":"The soft Panda startup script creates a lock file and prevents two restarts in less than 10 minutes to allow you to still access your car computers in the event of a mistake. To manually restart the process you have to delete the lock file and then kill the soft Panda process. Or just create a bash file with this content and run it.","title":"A simple restart script"},{"location":"SoftPanda/#optional-flags","text":"Here are the optional flags for soft Panda Ether Can Proxy NOTE: If you are running Tesla software 2019.16 or later, you have to enable the -fix1916 flag! -run On Ic: sets the spammer to run on IC instead of CID (CID default) -trigger On Can: start the spam only when receiving a certain CAN message from EON (OFF by default) -auto Restart Qt Car Cluster: sends command to restart Qt Car Cluster when app starts (OFF by default) -only Car Config3: sends spam only for Das Hw in GTW_car Config3 (OFF by default) -spam Frequency XX: spam frequency in Hz (100Hz by default) -autopilot Y: autopilot mode (1:Highway, 2:Enhanced DEFAULT, 3:Self Drive) -bridge ZZZZZ: bridge mode where the packets received on 20101 are sent to port ZZZZZ (20102-27000) -h Bridge ZZZZZ: bridge mode where the packets received on 31415 are sent to port ZZZZZ (31515-32000) -send After Receive: sends modded message right after it is received (OFF by default) -bind To Port WWWWW: Binds to a certain port and local IP address for sending (OFF by default) -send Di Acc Status: Send the DI_acc Status message; experimental for now (OFF by default) -modify Di State: Modifies the DI_state message for long control showing on IC (OFF by default) -include Parrot: Include data from parrot to be sent through the bridge (OFF by default) -include Lb: Include data from LB to be sent through the bridge (OFF by default) -forward Debug: forward also the debug messages show in Developer Mode (OFF by default) -forward Unique: forward only unique CAN messages in each direction (OFF by default) -fix1916: fix DI_Status CAN change that started with 2019.16 (OFF by default) -tpms Conti: Allows tire pressure display on Baloong TPMS system, DO NOT USE ON CONTI","title":"Optional Flags"},{"location":"SoftPanda/#help-all-screens-are-black","text":"It\u2019s not uncommon to see both IC and CID black the first time you start your car after enabling everything. This is caused by the CID not receiving messages from the gateway to wake up, which in turn is caused by soft Panda having either not started or crashed. (Remember in the steps above we tell the CID to only listen to the gateway on the port soft Panda proxies data to it on). The car will still drive with no screens, if you push the brake and wait 30 seconds for the gateway to give up trying to contact the screens. Quickfix: Reboot the CID using the steering wheel (sometimes the speakers give a slight pop when the reboot command is executed). If everything is setup properly, the screens should come up. Steering wheel reboots are not preferred as they aren\u2019t graceful restarts. Preferred fix: ssh into the CID and restart soft Panda, or troubleshoot what happened and then restart it.","title":"Help, All Screens Are Black!"},{"location":"Talk_Feedback__Ideas__Comments_/","text":"Welcome to Tinkla Talk!","title":"Feedback & Ideas"},{"location":"Template_EPAS_Harness/","text":"","title":"Template EPAS Harness"},{"location":"Template_Flashing_the_Panda/","text":"After installing or updating Open Pilot on your EON, you need to also update the software on your Panda. Here's how: In your Tesla while it says \u201cCar Off\u201d connect your Panda to your Giraffe rev B OBD (or EPAS OBD). Connect your EON to the Panda via USB. Then SSH in and run: cd /data/openpilot/panda/board killall boardd make clean make && sleep 1 && (make recover || make recover) && echo Success! Rebooting in 2s... && sleep 2 && reboot The kill command ensures that the EON stops regular communication to the Panda. That's also why a reboot is needed at the end. If any error occurs (which of course should not happen) the reboot will be skipped so you can troubleshoot. Assertion Errors should be fixed by rebooting EON and trying a second time. Optionally you may also power cycle your Panda by reseating it.","title":"Template Flashing the Panda"},{"location":"Template_FlowMention/","text":"@Example","title":"Template FlowMention"},{"location":"Template_Getting_Started/","text":"","title":"Template Getting Started"},{"location":"Template_LQT_Moved_thread_stub_converted_to_Flow/","text":"This post by {{{author}}} was moved on {{{date}}}. You can find it at [[{{{title}}}]].","title":"Template LQT Moved thread stub converted to Flow"},{"location":"Template_LQT_page_converted_to_Flow/","text":"Previous page history was archived for backup purposes at [[{{{archive}}}]]on**Error: Invalid time.**.","title":"Template LQT page converted to Flow"},{"location":"Template_LQT_post_imported_with_different_signature_user/","text":"This post was posted by [[User:{{{author User}}}|{{{author User}}}]], but signed as [[User:{{{signature User}}}|{{{signature User}}}]].","title":"Template LQT post imported with different signature user"},{"location":"Template_LongControl_v066/","text":"Using Adaptive Cruise Control To repeat, without electric brakes (i Booster) the car only uses regenerative braking. This is not enough for sudden slowdowns. YOU MUST BE READY TO MANUALLY BRAKE AT ANY MOMENT. Adaptive Cruise Control allows the car to match speed with cars in front of you, slows down for turns based on Comma OP logic and also accelerates up to the MAX set speed. We have two types of adaptive cruise control based on your car configuration and options installed: ACC which is based on Tesla CC and PCC which uses the pedal interceptor . Follow these steps to use ACC: Press the cruise stalk IN so that the orange \"cruise control ready\" LED on the stalk is lit. Enable the ACC option on the EON screen if necessary. Accelerate above 18 MPH. Enable Open Pilot using a DOUBLE stalk pull (pull the cruise control stalk BACKWARDS TWICE in quick succession.) You will see the blue 'Cruise' icon appear on your dash. If you have IC/CID integration , the speed will be set to the speed limit for that road + the set offset in the Open Pilot screen in CID. ACC is now active. The initial max speed may be conservative. Press UP on the stalk to increase it. You can also accelerate manually to temporarily drive faster than current cruise speed. This will not disable ACC. Cruise is disabled if you brake or the car slows below 18 MPH. If ACC \"AUTO\" mode is enabled, manually accelerate above 18 MPH to resume. Follow these steps to use PCC: Press the cruise stalk IN so that the orange \"cruise control ready\" LED on the stalk is not lit (or set the Open Pilot Configuration File to use pedal always over CC) Enable the PCC option on the EON screen if necessary. Accelerate above 1 MPH. Enable Open Pilot using a DOUBLE stalk pull (pull the cruise control stalk BACKWARDS TWICE in quick succession.) You will see the blue 'Cruise' icon appear on your dash. If you have IC/CID integration , the speed will be set to the speed limit for that road + the set offset in the Open Pilot screen in CID. PCC is now active. The initial max speed may be conservative. Press UP on the stalk to increase it. Please note: As long as your foot touches the accelerator pedal, it will completely override PCC control. Cruise is disabled if you brake. Controls while ACC or PCC are enabled: Control Action Cruise stalk IN Master toggle for cruise control. Must be engaged for ACC to work, if you have a Pedal then engaged is for regular CC (no steering or speed control). Must be disengaged for PCC to work. When force_pedal_over_cc is true, PCC will be used regardless of the stalk position. Cruise stalk SINGLE PULL Enable OP steering. Disables ACC or PCC if it was active at the time of pulling. Cruise stalk DOUBLE PULL Enable OP steering and ACC or PCC and updates the max allowed cruise speed based on your current speed. Cruise stalk UP Increase cruise speed, increasing max allowed ACC/PCC speed if necessary. Cruise stalk DOWN Decrease cruise speed and max allowed ACC/PCC speed. Cruise stalk PUSH Disable Open Pilot (both steering and ACC/PCC). Cruise stalk DOUBLE \u00bd DOWN If the on screen ACC button has \"CC\" displaying, this will engage regular stock Tesla CC without auto-steer or regenerative braking. Brake pedal Pause both ACC/PCC and traditional cruise. Accelerator (When in AUTO mode) Accel over 18 MPH to unpause ACC. No effect on PCC. Overrides the long control for both ACC and PCC. On screen ACC/PCC button Toggle between \"FOLLOW\", \"AUTO\", and \"CC\" modes for ACC and \"FOLLOW\" and \"OP\" modes for PCC. **FOLLOW**mode attempts to match speed with cars in front of you and disengages if you steer or brake. **AUTO**mode does the same, but automatically re-engages when you accelerate again. **CC**mode for ACC will engage regular Cruise Control:Auto-Steering Offand Speed Control Off. **OP**mode is the built in Comma OP logic. On CID buttons Toggle between 2.5, 2, 1.5 and 1 second follow distance options. Using Regular Cruise Control Beginning in Open Pilot v0.6.6, we have brought back Tesla's stock Cruise Control as an option to maintain your car's speed when OP can not see well enough to stay engaged or where you deem conditions are not safe enough to allow OP to steer the car for you, i.e. when there is snow or rain and OP can't clearly detect the road lines. OP auto-detects if you have a Pedal interceptor and if you do, when you press the cruise stalk IN so that the orange \"cruise control ready\" LED on the stalk is lit, PCC is off and regular CC is available. YOU ARE IN CONTROL, not OP. Follow these steps to use stock CC: Press the cruise stalk IN so that the orange \"cruise control ready\" LED on the stalk is lit. (If you have a Pedal and Open Pilot Configuration File is set to use pedal always over CC, this won't work.) Set the ACC option on the EON screen to CC if necessary. (If you have a Pedal, CC should be selected by default) Accelerate above 18 MPH. Enable Cruise Control pressing DOUBLE \u00bd DOWN on the stalk (press the cruise control stalk halfway DOWN TWICE in quick succession.) You will see the blue 'Cruise' icon appear on your dash. If you have IC/CID integration , the speed will be set to the speed you were going. Tesla's stock CC is now active. Press UP or DOWN on the stalk to increase or decrease speed. Please note: CC is not controlled by Open Pilot, you are in control. Cruise is disabled if you brake.","title":"Template LongControl v066"},{"location":"Template_LongControl_v066/#using-adaptive-cruise-control","text":"To repeat, without electric brakes (i Booster) the car only uses regenerative braking. This is not enough for sudden slowdowns. YOU MUST BE READY TO MANUALLY BRAKE AT ANY MOMENT. Adaptive Cruise Control allows the car to match speed with cars in front of you, slows down for turns based on Comma OP logic and also accelerates up to the MAX set speed. We have two types of adaptive cruise control based on your car configuration and options installed: ACC which is based on Tesla CC and PCC which uses the pedal interceptor . Follow these steps to use ACC: Press the cruise stalk IN so that the orange \"cruise control ready\" LED on the stalk is lit. Enable the ACC option on the EON screen if necessary. Accelerate above 18 MPH. Enable Open Pilot using a DOUBLE stalk pull (pull the cruise control stalk BACKWARDS TWICE in quick succession.) You will see the blue 'Cruise' icon appear on your dash. If you have IC/CID integration , the speed will be set to the speed limit for that road + the set offset in the Open Pilot screen in CID. ACC is now active. The initial max speed may be conservative. Press UP on the stalk to increase it. You can also accelerate manually to temporarily drive faster than current cruise speed. This will not disable ACC. Cruise is disabled if you brake or the car slows below 18 MPH. If ACC \"AUTO\" mode is enabled, manually accelerate above 18 MPH to resume. Follow these steps to use PCC: Press the cruise stalk IN so that the orange \"cruise control ready\" LED on the stalk is not lit (or set the Open Pilot Configuration File to use pedal always over CC) Enable the PCC option on the EON screen if necessary. Accelerate above 1 MPH. Enable Open Pilot using a DOUBLE stalk pull (pull the cruise control stalk BACKWARDS TWICE in quick succession.) You will see the blue 'Cruise' icon appear on your dash. If you have IC/CID integration , the speed will be set to the speed limit for that road + the set offset in the Open Pilot screen in CID. PCC is now active. The initial max speed may be conservative. Press UP on the stalk to increase it. Please note: As long as your foot touches the accelerator pedal, it will completely override PCC control. Cruise is disabled if you brake. Controls while ACC or PCC are enabled: Control Action Cruise stalk IN Master toggle for cruise control. Must be engaged for ACC to work, if you have a Pedal then engaged is for regular CC (no steering or speed control). Must be disengaged for PCC to work. When force_pedal_over_cc is true, PCC will be used regardless of the stalk position. Cruise stalk SINGLE PULL Enable OP steering. Disables ACC or PCC if it was active at the time of pulling. Cruise stalk DOUBLE PULL Enable OP steering and ACC or PCC and updates the max allowed cruise speed based on your current speed. Cruise stalk UP Increase cruise speed, increasing max allowed ACC/PCC speed if necessary. Cruise stalk DOWN Decrease cruise speed and max allowed ACC/PCC speed. Cruise stalk PUSH Disable Open Pilot (both steering and ACC/PCC). Cruise stalk DOUBLE \u00bd DOWN If the on screen ACC button has \"CC\" displaying, this will engage regular stock Tesla CC without auto-steer or regenerative braking. Brake pedal Pause both ACC/PCC and traditional cruise. Accelerator (When in AUTO mode) Accel over 18 MPH to unpause ACC. No effect on PCC. Overrides the long control for both ACC and PCC. On screen ACC/PCC button Toggle between \"FOLLOW\", \"AUTO\", and \"CC\" modes for ACC and \"FOLLOW\" and \"OP\" modes for PCC. **FOLLOW**mode attempts to match speed with cars in front of you and disengages if you steer or brake. **AUTO**mode does the same, but automatically re-engages when you accelerate again. **CC**mode for ACC will engage regular Cruise Control:Auto-Steering Offand Speed Control Off. **OP**mode is the built in Comma OP logic. On CID buttons Toggle between 2.5, 2, 1.5 and 1 second follow distance options.","title":"Using Adaptive Cruise Control"},{"location":"Template_LongControl_v066/#using-regular-cruise-control","text":"Beginning in Open Pilot v0.6.6, we have brought back Tesla's stock Cruise Control as an option to maintain your car's speed when OP can not see well enough to stay engaged or where you deem conditions are not safe enough to allow OP to steer the car for you, i.e. when there is snow or rain and OP can't clearly detect the road lines. OP auto-detects if you have a Pedal interceptor and if you do, when you press the cruise stalk IN so that the orange \"cruise control ready\" LED on the stalk is lit, PCC is off and regular CC is available. YOU ARE IN CONTROL, not OP. Follow these steps to use stock CC: Press the cruise stalk IN so that the orange \"cruise control ready\" LED on the stalk is lit. (If you have a Pedal and Open Pilot Configuration File is set to use pedal always over CC, this won't work.) Set the ACC option on the EON screen to CC if necessary. (If you have a Pedal, CC should be selected by default) Accelerate above 18 MPH. Enable Cruise Control pressing DOUBLE \u00bd DOWN on the stalk (press the cruise control stalk halfway DOWN TWICE in quick succession.) You will see the blue 'Cruise' icon appear on your dash. If you have IC/CID integration , the speed will be set to the speed you were going. Tesla's stock CC is now active. Press UP or DOWN on the stalk to increase or decrease speed. Please note: CC is not controlled by Open Pilot, you are in control. Cruise is disabled if you brake.","title":"Using Regular Cruise Control"},{"location":"Template_Wikitext_talk_page_converted_to_Flow/","text":"Previous discussion was archived at [[{{{archive}}}]]on**Error: Invalid time.**.","title":"Template Wikitext talk page converted to Flow"},{"location":"Tesla_Bosch_Radar/","text":"If you need instructions for the Tesla Bosch Radar to use with EON or other (non Tesla) cars, the information can be found here . Tesla Bosch Radar Wiring Harness for Tesla Unity and Tinkla OBD-C Adapter The Bosch radar made for Tesla (Bosch MRRevo14, and with few different part numbers like 1038224-00-A/B or 1057551-00-B) have been used on Tesla Model S cars from October 2014 (AP1) until they have been replaced by the Continental radar with AP2.5). The main difference between 1038224-00-B and 1038224-00-A is that the A version does not have the heater element for winter weather (to melt snow and ice). The radar has a range of about 160m and for the short beam a cone of 45\u00b0. Bosch radars Many other car manufacturers use the same radar hardware, including Honda, Nissan, VW, Audi, etc. But Tesla (AFAIK) is the only one that reads and processes raw data from the radar instead of letting the radar make the decision about longitudinal control action needed (acceleration or deceleration). This radar can ben used on any OP supported car. To insall the radar for a non-Tesla car please find a branch that has the code already done or modify your branch and add the code needed to make the radar talk to the Panda code for your car. More info available here. Decoding the radar With a little help from a group of enthusiasts, we were able to reverse engineer all the messages that AP sends to the radar in order to make it \"talk\". Then we identified the structure of the CAN messages that describe each of the 32 objects this radar can detect. Signals like longitudinal distance, lateral distance (vs radar), longitudinal relative speed, lateral relative speed, longitudinal acceleration, certainty of detection, etc are all now processed and sent to the radar daemon of Open Pilot, improving longitudinal control for the car. What you need In order to get the radar working on your car, you need to buy a radar , a mounting bracket , and a radar harness and run the cable back to the Tinkla OBD-C Adapter. DIY people can also follow the old method using a 3D printed mount and a home-made harness. Keep in mind these mounts stay farther back, are influenced by the harness and 12V post that are close to them AND are not adjustable, aka can not be calibrated. But, if you like a challenge David has a very nice set of instructions. Installing the radar kit Start by taking out the nose cone and disassembling the frunk completely (needed to connect the ground of the harness only). The radar mount uses the mounting point for the 12V post (which is then relocated on the radar mount). Start by taking out the two screws that hold the 12V post. Make sure the rubber cap on the 12V post remains on at all times. Once you remove the two screws, save them somewhere in case you want later to remove the bracket and install the 12V post back. We will not need them for this install. Set the 12V post aside. Attach the radar bracket to the front bumper using the provided 5mm black screws and 5mm split lock washers. Ensure the bracket is well secured. Remove the provided 6mm lock nuts and washers from the two posts on the bracket and mount the 12V post. Add the flat washers and tighten the 6mm lock nuts. Carefully install the radar. The connector for the harness will go up. once the top part is inserted and locked in position push in the bottom until it clicks. Make sure the harness that runs along the bumper (which goes to the front lights and the park sensors) goes over the radar harness connector in the back. Otherwise the metal in the harness will affect the radar. Now that we are done installing the radar it is time to run the Tinkla Radar Harness. First connect the harness to the radar. Make sure it is well secured. Will require a little force as it is a water-tight harness. Second step is to attach the ground. The ground post is behind the radar in the frunk area, as shown in the image below. Take the nut out, insert the ground connector there, then tighten well the nut back. Next we will connect the 12v to the fuse box on the right side of the frunk as you look at the car from the front. Remove fuse F75 from the fuse box. Plug this fuse into the remaining slot in the fuse tap that came with the harness and plug the fuse tap in the location from which you removed the fuse. Now for the can wires, start from the frunk area and go under the fender to the door, then through the door seal inside the car. There was already a hole in the door seal there for me. Your miles may vary. Now just connect the JST2.5 connector at the end of the radar harness inside the OBD-C adapter in the radar port. With the harness ran from front to back, now it's time to tidy it up a little and secure it in few places with some zip ties. Then put the frunk back together. In openpilot, setup the radar configuration (see below), follow the instructions to perform the VIN Learn, and then follow the process for the radar calibration. Once done you can put the nosecone back and you're done. When putting the nosecone back, please make sure the harness that goes to the park sensor does not get in front of the radar as you install the nosecone. Modifying the configuration settings for radar It is important now to take the time to configure the setting in Tesla Unity in order to activate the radar. Before moving to the next step, please turn ON the toggle for**Use Tesla Radar**and appropriately configure the**Radar behind nosecone**and**Radar offset**. When using the Tinkla Radar Bracket which mounts the radar upside down, also enable the toggle for**Use Radar Upside Down** Programming your radar - VIN Learning Chances are you bought your Tesla Bosch Radar on ebay and was previously installed and programmed in a car (so it will only respond if we send the right VIN, epas type and position). In order to make the radar work on your car you will have to go through the**Radar VIN Learn**process that can be started using the button with the same name at the bottom of the**Tesla pre AP**settings page. Ensure your Radar is installed in your vehicle and connected to the Tinkla OBD-C Adapteror to your specific harness. Ensure that all the settings are configured correctly for your radar, especially enabling the radar and specifying if it is behind the nose cone or not. Using the**Radar VIN Learn**button under the**Tesla pre AP**tab of settings start the programming process Before hitting the**VIN Lrn**button, ensure your car is on (in P - Park) and continue to keep your foot on the brake throughout the process. Hit the**VIN Lrn**button and the screen will show the progress. Your car might emit warnings and sounds during this process, which is normal. Once process is complete, allow the car to go in \"CAR OFF\" mode and reboot your Comma devkit. You are now ready to use your Tesla Bosch Radar. Calibrating your radar Determine the center of car Most likely the radar will have to be calibrated in order to ensure the correct data being fed into Open Pilot. In order to calibrate your radar you will need: the calibrate Radar.py script which for those running on one of my Tesla branches is located in**/data/openpilot/selfdrive/car/tesla/radar_tools/** a 4ft (120 cm) metal pole that can stay vertically by itself (I personally use a microphone stand) a 3.5mm hex head nut driver with a long neck that can fit through the front grille holes tape measure chalk computer or phone to SSH into EON and view data First, we need to create a straight line that is perfectly centered on the car (for this you will need another person to hold one end of the tape). Follow these steps: start from the left front wheel well, measure 8 ft (2.5m) out towards the center of the car and draw an arch of the circle using the chalk. repeat the process from the right front wheel the place where your two arches intersect will be point A. (see blue lines in diagram) repeat the process above but measure out 16.5 ft (5 m) the place where your two new arches intersect will be point B (see red lines in diagram) connect points A and B with a line; this line is now along the center of the car (see green line in diagram) Now that we have the line that marks the zero d Y line, let's start the calibration script: start OP (OP might stop when you leave the car; what i did was to leave open the driver window, put a heavy backpack on the driver seat, connect the driver seatbelt and turn the car on; this way it ensured that OP remained running) SSH into EON and go to the folder where the calibrate Radar.py is- cd /data/openpilot/selfdrive/car/tesla/radar_tools/ set the python environment- export PYTHONPATH=\"/data/openpilot/\" run the calibration script- python calibrate Radar.py The script will start showing data for objects between 8 ft (2.5 m) and 15 ft (4.5 m) in front of the car. Now the calibration process starts: place the metal pole (again, i used a microphne stand) in the middle of the line that connects A and B look at the terminal window running the calibration script and check x and y values for distance:- you should see data from the script showing**d Rel**and**d Y**as some of the points; keep in mind the values are always in meters measure the distance between the radar and the pole: it should match the**d Rel**distance **d Y**should be 0.0 if you can not see the pole at all or**d Rel**is greater than the real measured distance, you will need to adjust the radar vertically until they match. if**d Y**is not zero, adjust the radar position Left or Right until**d Y**is 0.0 once**d Y**is 0.0 move the pole along the line connecting A and B repeating the above process you are done when no matter where you place the pole between A and B,**d Y**is always 0.0 Troubleshooting the Tesla Bosch Radar The radar sends data for the first 5 seconds no matter what we send to it. But if we are sending the wrong info (VIN, position or epas) it will stop sending changes to the data after 5 seconds. At this point we have to see what exactly is happening with the radar by looking at the alerts it generates. In order to do so you can run the script created to get the errors from the radar. start OP SSH into EON and go to the folder where the get Radar Error Codes.py is- cd /data/openpilot/selfdrive/car/tesla/radar_tools/ set the python environment- export PYTHONPATH=\"/data/openpilot/\" run the calibration script- python get Radar Error Codes.py The script will start showing errors from the radar (if present) or say**No Errors**if everything works as expected.","title":"Tesla Radar"},{"location":"Tesla_Bosch_Radar/#bosch-radars","text":"Many other car manufacturers use the same radar hardware, including Honda, Nissan, VW, Audi, etc. But Tesla (AFAIK) is the only one that reads and processes raw data from the radar instead of letting the radar make the decision about longitudinal control action needed (acceleration or deceleration). This radar can ben used on any OP supported car. To insall the radar for a non-Tesla car please find a branch that has the code already done or modify your branch and add the code needed to make the radar talk to the Panda code for your car. More info available here.","title":"Bosch radars"},{"location":"Tesla_Bosch_Radar/#decoding-the-radar","text":"With a little help from a group of enthusiasts, we were able to reverse engineer all the messages that AP sends to the radar in order to make it \"talk\". Then we identified the structure of the CAN messages that describe each of the 32 objects this radar can detect. Signals like longitudinal distance, lateral distance (vs radar), longitudinal relative speed, lateral relative speed, longitudinal acceleration, certainty of detection, etc are all now processed and sent to the radar daemon of Open Pilot, improving longitudinal control for the car.","title":"Decoding the radar"},{"location":"Tesla_Bosch_Radar/#what-you-need","text":"In order to get the radar working on your car, you need to buy a radar , a mounting bracket , and a radar harness and run the cable back to the Tinkla OBD-C Adapter. DIY people can also follow the old method using a 3D printed mount and a home-made harness. Keep in mind these mounts stay farther back, are influenced by the harness and 12V post that are close to them AND are not adjustable, aka can not be calibrated. But, if you like a challenge David has a very nice set of instructions.","title":"What you need"},{"location":"Tesla_Bosch_Radar/#installing-the-radar-kit","text":"Start by taking out the nose cone and disassembling the frunk completely (needed to connect the ground of the harness only). The radar mount uses the mounting point for the 12V post (which is then relocated on the radar mount). Start by taking out the two screws that hold the 12V post. Make sure the rubber cap on the 12V post remains on at all times. Once you remove the two screws, save them somewhere in case you want later to remove the bracket and install the 12V post back. We will not need them for this install. Set the 12V post aside. Attach the radar bracket to the front bumper using the provided 5mm black screws and 5mm split lock washers. Ensure the bracket is well secured. Remove the provided 6mm lock nuts and washers from the two posts on the bracket and mount the 12V post. Add the flat washers and tighten the 6mm lock nuts. Carefully install the radar. The connector for the harness will go up. once the top part is inserted and locked in position push in the bottom until it clicks. Make sure the harness that runs along the bumper (which goes to the front lights and the park sensors) goes over the radar harness connector in the back. Otherwise the metal in the harness will affect the radar. Now that we are done installing the radar it is time to run the Tinkla Radar Harness. First connect the harness to the radar. Make sure it is well secured. Will require a little force as it is a water-tight harness. Second step is to attach the ground. The ground post is behind the radar in the frunk area, as shown in the image below. Take the nut out, insert the ground connector there, then tighten well the nut back. Next we will connect the 12v to the fuse box on the right side of the frunk as you look at the car from the front. Remove fuse F75 from the fuse box. Plug this fuse into the remaining slot in the fuse tap that came with the harness and plug the fuse tap in the location from which you removed the fuse. Now for the can wires, start from the frunk area and go under the fender to the door, then through the door seal inside the car. There was already a hole in the door seal there for me. Your miles may vary. Now just connect the JST2.5 connector at the end of the radar harness inside the OBD-C adapter in the radar port. With the harness ran from front to back, now it's time to tidy it up a little and secure it in few places with some zip ties. Then put the frunk back together. In openpilot, setup the radar configuration (see below), follow the instructions to perform the VIN Learn, and then follow the process for the radar calibration. Once done you can put the nosecone back and you're done. When putting the nosecone back, please make sure the harness that goes to the park sensor does not get in front of the radar as you install the nosecone.","title":"Installing the radar kit"},{"location":"Tesla_Bosch_Radar/#modifying-the-configuration-settings-for-radar","text":"It is important now to take the time to configure the setting in Tesla Unity in order to activate the radar. Before moving to the next step, please turn ON the toggle for**Use Tesla Radar**and appropriately configure the**Radar behind nosecone**and**Radar offset**. When using the Tinkla Radar Bracket which mounts the radar upside down, also enable the toggle for**Use Radar Upside Down**","title":"Modifying the configuration settings for radar"},{"location":"Tesla_Bosch_Radar/#programming-your-radar-vin-learning","text":"Chances are you bought your Tesla Bosch Radar on ebay and was previously installed and programmed in a car (so it will only respond if we send the right VIN, epas type and position). In order to make the radar work on your car you will have to go through the**Radar VIN Learn**process that can be started using the button with the same name at the bottom of the**Tesla pre AP**settings page. Ensure your Radar is installed in your vehicle and connected to the Tinkla OBD-C Adapteror to your specific harness. Ensure that all the settings are configured correctly for your radar, especially enabling the radar and specifying if it is behind the nose cone or not. Using the**Radar VIN Learn**button under the**Tesla pre AP**tab of settings start the programming process Before hitting the**VIN Lrn**button, ensure your car is on (in P - Park) and continue to keep your foot on the brake throughout the process. Hit the**VIN Lrn**button and the screen will show the progress. Your car might emit warnings and sounds during this process, which is normal. Once process is complete, allow the car to go in \"CAR OFF\" mode and reboot your Comma devkit. You are now ready to use your Tesla Bosch Radar.","title":"Programming your radar - VIN Learning"},{"location":"Tesla_Bosch_Radar/#calibrating-your-radar","text":"Determine the center of car Most likely the radar will have to be calibrated in order to ensure the correct data being fed into Open Pilot. In order to calibrate your radar you will need: the calibrate Radar.py script which for those running on one of my Tesla branches is located in**/data/openpilot/selfdrive/car/tesla/radar_tools/** a 4ft (120 cm) metal pole that can stay vertically by itself (I personally use a microphone stand) a 3.5mm hex head nut driver with a long neck that can fit through the front grille holes tape measure chalk computer or phone to SSH into EON and view data First, we need to create a straight line that is perfectly centered on the car (for this you will need another person to hold one end of the tape). Follow these steps: start from the left front wheel well, measure 8 ft (2.5m) out towards the center of the car and draw an arch of the circle using the chalk. repeat the process from the right front wheel the place where your two arches intersect will be point A. (see blue lines in diagram) repeat the process above but measure out 16.5 ft (5 m) the place where your two new arches intersect will be point B (see red lines in diagram) connect points A and B with a line; this line is now along the center of the car (see green line in diagram) Now that we have the line that marks the zero d Y line, let's start the calibration script: start OP (OP might stop when you leave the car; what i did was to leave open the driver window, put a heavy backpack on the driver seat, connect the driver seatbelt and turn the car on; this way it ensured that OP remained running) SSH into EON and go to the folder where the calibrate Radar.py is- cd /data/openpilot/selfdrive/car/tesla/radar_tools/ set the python environment- export PYTHONPATH=\"/data/openpilot/\" run the calibration script- python calibrate Radar.py The script will start showing data for objects between 8 ft (2.5 m) and 15 ft (4.5 m) in front of the car. Now the calibration process starts: place the metal pole (again, i used a microphne stand) in the middle of the line that connects A and B look at the terminal window running the calibration script and check x and y values for distance:- you should see data from the script showing**d Rel**and**d Y**as some of the points; keep in mind the values are always in meters measure the distance between the radar and the pole: it should match the**d Rel**distance **d Y**should be 0.0 if you can not see the pole at all or**d Rel**is greater than the real measured distance, you will need to adjust the radar vertically until they match. if**d Y**is not zero, adjust the radar position Left or Right until**d Y**is 0.0 once**d Y**is 0.0 move the pole along the line connecting A and B repeating the above process you are done when no matter where you place the pole between A and B,**d Y**is always 0.0","title":"Calibrating your radar"},{"location":"Tesla_Bosch_Radar/#troubleshooting-the-tesla-bosch-radar","text":"The radar sends data for the first 5 seconds no matter what we send to it. But if we are sending the wrong info (VIN, position or epas) it will stop sending changes to the data after 5 seconds. At this point we have to see what exactly is happening with the radar by looking at the alerts it generates. In order to do so you can run the script created to get the errors from the radar. start OP SSH into EON and go to the folder where the get Radar Error Codes.py is- cd /data/openpilot/selfdrive/car/tesla/radar_tools/ set the python environment- export PYTHONPATH=\"/data/openpilot/\" run the calibration script- python get Radar Error Codes.py The script will start showing errors from the radar (if present) or say**No Errors**if everything works as expected.","title":"Troubleshooting the Tesla Bosch Radar"},{"location":"Tesla_Bosch_Radar_EON/","text":"The Bosch radar made for Tesla (Bosch MRRevo14, and with few different part numbers like 1038224-00-A/B or 1057551-00-B) have been used on Tesla Model S cars from October 2014 (AP1) until they have been replaced by the Continental radar with AP2.5). The main difference between 1038224-00-B and 1038224-00-A is that the A version does not have the heater element for winter weather (to melt snow and ice). The radar has a range of about 160m and for the short beam a cone of 45\u00b0. Bosch radars Many other car manufacturers use the same radar hardware, including Honda, Nissan, VW, Audi, etc. But Tesla (AFAIK) is the only one that reads and processes raw data from the radar instead of letting the radar make the decision about longitudinal control action needed (acceleration or deceleration). This radar can ben used on any OP supported car. To insall the radar for a non-Tesla car please find a branch that has the code already done or modify your branch and add the code needed to make the radar talk to the Panda code for your car. Deconding the radar With a little help from a group of enthusiasts, we were able to reverse engineer all the messages that AP sends to the radar in order to make it \"talk\". Then we identified the structure of the CAN messages that describe each of the 32 objects this radar can detect. Signals like longitudinal distance, lateral distance (vs radar), longitudinal relative speed, lateral relative speed, longitudinal acceleration, certainty of detection, etc are all now processed and sent to the radar daemon of Open Pilot, improving longitudinal control for the car. What you need In order to get the radar working on your car, you need to buy a radar, a mounting bracket (few options here), a connector and then to create a harness and run the cable back to the Giraffe . As a first temporary setup for my research, I used an Audi bracket which I installed on my car's nose cone. Then I created the harness and connected it for both CAN and power to my Giraffe rev B using a car relay. Please also make sure you add the 120\u03a9 resistor between CAN+ and CAN-. For a permanent install I recommend following the diagram in the Tesla Bosch Radar Wiring Harness image at the top of the page. This setup uses the EPAS power (which is ignition power) to trigger a relay and feed power to both the radar electronics and the heater unit of the radar. Make sure the line from the battery is fused. Please also make sure you add the 120\u03a9 resistor between CAN+ and CAN-. Also please use the AWG chart to select the right wire needed for your setup. If you have a Giraffe rev A, you will have to solder the CAN wires from the radar directly to the Giraffe. We are using the middle CAN of the Panda (CAN2 when you think of them as CAN1-CH, CAN3-EPAS) and the pins where you should solder your connector are marked in this diagrams. Also, you will have to add the same 120\u03a9 resistor between CAN+ and CAN-. For other cars that want to use the Tesla Bosch Radar, please find an unused CAN in your Panda safety implementation and use that CAN to communicate with the radar. The radar has to be on its own specific CAN because any message outside of the ones that it is supposed to receive will make it stop working. Warning for Giraffe Rev B: Some jst2 cables have red/black set up so they won't match can+/can- on giraffe. So make sure can+ goes to the side of the connector on the giraffe labelled +. Panda code changes (non-Tesla cars) If you are on one of my Tesla OP branches (0.5.10 and above), the Panda code already has all you need to get the Tesla Bosch Radar working. If you want to implement the code for another car, you will have to modify the code as follow: find an existing CAN message on your car that is generated at 100Hz. We will use this message as a clock to trigger all the other messages needed by radar. take a look at my test_teslaradar branch which uses the fake message code in safety_teslaradar.h edit**safety_yourcar.h**(specific for your car) and add the following: add the include for safety_teslaradar.h at the top #include \"safety_teslaradar.h\" in the rx_hook function, call the radar rx hook teslaradar_rx_hook(to_push); in the rx_hook function, find the CAN message that provides the speed and parse it (this is a Honda example) saving the value in the*actual_speed_kph*variable //speed for radar if ((to_push->RIR>>21) == 0x309) { // first 2 bytes actual_speed_kph = (int)((((to_push->RDLR & 0x FF) << 8) + ((to_push->RDLR >>8) & 0x FF))*0.01); } in the fwd_hook function, make sure you do not forward any of the radar messages to any other CAN bus (in this example, the radar is on CAN bus 2) if(bus_num == 2) { return -1; } in the tx_hook function add interceptor for the message used to send info to the radar; in this example we use 0x560 as the CAN message ID; it this does not work for your car (already in use) you will have to change it to another ID that is not in use //check if this is a teslaradar vin message //capture message for radar VIN and settings if ((to_send->RIR >> 21) == 0x560) { int id = (to_send->RDLR & 0x FF); int radar Vin_b1 = ((to_send->RDLR >> 8) & 0x FF); int radar Vin_b2 = ((to_send->RDLR >> 16) & 0x FF); int radar Vin_b3 = ((to_send->RDLR >> 24) & 0x FF); int radar Vin_b4 = (to_send->RDHR & 0x FF); int radar Vin_b5 = ((to_send->RDHR >> 8) & 0x FF); int radar Vin_b6 = ((to_send->RDHR >> 16) & 0x FF); int radar Vin_b7 = ((to_send->RDHR >> 24) & 0x FF); if (id == 0) { tesla_radar_should_send = (radar Vin_b2 & 0x01); radar Position = ((radar Vin_b2 >> 1) & 0x03); radar Epas Type = ((radar Vin_b2 >> 3) & 0x07); tesla_radar_trigger_message_id = (radar Vin_b3 << 8) + radar Vin_b4; tesla_radar_can = radar Vin_b1; radar_VIN [0] = radar Vin_b5; radar_VIN [1] = radar Vin_b6; radar_VIN [2] = radar Vin_b7; tesla_radar_vin_complete = tesla_radar_vin_complete | 1; } if (id == 1) { radar_VIN [3] = radar Vin_b1; radar_VIN [4] = radar Vin_b2; radar_VIN [5] = radar Vin_b3; radar_VIN [6] = radar Vin_b4; radar_VIN [7] = radar Vin_b5; radar_VIN [8] = radar Vin_b6; radar_VIN [9] = radar Vin_b7; tesla_radar_vin_complete = tesla_radar_vin_complete | 2; } if (id == 2) { radar_VIN [10] = radar Vin_b1; radar_VIN [11] = radar Vin_b2; radar_VIN [12] = radar Vin_b3; radar_VIN [13] = radar Vin_b4; radar_VIN [14] = radar Vin_b5; radar_VIN [15] = radar Vin_b6; radar_VIN [16] = radar Vin_b7; tesla_radar_vin_complete = tesla_radar_vin_complete | 4; } else { return 0; } } OP Code Changes (non-Tesla cars) If you are on one of my Tesla OP branches (0.5.10 and above), the OP code already has all you need to get the Tesla Bosch Radar working. If you want to implement the code for another car, you will have to modify the code as follow: go to /data/openpilot/selfdrive/car/yourcar (of course, yourcar matches one of the supported OP cars like honda/toyota/etc.) edit**yourcarcan.py**and add the code needed to send the VIN and other info to the Panda def create_radar_VIN_msg(id,radar VIN,radar CAN,radar Trigger Message,use Radar,radar Position,radar Epas Type): msg_id = 0x560 msg_len = 8 msg = create_string_buffer(msg_len) if id == 0: struct.pack_into('BBBBBBBB', msg, 0, id,radar CAN,use Radar + (radar Position << 1) + (radar Epas Type << 3), ((radar Trigger Message >> 8) & 0x FF),(radar Trigger Message & 0x FF),ord(radar VIN [0]),ord(radar VIN [1]),ord(radar VIN [2])) if id == 1: struct.pack_into('BBBBBBBB', msg, 0, id,ord(radar VIN [3]),ord(radar VIN [4]),ord(radar VIN [5]),ord(radar VIN [6]),ord(radar VIN [7]),ord(radar VIN [8]),ord(radar VIN [9])) if id == 2: struct.pack_into('BBBBBBBB', msg, 0, id,ord(radar VIN [10]),ord(radar VIN [11]),ord(radar VIN [12]),ord(radar VIN [13]),ord(radar VIN [14]),ord(radar VIN [15]),ord(radar VIN [16])) return [msg_id, 0, msg.raw, 0] edit**carcontroller.py**and add the code needed to send the VIN and other specific radar info to Panda in the init portion add self.radar Vin_idx = 0 in the update portion add the below code, updating as needed the CAN bus to be used for radar (in this example 2) and the 100Hz message we will use to trigger messages (in this example 0x17c) #if using radar, we need to send the VIN if CS.use Tesla Radar and (frame % 100 == 0): can_sends.append(hondacan.create_radar_VIN_msg(self.radar Vin_idx, CS.radar VIN, 2, 0x17c, CS.use Tesla Radar, CS.radar Position, CS.radar Epas Type)) self.radar Vin_idx += 1 self.radar Vin_idx = self.radar Vin_idx % 3 copy from my repo the readconfig_min.py and rename it**readconfig.py**; once you are done with all the code changes and reboot the EON, this will create a minimal Open Pilot Configuration File at /data/bb_openpilot.cfg with the values needed for radar edit**carstate.py** add the import for the readconfig.py from selfdrive.car.honda.readconfig import read_config_file add definition in init for the variables needed by radar ### START OF MAIN CONFIG OPTIONS ### ### Do NOT modify here, modify in /data/bb_openpilot.cfg and reboot self.use Tesla Radar = False self.radar VIN = \" \" self.radar Offset = 0. self.radar Position = 0 self.radar Epas Type = 0 #read config file read_config_file(self) ### END OF MAIN CONFIG OPTIONS ### copy from my repo the radar_interface.py file and modify if needed copy from my repo the radard.py to /data/openpilot/selfdrive/controls and modify as needed copy from my repo the radar_helpers.py to /data/openpilot/selfdrive/controls/lib and modify as needed Obtain the VIN programmed in your radar Chances are you bought your Tesla Bosch Radar on ebay and was previously installed and programmed in a car (so it will only respond if we send the right VIN, epay type and position). The first step in getting the radar to send data is to obtain the VIN that was previously programmed. To get the VIN you will have to use the read Radar Vin.py script (if you are on one of my branches the file is located in /data/openpilot/selfdrive/car/tesla/radar_tools/ ). Once you have the scrip do the following steps: SSH into the EON cd /data/openpilot/selfdrive/car/tesla/radar_tools/ (or go to the location where you saved the script) kill Open Pilot:- tmux kill-session -t comma set the python environment variable- export PYTHONPATH=\"/data/openpilot/\" run the read Radar Vin.py script- python read Radar Vin.py The 17 character VIN number will be displayed in the output of the script. Write it down. It should look something like 5YJSA1E41FF156789 Modifying the configuration file for radar Now that we have the VIN, we need to configure the Open Pilot Configuration File with the needed parameters. [OP_CONFIG] use_tesla_radar = True enable_radar_emulation = True radar_vin = YOUR_RADAR_VIN_HERE radar_offset = 0.0 radar_epas_type = 0 radar_position = 0 So make sure that the**use_tesla_radar**variable is set to True. radar_vin**need to match the VIN you obtain from the read Radar Vin.py script (do not put any quotes or any other characters on that line, just the VIN). Example:**5YJSA1E41FF156789 **radar_offset**has to be changed only if your radar is not centered on the car (some cars have it closer to the left side of the car, in which case the offset should be positive and equal to the distance between the center of the radar and center of the car, in meters; for example 58cm will be 0.58 for offset). The following settings need to match the values that were on the donor car, not your car. Use the VIN Decoder to understand the Tesla model, year and other information that can help you program these parameters. **radar_epas_type**is the type of EPAS that was on the donor car. The value can be between 0 and 4: 0 - Bosch L538 1 - Bosch L405 2 - Mando FGR64 3 - Mando VGR66 4 - Mando VGR66 Gen3 For pre-facelift AP1 cars you will find mostly 0 or 1. Post facelift cars are mostly 3 or 4. But nothing can give you the exact value and you might have to try various values until RADC_a062_str Rack Mismatch in Tesla Radar Alert Matrix message is 0. See the troubleshooting section to learn how to look at the Tesla Radar Alert Matrix message in Cabana . **radar_position**is the position of the radar in the donor car. The value can be between 0 and 2: 0 - Model S (pre facelift) 1 - Model S (post facelift) 2 - Model X You can use the manufacturing date and model from VIN Decoder to estimate your value. 2014 and 2015 Model S will always be 0. 2017 and above Model S will be 1. Model X will be always 2. But again nothing will give you the exact value and you might have to try 0 or 1 if the Model S was manufactured in 2016 because it could be 0 (pre April 2016) or 1 (post April 2016). The value of RADC_a061_rad Position Mismatch in Tesla Radar Alert Matrix message should be 0 if programmed correctly. See the troubleshooting section to learn how to look at the Tesla Radar Alert Matrix message in Cabana . You can find an explanation of each of the parameters here . Once done, reboot your EON. Calibrating your radar Determine the center of car Most likely the radar will have to be calibrated in order to ensure the correct data being fed into Open Pilot. In order to calibrate your radar you will need: the calibrate Radar.py script which for those running on one of my Tesla branches is located in**/data/openpilot/selfdrive/car/tesla/radar_tools/** a 4ft (120 cm) metal pole that can stay vertically by itself (I personally use a microphone stand) tape measure chalk computer or phone to SSH into EON and view data First, we need to create a straight line that is perfectly centered on the car (for this you will need another person to hold one end of the tape). Follow these steps: start from the left front wheel well, measure 8 ft (2.5m) out towards the center of the car and draw an arch of the circle using the chalk. repeat the process from the right front wheel the place where your two arches intersect will be point A. (see blue lines in diagram) repeat the process above but measure out 16.5 ft (5 m) the place where your two new arches intersect will be point B (see red lines in diagram) connect points A and B with a line; this line is now along the center of the car (see green line in diagram) Now that we have the line that marks the zero d Y line, let's start the calibration script: start OP (OP might stop when you leave the car; what i did was to put open the driver window, put a heavy backpack on the driver seat, connect the driver seatbelt and turn the car on; this way it ensured that OP remained running) SSH into EON and go to the folder where the calibrate Radar.py is- cd /data/openpilot/selfdrive/car/tesla/radar_tools/ set the python environment- export PYTHONPATH=\"/data/openpilot/\" run the calibration script- python calibrate Radar.py The script will start showing data for objects between 8 ft (2.5 m) and 15 ft (4.5 m) in front of the car. Now the calibration process starts: place the metal pole (again, i used a microphne stand) in the middle of the line that connects A and B look at the terminal window running the calibration script and check x and y values for distance:- you should see data from the script showing**d Rel**and**d Y**as some of the points; keep in mind the values are always in meters measure the distance between the radar and the pole: it should match the**d Rel**distance **d Y**should be 0.0 if you can not see the pole at all or**d Rel**is greater than the real measured distance, you will need to adjust the radar vertically until they match. if**d Y**is not zero, adjust the radar position Left or Right until**d Y**is 0.0 once**d Y**is 0.0 move the pole along the line connecting A and B repeating the above process you are done when no matter where you place the pole between A and B,**d Y**is always 0.0 Troubleshooting the Tesla Bosch Radar The radar send data for the first 5 seconds no matter what we send to it. But if we are sending the wrong info (VIN, position or epas) it will stop sending changes to the data after 5 seconds. At this point we have to see what exactly is happening with the radar by looking at the allerts it generates. You can use cabana and paste the following code in the DBC in order to understand what errors the radar is sending and what you need to change. Once you opened your cabana drive, click Load DBC, then Upload, and copy and paste the content from below to the DBC area. Then just look at the message called Tesla Radar Alert Matrix and see if you have any errors. Calibration warnings will not stop radar from operating. (Make sure you're looking at 1:501 for Tesla Radar Alert Matrix, not 0:501) VERSION \"\" NS_ : NS_DESC_ CM_ BA_DEF_ BA_ VAL_ CAT_DEF_ CAT_ FILTER BA_DEF_DEF_ EV_DATA_ ENVVAR_DATA_ SGTYPE_ SGTYPE_VAL_ BA_DEF_SGTYPE_ BA_SGTYPE_ SIG_TYPE_REF_ VAL_TABLE_ SIG_GROUP_ SIG_VALTYPE_ SIGTYPE_VALTYPE_ BO_TX_BU_ BA_DEF_REL_ BA_REL_ BA_DEF_DEF_REL_ BU_SG_REL_ BU_EV_REL_ BU_BO_REL_ SG_MUL_VAL_ BS_: BU_: Front Camera Radar BO_ 769 Tesla Radar Sgu Info: 8 Radar SG_ RADC_Vertical Misalignment : 0|8@1+ (1,0) [0|255] \"\" Front Camera SG_ RADC_SCUTemperature : 8|8@1+ (1,-128) [-128|127] \"\" Front Camera SG_ RADC_VMA_Plaus : 16|8@1+ (1,0) [0|255] \"\" Front Camera SG_ RADC_SGU_ITC : 24|8@1+ (1,0) [0|255] \"\" Front Camera SG_ RADC_Horizont Misalignment : 32|12@1+ (1,0) [0|4096] \"\" Front Camera SG_ RADC_Sensor Dirty : 44|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_HWFail : 45|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_SGUFail : 46|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_SGUInfo Consist Bit : 47|1@1+ (1,0) [0|1] \"\" Front Camera BO_ 770 Tesla Radar Tgu Info: 8 Radar SG_ RADC_ACCTarg Obj1_sgu Index : 0|6@1+ (1,0) [0|63] \"\" Front Camera SG_ RADC_ACCTarg Obj2_sgu Index : 6|6@1+ (1,0) [0|63] \"\" Front Camera SG_ RADC_ACCTarg Obj3_sgu Index : 12|6@1+ (1,0) [0|63] \"\" Front Camera SG_ RADC_ACCTarg Obj4_sgu Index : 18|6@1+ (1,0) [0|63] \"\" Front Camera SG_ RADC_ACCTarg Obj5_sgu Index : 24|6@1+ (1,0) [0|63] \"\" Front Camera SG_ unused30 : 30|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_TGUInfo Consist Bit : 31|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_ACCTarg Obj1_d BPower : 32|16@1+ (1,0) [0|65535] \"\" Front Camera SG_ RADC_ACCTarg Obj5_d BPower : 48|16@1+ (1,0) [0|65535] \"\" Front Camera BO_ 1281 Tesla Radar Alert Matrix: 8 Radar SG_ RADC_a001_ecu Internal Perf : 0|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a002_flash Performance : 1|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a003_v Bat High : 2|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a004_adjustment Not Done : 3|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a005_adjustment Req : 4|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a006_adjustment Not Ok : 5|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a007_sensor Blinded : 6|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a008_plant Mode Active : 7|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a009_config Mismatch : 8|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a010_can Bus Off : 9|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a011_bdy MIA : 10|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a012_esp MIA : 11|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a013_gtw MIA : 12|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a014_sccm MIA : 13|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a015_adas MIA : 14|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a016_bdy Invalid Count : 15|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a017_adas Invalid Count : 16|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a018_esp Invalid Count : 17|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a019_sccm Invalid Count : 18|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a020_bdy Invalid Chk Sm : 19|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a021_esp Invalid Chk Sm : 20|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a022_sccm Invalid Chk Sm : 21|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a023_sccm Invalid Chk Sm : 22|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a024_abs Validity : 23|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a025_amb TValidity : 24|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a026_brake Validity : 25|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a027_Cntry Cd Validity : 26|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a028_esp Validity : 27|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a029_long Acc Off Validity : 28|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a030_long Acc Validity : 29|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a031_odo Validity : 30|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a032_gear Validity : 31|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a033_steer Ang Validity : 32|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a034_steer Ang Spd Validity : 33|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a035_indctr Validity : 34|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a036_veh Stand Still Validity : 35|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a037_vin Validity : 36|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a038_whl Rot Validity : 37|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a039_whl Spd Validity : 38|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a040_whl Stand Still Validity : 39|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a041_wiper Validity : 40|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a042_xwd Validity : 41|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a043_yaw Off Validity : 42|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a044_yaw Validity : 43|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a045_bsd Sanity : 44|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a046_rcta Sanity : 45|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a047_lcw Sanity : 46|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a048_steer Ang Off Sanity : 47|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a049_tire Size Sanity : 48|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a050_velocity Sanity : 49|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a051_yaw Sanity : 50|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a052_radome Htr Inop : 51|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a053_espmod Validity : 52|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a054_gtwmod Validity : 53|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a055_stwmod Validity : 54|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a056_bcmod Validity : 55|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a057_dimod Validity : 56|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a058_opmod Validity : 57|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a059_drmi Invalid Chk Sm : 58|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a060_drmi Invalid Count : 59|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a061_rad Position Mismatch : 60|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a062_str Rack Mismatch : 61|1@1+ (1,0) [0|1] \"\" Front Camera SG_ unused62 : 62|2@1+ (1,0) [0|3] \"\" Front Camera","title":"Radar (EON)"},{"location":"Tesla_Bosch_Radar_EON/#bosch-radars","text":"Many other car manufacturers use the same radar hardware, including Honda, Nissan, VW, Audi, etc. But Tesla (AFAIK) is the only one that reads and processes raw data from the radar instead of letting the radar make the decision about longitudinal control action needed (acceleration or deceleration). This radar can ben used on any OP supported car. To insall the radar for a non-Tesla car please find a branch that has the code already done or modify your branch and add the code needed to make the radar talk to the Panda code for your car.","title":"Bosch radars"},{"location":"Tesla_Bosch_Radar_EON/#deconding-the-radar","text":"With a little help from a group of enthusiasts, we were able to reverse engineer all the messages that AP sends to the radar in order to make it \"talk\". Then we identified the structure of the CAN messages that describe each of the 32 objects this radar can detect. Signals like longitudinal distance, lateral distance (vs radar), longitudinal relative speed, lateral relative speed, longitudinal acceleration, certainty of detection, etc are all now processed and sent to the radar daemon of Open Pilot, improving longitudinal control for the car.","title":"Deconding the radar"},{"location":"Tesla_Bosch_Radar_EON/#what-you-need","text":"In order to get the radar working on your car, you need to buy a radar, a mounting bracket (few options here), a connector and then to create a harness and run the cable back to the Giraffe . As a first temporary setup for my research, I used an Audi bracket which I installed on my car's nose cone. Then I created the harness and connected it for both CAN and power to my Giraffe rev B using a car relay. Please also make sure you add the 120\u03a9 resistor between CAN+ and CAN-. For a permanent install I recommend following the diagram in the Tesla Bosch Radar Wiring Harness image at the top of the page. This setup uses the EPAS power (which is ignition power) to trigger a relay and feed power to both the radar electronics and the heater unit of the radar. Make sure the line from the battery is fused. Please also make sure you add the 120\u03a9 resistor between CAN+ and CAN-. Also please use the AWG chart to select the right wire needed for your setup. If you have a Giraffe rev A, you will have to solder the CAN wires from the radar directly to the Giraffe. We are using the middle CAN of the Panda (CAN2 when you think of them as CAN1-CH, CAN3-EPAS) and the pins where you should solder your connector are marked in this diagrams. Also, you will have to add the same 120\u03a9 resistor between CAN+ and CAN-. For other cars that want to use the Tesla Bosch Radar, please find an unused CAN in your Panda safety implementation and use that CAN to communicate with the radar. The radar has to be on its own specific CAN because any message outside of the ones that it is supposed to receive will make it stop working. Warning for Giraffe Rev B: Some jst2 cables have red/black set up so they won't match can+/can- on giraffe. So make sure can+ goes to the side of the connector on the giraffe labelled +.","title":"What you need"},{"location":"Tesla_Bosch_Radar_EON/#panda-code-changes-non-tesla-cars","text":"If you are on one of my Tesla OP branches (0.5.10 and above), the Panda code already has all you need to get the Tesla Bosch Radar working. If you want to implement the code for another car, you will have to modify the code as follow: find an existing CAN message on your car that is generated at 100Hz. We will use this message as a clock to trigger all the other messages needed by radar. take a look at my test_teslaradar branch which uses the fake message code in safety_teslaradar.h edit**safety_yourcar.h**(specific for your car) and add the following: add the include for safety_teslaradar.h at the top #include \"safety_teslaradar.h\" in the rx_hook function, call the radar rx hook teslaradar_rx_hook(to_push); in the rx_hook function, find the CAN message that provides the speed and parse it (this is a Honda example) saving the value in the*actual_speed_kph*variable //speed for radar if ((to_push->RIR>>21) == 0x309) { // first 2 bytes actual_speed_kph = (int)((((to_push->RDLR & 0x FF) << 8) + ((to_push->RDLR >>8) & 0x FF))*0.01); } in the fwd_hook function, make sure you do not forward any of the radar messages to any other CAN bus (in this example, the radar is on CAN bus 2) if(bus_num == 2) { return -1; } in the tx_hook function add interceptor for the message used to send info to the radar; in this example we use 0x560 as the CAN message ID; it this does not work for your car (already in use) you will have to change it to another ID that is not in use //check if this is a teslaradar vin message //capture message for radar VIN and settings if ((to_send->RIR >> 21) == 0x560) { int id = (to_send->RDLR & 0x FF); int radar Vin_b1 = ((to_send->RDLR >> 8) & 0x FF); int radar Vin_b2 = ((to_send->RDLR >> 16) & 0x FF); int radar Vin_b3 = ((to_send->RDLR >> 24) & 0x FF); int radar Vin_b4 = (to_send->RDHR & 0x FF); int radar Vin_b5 = ((to_send->RDHR >> 8) & 0x FF); int radar Vin_b6 = ((to_send->RDHR >> 16) & 0x FF); int radar Vin_b7 = ((to_send->RDHR >> 24) & 0x FF); if (id == 0) { tesla_radar_should_send = (radar Vin_b2 & 0x01); radar Position = ((radar Vin_b2 >> 1) & 0x03); radar Epas Type = ((radar Vin_b2 >> 3) & 0x07); tesla_radar_trigger_message_id = (radar Vin_b3 << 8) + radar Vin_b4; tesla_radar_can = radar Vin_b1; radar_VIN [0] = radar Vin_b5; radar_VIN [1] = radar Vin_b6; radar_VIN [2] = radar Vin_b7; tesla_radar_vin_complete = tesla_radar_vin_complete | 1; } if (id == 1) { radar_VIN [3] = radar Vin_b1; radar_VIN [4] = radar Vin_b2; radar_VIN [5] = radar Vin_b3; radar_VIN [6] = radar Vin_b4; radar_VIN [7] = radar Vin_b5; radar_VIN [8] = radar Vin_b6; radar_VIN [9] = radar Vin_b7; tesla_radar_vin_complete = tesla_radar_vin_complete | 2; } if (id == 2) { radar_VIN [10] = radar Vin_b1; radar_VIN [11] = radar Vin_b2; radar_VIN [12] = radar Vin_b3; radar_VIN [13] = radar Vin_b4; radar_VIN [14] = radar Vin_b5; radar_VIN [15] = radar Vin_b6; radar_VIN [16] = radar Vin_b7; tesla_radar_vin_complete = tesla_radar_vin_complete | 4; } else { return 0; } }","title":"Panda code changes (non-Tesla cars)"},{"location":"Tesla_Bosch_Radar_EON/#op-code-changes-non-tesla-cars","text":"If you are on one of my Tesla OP branches (0.5.10 and above), the OP code already has all you need to get the Tesla Bosch Radar working. If you want to implement the code for another car, you will have to modify the code as follow: go to /data/openpilot/selfdrive/car/yourcar (of course, yourcar matches one of the supported OP cars like honda/toyota/etc.) edit**yourcarcan.py**and add the code needed to send the VIN and other info to the Panda def create_radar_VIN_msg(id,radar VIN,radar CAN,radar Trigger Message,use Radar,radar Position,radar Epas Type): msg_id = 0x560 msg_len = 8 msg = create_string_buffer(msg_len) if id == 0: struct.pack_into('BBBBBBBB', msg, 0, id,radar CAN,use Radar + (radar Position << 1) + (radar Epas Type << 3), ((radar Trigger Message >> 8) & 0x FF),(radar Trigger Message & 0x FF),ord(radar VIN [0]),ord(radar VIN [1]),ord(radar VIN [2])) if id == 1: struct.pack_into('BBBBBBBB', msg, 0, id,ord(radar VIN [3]),ord(radar VIN [4]),ord(radar VIN [5]),ord(radar VIN [6]),ord(radar VIN [7]),ord(radar VIN [8]),ord(radar VIN [9])) if id == 2: struct.pack_into('BBBBBBBB', msg, 0, id,ord(radar VIN [10]),ord(radar VIN [11]),ord(radar VIN [12]),ord(radar VIN [13]),ord(radar VIN [14]),ord(radar VIN [15]),ord(radar VIN [16])) return [msg_id, 0, msg.raw, 0] edit**carcontroller.py**and add the code needed to send the VIN and other specific radar info to Panda in the init portion add self.radar Vin_idx = 0 in the update portion add the below code, updating as needed the CAN bus to be used for radar (in this example 2) and the 100Hz message we will use to trigger messages (in this example 0x17c) #if using radar, we need to send the VIN if CS.use Tesla Radar and (frame % 100 == 0): can_sends.append(hondacan.create_radar_VIN_msg(self.radar Vin_idx, CS.radar VIN, 2, 0x17c, CS.use Tesla Radar, CS.radar Position, CS.radar Epas Type)) self.radar Vin_idx += 1 self.radar Vin_idx = self.radar Vin_idx % 3 copy from my repo the readconfig_min.py and rename it**readconfig.py**; once you are done with all the code changes and reboot the EON, this will create a minimal Open Pilot Configuration File at /data/bb_openpilot.cfg with the values needed for radar edit**carstate.py** add the import for the readconfig.py from selfdrive.car.honda.readconfig import read_config_file add definition in init for the variables needed by radar ### START OF MAIN CONFIG OPTIONS ### ### Do NOT modify here, modify in /data/bb_openpilot.cfg and reboot self.use Tesla Radar = False self.radar VIN = \" \" self.radar Offset = 0. self.radar Position = 0 self.radar Epas Type = 0 #read config file read_config_file(self) ### END OF MAIN CONFIG OPTIONS ### copy from my repo the radar_interface.py file and modify if needed copy from my repo the radard.py to /data/openpilot/selfdrive/controls and modify as needed copy from my repo the radar_helpers.py to /data/openpilot/selfdrive/controls/lib and modify as needed","title":"OP Code Changes (non-Tesla cars)"},{"location":"Tesla_Bosch_Radar_EON/#obtain-the-vin-programmed-in-your-radar","text":"Chances are you bought your Tesla Bosch Radar on ebay and was previously installed and programmed in a car (so it will only respond if we send the right VIN, epay type and position). The first step in getting the radar to send data is to obtain the VIN that was previously programmed. To get the VIN you will have to use the read Radar Vin.py script (if you are on one of my branches the file is located in /data/openpilot/selfdrive/car/tesla/radar_tools/ ). Once you have the scrip do the following steps: SSH into the EON cd /data/openpilot/selfdrive/car/tesla/radar_tools/ (or go to the location where you saved the script) kill Open Pilot:- tmux kill-session -t comma set the python environment variable- export PYTHONPATH=\"/data/openpilot/\" run the read Radar Vin.py script- python read Radar Vin.py The 17 character VIN number will be displayed in the output of the script. Write it down. It should look something like 5YJSA1E41FF156789","title":"Obtain the VIN programmed in your radar"},{"location":"Tesla_Bosch_Radar_EON/#modifying-the-configuration-file-for-radar","text":"Now that we have the VIN, we need to configure the Open Pilot Configuration File with the needed parameters. [OP_CONFIG] use_tesla_radar = True enable_radar_emulation = True radar_vin = YOUR_RADAR_VIN_HERE radar_offset = 0.0 radar_epas_type = 0 radar_position = 0 So make sure that the**use_tesla_radar**variable is set to True. radar_vin**need to match the VIN you obtain from the read Radar Vin.py script (do not put any quotes or any other characters on that line, just the VIN). Example:**5YJSA1E41FF156789 **radar_offset**has to be changed only if your radar is not centered on the car (some cars have it closer to the left side of the car, in which case the offset should be positive and equal to the distance between the center of the radar and center of the car, in meters; for example 58cm will be 0.58 for offset). The following settings need to match the values that were on the donor car, not your car. Use the VIN Decoder to understand the Tesla model, year and other information that can help you program these parameters. **radar_epas_type**is the type of EPAS that was on the donor car. The value can be between 0 and 4: 0 - Bosch L538 1 - Bosch L405 2 - Mando FGR64 3 - Mando VGR66 4 - Mando VGR66 Gen3 For pre-facelift AP1 cars you will find mostly 0 or 1. Post facelift cars are mostly 3 or 4. But nothing can give you the exact value and you might have to try various values until RADC_a062_str Rack Mismatch in Tesla Radar Alert Matrix message is 0. See the troubleshooting section to learn how to look at the Tesla Radar Alert Matrix message in Cabana . **radar_position**is the position of the radar in the donor car. The value can be between 0 and 2: 0 - Model S (pre facelift) 1 - Model S (post facelift) 2 - Model X You can use the manufacturing date and model from VIN Decoder to estimate your value. 2014 and 2015 Model S will always be 0. 2017 and above Model S will be 1. Model X will be always 2. But again nothing will give you the exact value and you might have to try 0 or 1 if the Model S was manufactured in 2016 because it could be 0 (pre April 2016) or 1 (post April 2016). The value of RADC_a061_rad Position Mismatch in Tesla Radar Alert Matrix message should be 0 if programmed correctly. See the troubleshooting section to learn how to look at the Tesla Radar Alert Matrix message in Cabana . You can find an explanation of each of the parameters here . Once done, reboot your EON.","title":"Modifying the configuration file for radar"},{"location":"Tesla_Bosch_Radar_EON/#calibrating-your-radar","text":"Determine the center of car Most likely the radar will have to be calibrated in order to ensure the correct data being fed into Open Pilot. In order to calibrate your radar you will need: the calibrate Radar.py script which for those running on one of my Tesla branches is located in**/data/openpilot/selfdrive/car/tesla/radar_tools/** a 4ft (120 cm) metal pole that can stay vertically by itself (I personally use a microphone stand) tape measure chalk computer or phone to SSH into EON and view data First, we need to create a straight line that is perfectly centered on the car (for this you will need another person to hold one end of the tape). Follow these steps: start from the left front wheel well, measure 8 ft (2.5m) out towards the center of the car and draw an arch of the circle using the chalk. repeat the process from the right front wheel the place where your two arches intersect will be point A. (see blue lines in diagram) repeat the process above but measure out 16.5 ft (5 m) the place where your two new arches intersect will be point B (see red lines in diagram) connect points A and B with a line; this line is now along the center of the car (see green line in diagram) Now that we have the line that marks the zero d Y line, let's start the calibration script: start OP (OP might stop when you leave the car; what i did was to put open the driver window, put a heavy backpack on the driver seat, connect the driver seatbelt and turn the car on; this way it ensured that OP remained running) SSH into EON and go to the folder where the calibrate Radar.py is- cd /data/openpilot/selfdrive/car/tesla/radar_tools/ set the python environment- export PYTHONPATH=\"/data/openpilot/\" run the calibration script- python calibrate Radar.py The script will start showing data for objects between 8 ft (2.5 m) and 15 ft (4.5 m) in front of the car. Now the calibration process starts: place the metal pole (again, i used a microphne stand) in the middle of the line that connects A and B look at the terminal window running the calibration script and check x and y values for distance:- you should see data from the script showing**d Rel**and**d Y**as some of the points; keep in mind the values are always in meters measure the distance between the radar and the pole: it should match the**d Rel**distance **d Y**should be 0.0 if you can not see the pole at all or**d Rel**is greater than the real measured distance, you will need to adjust the radar vertically until they match. if**d Y**is not zero, adjust the radar position Left or Right until**d Y**is 0.0 once**d Y**is 0.0 move the pole along the line connecting A and B repeating the above process you are done when no matter where you place the pole between A and B,**d Y**is always 0.0","title":"Calibrating your radar"},{"location":"Tesla_Bosch_Radar_EON/#troubleshooting-the-tesla-bosch-radar","text":"The radar send data for the first 5 seconds no matter what we send to it. But if we are sending the wrong info (VIN, position or epas) it will stop sending changes to the data after 5 seconds. At this point we have to see what exactly is happening with the radar by looking at the allerts it generates. You can use cabana and paste the following code in the DBC in order to understand what errors the radar is sending and what you need to change. Once you opened your cabana drive, click Load DBC, then Upload, and copy and paste the content from below to the DBC area. Then just look at the message called Tesla Radar Alert Matrix and see if you have any errors. Calibration warnings will not stop radar from operating. (Make sure you're looking at 1:501 for Tesla Radar Alert Matrix, not 0:501) VERSION \"\" NS_ : NS_DESC_ CM_ BA_DEF_ BA_ VAL_ CAT_DEF_ CAT_ FILTER BA_DEF_DEF_ EV_DATA_ ENVVAR_DATA_ SGTYPE_ SGTYPE_VAL_ BA_DEF_SGTYPE_ BA_SGTYPE_ SIG_TYPE_REF_ VAL_TABLE_ SIG_GROUP_ SIG_VALTYPE_ SIGTYPE_VALTYPE_ BO_TX_BU_ BA_DEF_REL_ BA_REL_ BA_DEF_DEF_REL_ BU_SG_REL_ BU_EV_REL_ BU_BO_REL_ SG_MUL_VAL_ BS_: BU_: Front Camera Radar BO_ 769 Tesla Radar Sgu Info: 8 Radar SG_ RADC_Vertical Misalignment : 0|8@1+ (1,0) [0|255] \"\" Front Camera SG_ RADC_SCUTemperature : 8|8@1+ (1,-128) [-128|127] \"\" Front Camera SG_ RADC_VMA_Plaus : 16|8@1+ (1,0) [0|255] \"\" Front Camera SG_ RADC_SGU_ITC : 24|8@1+ (1,0) [0|255] \"\" Front Camera SG_ RADC_Horizont Misalignment : 32|12@1+ (1,0) [0|4096] \"\" Front Camera SG_ RADC_Sensor Dirty : 44|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_HWFail : 45|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_SGUFail : 46|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_SGUInfo Consist Bit : 47|1@1+ (1,0) [0|1] \"\" Front Camera BO_ 770 Tesla Radar Tgu Info: 8 Radar SG_ RADC_ACCTarg Obj1_sgu Index : 0|6@1+ (1,0) [0|63] \"\" Front Camera SG_ RADC_ACCTarg Obj2_sgu Index : 6|6@1+ (1,0) [0|63] \"\" Front Camera SG_ RADC_ACCTarg Obj3_sgu Index : 12|6@1+ (1,0) [0|63] \"\" Front Camera SG_ RADC_ACCTarg Obj4_sgu Index : 18|6@1+ (1,0) [0|63] \"\" Front Camera SG_ RADC_ACCTarg Obj5_sgu Index : 24|6@1+ (1,0) [0|63] \"\" Front Camera SG_ unused30 : 30|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_TGUInfo Consist Bit : 31|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_ACCTarg Obj1_d BPower : 32|16@1+ (1,0) [0|65535] \"\" Front Camera SG_ RADC_ACCTarg Obj5_d BPower : 48|16@1+ (1,0) [0|65535] \"\" Front Camera BO_ 1281 Tesla Radar Alert Matrix: 8 Radar SG_ RADC_a001_ecu Internal Perf : 0|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a002_flash Performance : 1|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a003_v Bat High : 2|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a004_adjustment Not Done : 3|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a005_adjustment Req : 4|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a006_adjustment Not Ok : 5|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a007_sensor Blinded : 6|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a008_plant Mode Active : 7|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a009_config Mismatch : 8|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a010_can Bus Off : 9|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a011_bdy MIA : 10|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a012_esp MIA : 11|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a013_gtw MIA : 12|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a014_sccm MIA : 13|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a015_adas MIA : 14|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a016_bdy Invalid Count : 15|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a017_adas Invalid Count : 16|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a018_esp Invalid Count : 17|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a019_sccm Invalid Count : 18|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a020_bdy Invalid Chk Sm : 19|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a021_esp Invalid Chk Sm : 20|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a022_sccm Invalid Chk Sm : 21|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a023_sccm Invalid Chk Sm : 22|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a024_abs Validity : 23|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a025_amb TValidity : 24|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a026_brake Validity : 25|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a027_Cntry Cd Validity : 26|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a028_esp Validity : 27|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a029_long Acc Off Validity : 28|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a030_long Acc Validity : 29|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a031_odo Validity : 30|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a032_gear Validity : 31|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a033_steer Ang Validity : 32|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a034_steer Ang Spd Validity : 33|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a035_indctr Validity : 34|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a036_veh Stand Still Validity : 35|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a037_vin Validity : 36|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a038_whl Rot Validity : 37|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a039_whl Spd Validity : 38|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a040_whl Stand Still Validity : 39|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a041_wiper Validity : 40|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a042_xwd Validity : 41|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a043_yaw Off Validity : 42|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a044_yaw Validity : 43|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a045_bsd Sanity : 44|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a046_rcta Sanity : 45|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a047_lcw Sanity : 46|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a048_steer Ang Off Sanity : 47|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a049_tire Size Sanity : 48|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a050_velocity Sanity : 49|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a051_yaw Sanity : 50|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a052_radome Htr Inop : 51|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a053_espmod Validity : 52|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a054_gtwmod Validity : 53|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a055_stwmod Validity : 54|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a056_bcmod Validity : 55|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a057_dimod Validity : 56|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a058_opmod Validity : 57|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a059_drmi Invalid Chk Sm : 58|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a060_drmi Invalid Count : 59|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a061_rad Position Mismatch : 60|1@1+ (1,0) [0|1] \"\" Front Camera SG_ RADC_a062_str Rack Mismatch : 61|1@1+ (1,0) [0|1] \"\" Front Camera SG_ unused62 : 62|2@1+ (1,0) [0|3] \"\" Front Camera","title":"Troubleshooting the Tesla Bosch Radar"},{"location":"Tesla_CAN_Bus/","text":"Tesla CAN Connectors General Info The Tesla CAN Bus system comprises of 6 standard CAN busses + one Ether CAN bus. Most of the 6 regular busses can be access via either the OBD-II connector located in the driver side footwell (1 bus prior to 5/31/2013; 2 busses after 5/31/2013) or the CAN Bus diagnostic port (4 busses) which is located under the CID (one needs to remove the panel from underneath the CID to access it). The Ether CAN uses UDP encapsulation to broadcast the CAN messages (8 bytes long) on port 20101 on the network between the Gateway, the CID and the IC. The Gateway is the central hub for connecting all the 7 busses. It does all the translation and forwarding of CAN messages between the busses. Sometimes the messages are sent with the same ID between CAN busses, sometimes the ID changes. Security and Data Consistency Most messages have a counter. The counter is usually on 4 bytes, thus mod 16. Most messages have either a checksum byte or a CRC byte. The checksum is usually computer by just adding (mod 256) all the octets PLUS the high and low octets of the ID. The CRC (when required) is the SAE J1850 CRC algorithm. Body CAN The Body CAN bus on Tesla has about 10+ modules (depending on options), including: DDM/PDM - Door Controller EFUSE - E-fuse Controller GTW - Gateway LFT - Liftgate Controller SEC - Security SUN - Sunroof TUNER - Radio Body Fault Tolerant CAN The Body Fault Tolerant CAN on Tesla has 5+ modules (depending on options), including: BCS - Body Control for Seats GTW - Gateway MSM - Memory Seat Module PTC - Positive Temperature Coefficient - Air Heater RCCM - Remote Climate Control Module Chassis CAN The Chassis CAN bus on Tesla has about 10+ modules (depending on options), including: DAS - Auto Pilot 1 hardware (if equipped) EPAS - Electric Power Steering EPB - Electronic Parking Brake GTW - Gateway PARK - Parking Assist TAS - Air Susspension SCCM/STW - Steering Wheel Controls TPMS - Tire Pressure Monitoring System Powertrain CAN The Powertrain CAN bus on Tesla has about 9+ modules, including: BMS - Battery Management System CHG/FC - Charging System CP - Charging Port DCDC - DC-DC Charger DI - Drive/Inverter Module GTW - Gateway PM - Pedal Module PMS - Power Managment System THC - Thermal Control","title":"CAN Bus Details"},{"location":"Tesla_CAN_Bus/#general-info","text":"The Tesla CAN Bus system comprises of 6 standard CAN busses + one Ether CAN bus. Most of the 6 regular busses can be access via either the OBD-II connector located in the driver side footwell (1 bus prior to 5/31/2013; 2 busses after 5/31/2013) or the CAN Bus diagnostic port (4 busses) which is located under the CID (one needs to remove the panel from underneath the CID to access it). The Ether CAN uses UDP encapsulation to broadcast the CAN messages (8 bytes long) on port 20101 on the network between the Gateway, the CID and the IC. The Gateway is the central hub for connecting all the 7 busses. It does all the translation and forwarding of CAN messages between the busses. Sometimes the messages are sent with the same ID between CAN busses, sometimes the ID changes.","title":"General Info"},{"location":"Tesla_CAN_Bus/#security-and-data-consistency","text":"Most messages have a counter. The counter is usually on 4 bytes, thus mod 16. Most messages have either a checksum byte or a CRC byte. The checksum is usually computer by just adding (mod 256) all the octets PLUS the high and low octets of the ID. The CRC (when required) is the SAE J1850 CRC algorithm.","title":"Security and Data Consistency"},{"location":"Tesla_CAN_Bus/#body-can","text":"The Body CAN bus on Tesla has about 10+ modules (depending on options), including: DDM/PDM - Door Controller EFUSE - E-fuse Controller GTW - Gateway LFT - Liftgate Controller SEC - Security SUN - Sunroof TUNER - Radio","title":"Body CAN"},{"location":"Tesla_CAN_Bus/#body-fault-tolerant-can","text":"The Body Fault Tolerant CAN on Tesla has 5+ modules (depending on options), including: BCS - Body Control for Seats GTW - Gateway MSM - Memory Seat Module PTC - Positive Temperature Coefficient - Air Heater RCCM - Remote Climate Control Module","title":"Body Fault Tolerant CAN"},{"location":"Tesla_CAN_Bus/#chassis-can","text":"The Chassis CAN bus on Tesla has about 10+ modules (depending on options), including: DAS - Auto Pilot 1 hardware (if equipped) EPAS - Electric Power Steering EPB - Electronic Parking Brake GTW - Gateway PARK - Parking Assist TAS - Air Susspension SCCM/STW - Steering Wheel Controls TPMS - Tire Pressure Monitoring System","title":"Chassis CAN"},{"location":"Tesla_CAN_Bus/#powertrain-can","text":"The Powertrain CAN bus on Tesla has about 9+ modules, including: BMS - Battery Management System CHG/FC - Charging System CP - Charging Port DCDC - DC-DC Charger DI - Drive/Inverter Module GTW - Gateway PM - Pedal Module PMS - Power Managment System THC - Thermal Control","title":"Powertrain CAN"},{"location":"Tesla_Giraffe/","text":"Tesla Giraffe is not needed with the latest versions of Tesla Unity Open Pilot. This equipment was used in the past to connect the EPAS Harness to the OBD2 port and the Panda. With the release of v0.8.13 this device was replaced by the Tinkla OBD-C Adapter Installing the Giraffe Has 1&9Missing 1&9There are currently three options concerning Giraffes for your Model S. You can even make your own Tesla Giraffe. An EPAS harness from Flyboy222pa on e Bay or evcablescom.tech - The harness installs below the MCU. This path doesn't require a Giraffe and has our EPAS Harness already built-in, so you don't need to make it yourself. But this will require a 120 Ohm resistor if you want to install a Radar retrofit. Giraffe rev B from @E=mc2#7596 on the Comma.ai Discord - This Giraffe installs into the OBD port under the dash in the driver's footwell. This will work as long as your OBD port pins 1 and 9 look like the first picture on the right. Giraffe for cars built before May 31, 2013, will need a \"TDC Connector\".- This Giraffe installs into the OBD port under the dash in the driver's footwell but needs an additional connection to the port under the MCU. You'll want this variant if your OBD port is missing pins 1 and 9 like the second picture to the right. Your Comma.ai Panda plugs right into your Giraffe or Flyboy's EPAS harness. In case of the Giraffe, your need to make the EPAS Harness yourself. Giraffe rev B The Tesla Giraffe rev. B was created and sold by**@appleguru**. On top of creating the right pin connections between Panda and the appropriate Tesla CAN Bus , it has a number of other nice features: automatically connects EPAS connector back to Chassis CAN bus when no Panda is present offers connector for CAN2 on Panda which is used for Tesla Bosch Radar has 12V power out which can be used to power the Tesla Bosch Radar via relay has the Comma RJ45 Fake Ethernet CAN connector to connect the Comma Pedal has 8 GPIO outputs that can be used to drive certain other accessories; the 8 th GPIO is used in our Panda firmware for \"ignition power\" which can be used to drive the relay needed for Tesla Bosch Radar power Default Output Mapping with Tesla Giraffe rev. B firmware from my branch The general purpose outputs on the GPIO RJ45 and optional 10 position terminal block are driven from the panda via one of the otherwise unused LIN bus outputs. This output, through the circuitry on the rev. B giraffe, drives an automotive grade 8 ch smart FET (Infineon BTS4880R) that can handle loads up to 500m A per channel (2A max across all outputs). The initial application for the GPIO is to support the \"Tesla Camera switcher\" project, which allows intelligent switching between the car's backup camera and a new camera added to the front bumper to help with forward parking on a Model S or Model X. The current firmware automatically switches to the backup camera feed when in reverse, and the front camera feed otherwise, allowing for the use of pressing and holding on the menu button on the steering wheel to manually select. Other projects that will potentially use this GPIO are the \"Tesla 360 camera install\", the \"Tesla lighted appliqu\u00e9\", and a few owners that have installed light bars/want to drive relays from CAN so they come on with their high beams. The firmware is open-source, so you can configure this interface to suit your project\u2019s needs and get a very capable GPIO from CAN ! Please see the table below for the current CAN signals mapped: Output PIN Number Function OUT1 Front Camera Switch (High when car is in Reverse or menu button override is active) OUT2 Drive OUT3 Brake Lights OUT4 Left Turn Signal OUT5 Right Turn Signal OUT6 Reverse OUT7 High Beams On OUT8 \"Ignition\" Power J8 RJ45 GPIO Pinout RJ45 Pin Number / 568B Color Function 1 / Orange/White OUT3 2 / Orange OUT1 3 / Green / White OUT4 4 / Blue OUT2 5 / Blue/White OUT5 6 / Green OUT6 7 / Brown/White Fused +12V 8 / Brown (and Shield) GND J7 RJ45 Comma Pinout RJ45 Pin Number / 568B Color Function 1 / Orange/White (and Shield) GND 2 / Orange Fused +12V 3 / Green / White EPAS CAN - 4 / Blue No Connection 5 / Blue/White GND 6 / Green EPAS CAN+ 7 / Brown/White CAN2+ (Radar) 8 / Brown CAN2- (Radar) Giraffe CAN Bus Inputs/Outputs Panda CAN2 is used in my branch to connect the Tesla Bosch Radar . R11 on the bottom of the board is unpopulated and available for an optional 120 Ohm 1206 termination resistor to be installed if needed. CAN2 is broken out on both the Comma RJ45 output and the J3 2pin output (see pinout). If you're not planning to install the R11, please make sure you add an 120 Ohm resistor before the JST connector per the Tesla Bosch Radar instructions. Panda CAN1 is connected to the Model S and Model X\u2019s Chassis CAN via the giraffe\u2019s male OBD\u2019s Pins 1 (CH+) and 9 (CH-). The J6 EPAS output switches between CH CAN from the Car and CAN3 from the Panda, depending on the state of CAN Select (Which is driven by the panda\u2019s GMLAN output). When it is high (D1 Yellow), J6 is sending Panda CAN3 out. When it is low (D1 Green), the Car\u2019s Chassis CAN (CAN1) is going out J6. Tesla Giraffe rev B Useful Part Numbers 2pin connectors for J2 / J3 / J6 are JST 2pos 2mm PH headers, PN B2B-PH-K-S(LF)(SN) Fuse F1 is a standard 3A blade type automotive fuse. OE fuse is a Littlefuse 0287003.PXCN J1 (Optional) is Phoenix contact Part number 1827787 (plug) and 1827949 (soldered header) in case you misplace your plug or would like to add your own header. J9 is Phoenix Contact plug 1827703 in case you misplace yours.","title":"Tesla Giraffe"},{"location":"Tesla_Giraffe/#installing-the-giraffe","text":"Has 1&9Missing 1&9There are currently three options concerning Giraffes for your Model S. You can even make your own Tesla Giraffe. An EPAS harness from Flyboy222pa on e Bay or evcablescom.tech - The harness installs below the MCU. This path doesn't require a Giraffe and has our EPAS Harness already built-in, so you don't need to make it yourself. But this will require a 120 Ohm resistor if you want to install a Radar retrofit. Giraffe rev B from @E=mc2#7596 on the Comma.ai Discord - This Giraffe installs into the OBD port under the dash in the driver's footwell. This will work as long as your OBD port pins 1 and 9 look like the first picture on the right. Giraffe for cars built before May 31, 2013, will need a \"TDC Connector\".- This Giraffe installs into the OBD port under the dash in the driver's footwell but needs an additional connection to the port under the MCU. You'll want this variant if your OBD port is missing pins 1 and 9 like the second picture to the right. Your Comma.ai Panda plugs right into your Giraffe or Flyboy's EPAS harness. In case of the Giraffe, your need to make the EPAS Harness yourself.","title":"Installing the Giraffe"},{"location":"Tesla_Giraffe/#giraffe-rev-b","text":"The Tesla Giraffe rev. B was created and sold by**@appleguru**. On top of creating the right pin connections between Panda and the appropriate Tesla CAN Bus , it has a number of other nice features: automatically connects EPAS connector back to Chassis CAN bus when no Panda is present offers connector for CAN2 on Panda which is used for Tesla Bosch Radar has 12V power out which can be used to power the Tesla Bosch Radar via relay has the Comma RJ45 Fake Ethernet CAN connector to connect the Comma Pedal has 8 GPIO outputs that can be used to drive certain other accessories; the 8 th GPIO is used in our Panda firmware for \"ignition power\" which can be used to drive the relay needed for Tesla Bosch Radar power","title":"Giraffe rev B"},{"location":"Tesla_Giraffe/#default-output-mapping-with-tesla-giraffe-rev-b-firmware-from-my-branch","text":"The general purpose outputs on the GPIO RJ45 and optional 10 position terminal block are driven from the panda via one of the otherwise unused LIN bus outputs. This output, through the circuitry on the rev. B giraffe, drives an automotive grade 8 ch smart FET (Infineon BTS4880R) that can handle loads up to 500m A per channel (2A max across all outputs). The initial application for the GPIO is to support the \"Tesla Camera switcher\" project, which allows intelligent switching between the car's backup camera and a new camera added to the front bumper to help with forward parking on a Model S or Model X. The current firmware automatically switches to the backup camera feed when in reverse, and the front camera feed otherwise, allowing for the use of pressing and holding on the menu button on the steering wheel to manually select. Other projects that will potentially use this GPIO are the \"Tesla 360 camera install\", the \"Tesla lighted appliqu\u00e9\", and a few owners that have installed light bars/want to drive relays from CAN so they come on with their high beams. The firmware is open-source, so you can configure this interface to suit your project\u2019s needs and get a very capable GPIO from CAN ! Please see the table below for the current CAN signals mapped: Output PIN Number Function OUT1 Front Camera Switch (High when car is in Reverse or menu button override is active) OUT2 Drive OUT3 Brake Lights OUT4 Left Turn Signal OUT5 Right Turn Signal OUT6 Reverse OUT7 High Beams On OUT8 \"Ignition\" Power","title":"Default Output Mapping with Tesla Giraffe rev. B firmware from my branch"},{"location":"Tesla_Giraffe/#j8-rj45-gpio-pinout","text":"RJ45 Pin Number / 568B Color Function 1 / Orange/White OUT3 2 / Orange OUT1 3 / Green / White OUT4 4 / Blue OUT2 5 / Blue/White OUT5 6 / Green OUT6 7 / Brown/White Fused +12V 8 / Brown (and Shield) GND","title":"J8 RJ45 GPIO Pinout"},{"location":"Tesla_Giraffe/#j7-rj45-comma-pinout","text":"RJ45 Pin Number / 568B Color Function 1 / Orange/White (and Shield) GND 2 / Orange Fused +12V 3 / Green / White EPAS CAN - 4 / Blue No Connection 5 / Blue/White GND 6 / Green EPAS CAN+ 7 / Brown/White CAN2+ (Radar) 8 / Brown CAN2- (Radar)","title":"J7 RJ45 Comma Pinout"},{"location":"Tesla_Giraffe/#giraffe-can-bus-inputsoutputs","text":"Panda CAN2 is used in my branch to connect the Tesla Bosch Radar . R11 on the bottom of the board is unpopulated and available for an optional 120 Ohm 1206 termination resistor to be installed if needed. CAN2 is broken out on both the Comma RJ45 output and the J3 2pin output (see pinout). If you're not planning to install the R11, please make sure you add an 120 Ohm resistor before the JST connector per the Tesla Bosch Radar instructions. Panda CAN1 is connected to the Model S and Model X\u2019s Chassis CAN via the giraffe\u2019s male OBD\u2019s Pins 1 (CH+) and 9 (CH-). The J6 EPAS output switches between CH CAN from the Car and CAN3 from the Panda, depending on the state of CAN Select (Which is driven by the panda\u2019s GMLAN output). When it is high (D1 Yellow), J6 is sending Panda CAN3 out. When it is low (D1 Green), the Car\u2019s Chassis CAN (CAN1) is going out J6.","title":"Giraffe CAN Bus Inputs/Outputs"},{"location":"Tesla_Giraffe/#tesla-giraffe-rev-b-useful-part-numbers","text":"2pin connectors for J2 / J3 / J6 are JST 2pos 2mm PH headers, PN B2B-PH-K-S(LF)(SN) Fuse F1 is a standard 3A blade type automotive fuse. OE fuse is a Littlefuse 0287003.PXCN J1 (Optional) is Phoenix contact Part number 1827787 (plug) and 1827949 (soldered header) in case you misplace your plug or would like to add your own header. J9 is Phoenix Contact plug 1827703 in case you misplace yours.","title":"Tesla Giraffe rev B Useful Part Numbers"},{"location":"Tesla_Model_S_preAP_OBD2_port/","text":"pre AP Tesla Model S OBD2 port with pins 1 and 9 populatedpre AP Tesla Model S OBD2 port without pins 1 and 9 populated Tinkla OBD-C Adapter and your car's OBD2 port Tinkla OBD-C Adapter connects to your pre AP Tesla Model S' OBD2 port in order to power the Comma devkit and also talk to your car's Chassis CAN bus. Depending on the year/month when your car was manufactured, your OBD2 port might or might not have the pins 1 and 9 (which have the Chassis CAN bus) populated. Do not despair, we have a solution for that. In case you need to connect more than one device to the OBD2 port, a splitter like this one could make your life easier. Checking your car's OBD2 port Locate your pre AP Tesla Model S OBD2 port in the driver footwell. It is under the ceiling of the footwell, towards the outside of the car, close to the door. Will look like one of the two pictures above. One of those pictures show the pins 1 and 9 populated, one shows them not populated. Take a picture of the OBD2 connector and compare to the images. Which one do you have? I have pins 1 and 9 populated OK, then you are ready to just plug the Tinkla OBD-C adapter straight into the OBD2 port and install your Comma devkit and Tesla Unity software. I do not have pins 1 and 9 populated You're still OK. You can purchase the Tinkla Chassis CAN Retrofit Harness from our store. This easy to install harness will populate pins 1 and 9 on your vehicle with Chassis CAN signal taken from the Tesla Diagnostic Port from underneath your center console display. Takes very little time to install and is a permanent upgrade to your car. IF you are going to install a Tesla Pedal Interceptor too, you might want to do this at the same time, since you will have to remote the top of the footwell anyway. Installing the Tinkla Chassis CAN Retrofit Harness To install the Chassis CAN retrofit harness, there are two big steps: adding the pins 1 (red) and 9 (black) to the existing OBD2 connector connecting the other end of the harness to the diagnostic port This video for a different product shows you what you have to do in order to remove the driver side foot-well cover. Take your time and watch the video first. The process is not complicated if you just follow it step by step. Once you remove the foot-well cover, take your time and remove the two screws that hold the OBD2 connector in place. They are fairly painful to reach and takes time and a lot of weird yoga like positions to remove. Once the OBD2 connector is free, use a small flat screwdriver to take out the two blue tabs, insert the pins in the OBD2 connector then place the two blue tabs back. Now mount back the OBD2 connector in it's original location (few more yoga positions and you're done). Now connect the other end of the harness to the Tesla diagnostic port. The port is located under the center console behind the little shelf. You can either pull down on the shelf or even access it sometimes the side (if you followed the steps in the video above). Once both ends are connected try the whole system first before following the steps in reverse order to put the driver foot-well back together.","title":"OBD2 Port Info"},{"location":"Tesla_Model_S_preAP_OBD2_port/#tinkla-obd-c-adapter-and-your-cars-obd2-port","text":"Tinkla OBD-C Adapter connects to your pre AP Tesla Model S' OBD2 port in order to power the Comma devkit and also talk to your car's Chassis CAN bus. Depending on the year/month when your car was manufactured, your OBD2 port might or might not have the pins 1 and 9 (which have the Chassis CAN bus) populated. Do not despair, we have a solution for that. In case you need to connect more than one device to the OBD2 port, a splitter like this one could make your life easier.","title":"Tinkla OBD-C Adapter and your car's OBD2 port"},{"location":"Tesla_Model_S_preAP_OBD2_port/#checking-your-cars-obd2-port","text":"Locate your pre AP Tesla Model S OBD2 port in the driver footwell. It is under the ceiling of the footwell, towards the outside of the car, close to the door. Will look like one of the two pictures above. One of those pictures show the pins 1 and 9 populated, one shows them not populated. Take a picture of the OBD2 connector and compare to the images. Which one do you have?","title":"Checking your car's OBD2 port"},{"location":"Tesla_Model_S_preAP_OBD2_port/#i-have-pins-1-and-9-populated","text":"OK, then you are ready to just plug the Tinkla OBD-C adapter straight into the OBD2 port and install your Comma devkit and Tesla Unity software.","title":"I have pins 1 and 9 populated"},{"location":"Tesla_Model_S_preAP_OBD2_port/#i-do-not-have-pins-1-and-9-populated","text":"You're still OK. You can purchase the Tinkla Chassis CAN Retrofit Harness from our store. This easy to install harness will populate pins 1 and 9 on your vehicle with Chassis CAN signal taken from the Tesla Diagnostic Port from underneath your center console display. Takes very little time to install and is a permanent upgrade to your car. IF you are going to install a Tesla Pedal Interceptor too, you might want to do this at the same time, since you will have to remote the top of the footwell anyway.","title":"I do not have pins 1 and 9 populated"},{"location":"Tesla_Model_S_preAP_OBD2_port/#installing-the-tinkla-chassis-can-retrofit-harness","text":"To install the Chassis CAN retrofit harness, there are two big steps: adding the pins 1 (red) and 9 (black) to the existing OBD2 connector connecting the other end of the harness to the diagnostic port This video for a different product shows you what you have to do in order to remove the driver side foot-well cover. Take your time and watch the video first. The process is not complicated if you just follow it step by step. Once you remove the foot-well cover, take your time and remove the two screws that hold the OBD2 connector in place. They are fairly painful to reach and takes time and a lot of weird yoga like positions to remove. Once the OBD2 connector is free, use a small flat screwdriver to take out the two blue tabs, insert the pins in the OBD2 connector then place the two blue tabs back. Now mount back the OBD2 connector in it's original location (few more yoga positions and you're done). Now connect the other end of the harness to the Tesla diagnostic port. The port is located under the center console behind the little shelf. You can either pull down on the shelf or even access it sometimes the side (if you followed the steps in the video above). Once both ends are connected try the whole system first before following the steps in reverse order to put the driver foot-well back together.","title":"Installing the Tinkla Chassis CAN Retrofit Harness"},{"location":"Tesla_Service_Center_Frustration/","text":"Tesla Service Center Events August 2020 - 2 nd Issues with EMMC Long story.... 07/27/2020 - CID goes black On 07/27/2020, as I was returning home, my central display started to be very sluggish in reacting to my commands... It happens sometimes as it is just a big computer run by a NVIDIA processor. So when I get home, I use the steering wheel buttons to do a normal reboot (done many times, maybe one a week recently). Usually within a minute it comes back up and all is fine... well... not this time... after about 5 minutes of nothing happening I decide to go in the house and have dinner. I come back hours later and the screen is still black. I reboot it again... Now it's like 9pm and getting dark, and you can see that the computer is stuck in a cyclic boot: the screen backlight goes on and off. Oh well, this is a two years old computer and I had to go through the same exercise in April 2018. Back then Tesla had the car in service for 40 (forty) days. And in the end they told me they put a new CID. Well, I've learned later (once I got my way inside the car's computers) that it was NOT a new one how they claimed, it was actually manufactured some time in 2016 and most likely was in another car before (back then there was a shortage of this part at Tesla). So, not my first battle and nothing to panic about. I go on the Tesla App (it's so nice to be able to schedule stuff without having to call) and pick August 11 th as the first available date for the Tesla Ranger to come to my house and fix it (I do love this feature also, when they come and fix it at your place). Anyway, I set it and start wondering what I'm going to do all this time without the car. Well, one can drive it, but the central display also control the AC, and driving in a hot and humid Philly day without AC in July is not fun. So I put my Security Researcher (aka white hacker) hat on, get access to the central computer and find the issue... the file system is corrupted. Good, cause Tesla has two.... and the only way I know how to switch them is to do a software redeploy... so I do that and 3 hours later the car is back online! But... when I start going through the logs I see even this partition has signs of data corruption. So will keep the appointment. 08/07/2020 - Remote troubleshooting It is standard operating procedure for Tesla to have their tech remote into a car to gather more information before an appointment. This helps to get all the data needed so they have all the parts and items needed to fix your car very fast... or at least that's the plan. 08/07/2020So I start getting texts from a technician... he is trying to get inside my car but he does not have much success... I tell him that some of the errors are clean because I switched the EMMC banks. That's when I lost him.**What do you mean?**he asks.**Your vehicle is not showing faulty EMMC errors at this time.**I explained that I am a registered Security Researcher and that I happen to have access to my car's computers and that I do have screenshots of the logs full of errors. I also explained to him how I switched banks by redeployment. He tells me this is nothing that a Tesla Ranger can fix and I have to get my car in for service. He offered 8/10/2020 (a day earlier than the Ranger visit) and a Uber ride home. I explain to him I can not be without the car and that the car is \"kind of\" fixed and would rather bring it in when they have a loaner. He tells me that 8/25 is the first day they will have a loaner for me. I say OK. And tell him that if it gets worse, I will try to change the appointment. 08/08/2020 - The logs Today I get a text from the technician that he was able to pull the logs and he indeed sees memory corruption messages (on the \"good\" memory bank). He also sees that my storage is low (an issue I've been having, and other owners too, since the upgrade to version 2020.24.6.11). I tell him yes, the**syslog**gets full because it is not rotated and fills up the whole**/var**partition. I also tell him I cleared it 4 days ago and it's almost full. So we leave it that this has to be done on 8/25/2020. OK. At least they know all the parts they need and from previous personal experience the whole process is way less than 2 hrs... 08/08/2020**Service Day 1** 8:30 AM - Drop my car to the Tesla Service Center in Devon PA per my appointment. I try to park up front but I'm asked to double park it in any open spot. Knowing this will go fast (oh, how wrong is to assume) I left it close by, blocking 3 other cars that were there for service. Few other people were dropping cars the same way, so I said they will move it if they need to... 8:32 AM - Technician goes inside the vehicle and performs an MCU reboot. 40 seconds. This timestamp will be on the IC for quite some time. Then he goes with me over what I had in my file. I mention that I have two other items: with the rain the previous night, I get water in the liftgate and the left tail light shows condensation. Also I show him that I have bubbles on the IC screen, so most likely that will have to be replaced. I have extended warranty until 10.2022 so not a big deal, correct? I was wrong again. 8:35 AM - Technician starts to be fairly mean. Like I'm bothering him. Man, it's just early in the morning what is he going to do the whole day? He explains to me how these items are not on the ticket he has. Like it was my fault it rained the night before. And he truly believed it. 8:40 AM - Technician finally goes inside to get the paperwork I need to sign... On the way towards inside he tells me that he doesn't know when I'm getting a loaner, because they are out... You can feel in his voice that it gave him pleasure telling me that. Like he still had the upper hand. He is the king of that service center. I can't just throw items his way any time I feel like... 8:50 AM - It's getting south FAST... He comes up with the paperwork, showing the original two items I had on the ticket and the total deductible per my warranty, which is $200. Then he shows me the other two items I brought up today and he perceives to tell me (again, with great internal pleasure, cause he's making more money for Tesla) that EACH of the items is going to cost me 87.50. (wonder where they came up with these numbers...). I am whatever, I'll not gonna fight him now or maybe he's gonna reschedule me in December... He knows he has the power to and he even has a smirk on his face. 9:15 AM - I finally get my loaner.... I am late for a meeting and tired of dealing with people... It's a Chevy Malibu.... a CHEVY ... MALIBU... at a Tesla dealership... what, are they trying to get me to switch back to gas? They even want for me to pay for extra insurance... I'm like ... it's not my car... they pay for it.. it's their problem... I get inside and leave... 9:18 AM - Is it the perfume from the enterprise lady that dropped the car or what... at my meeting I leave the windows cracked... can't wait for the end of the day to get my car back (yeah right). 11:00 AM - Nope... car smells the same way... cheap perfume somebody used a lot to cover some worse smell and by the time I get home I already have a migraine... 11:15 AM - I take it to twitter as the frustration with the customer support person, the extra charges and the loaner are getting to me. 12:55 PM - After I checked my notes and the discussions I had with the Tesla online technician at the beginning of August I get even more frustrated. The date was switched from 8/10 to 8/25 so that I can be guaranteed a loaner. On 8/10 they offered to Uber me home... So back to twitter I go 2:00 PM - I look on the Tesla App on my phone and guess what: the car did not move... So I log in remotely and take snapshots of the instrument cluster (IC) and the central display (CID)... nothing has changed since I dropped my car in the AM... there is still time to finish it... 4:25 PM - Another check on car location and status shows that it is still there, not changed, not touched... so it take it to twitter again in frustration 9:15 PM - After dinner, I check again on the car. Nope, nobody, not even remotely, came to look at the car to start fixing it... Lost day... Let's try to make the technician smile, I am sure many people like me get frustrated with them and that can't be easy on them. So I remote into the car and display a funny letter on the central display. Then I post it on twitter Service Day 2 8:00 AM - Let's look, maybe something did happen overnight from the Tesla HQ team... nope... my love note is still there on the CID and car did not move... still shows the 8:32 AM time when it was last turned on on 08/25... I am sure they will get to it today. 12:00 PM - No changes in location... what is going on? So these 4 cars (mine and the 3 I'm blocking) have not been accessed in 30 hrs (at least) 3:00 PM - 2 hrs to go until they close... Maybe I should open a betting line on Fan Duel... Odds are nobody will bet on the car being finished today... Even though last time I took the MCU out from a Model S to replace it on an out-of-warranty car it only took 30 minutes... 5:00 PM - It's official, day 2 passed and nothing happened... 5:12 PM - Too frustrated I take to it twitter ... I know it's not Elon's fault but this customer support sucks! I have stocks, I am a Tesla Fan, I have my tri-motor Cyber Truck on order... I just need to feel that I will be taken care off... 6:30 PM - Take my son to soccer... Oh, the SMELL!!! Open the windows to get some fresh air but it's humid outside. Can't win today! Service Day 3 8:00 AM - Maybe today is the day. Maybe today they will look at my car and I can take it back. 9:00 AM - I had to drive to a client and 3 minutes in the drive the headache came back from the weird smell in this rental car... 11:00 AM - Car is in the same spot... nobody touched it... nobody even opened a door... my monitors did not detect any remote access from a Tesla HQ employee either... 2:30 PM - This is getting frustrating again... I feel I should press the horn button on the remote to get somebody to pay attention to my baby. It's been there for 54 hrs without even being moved to better parking spot. 4:30 PM - Was it really moved??? Is it that or just a glitch in the GPS showing me the car now 5 ft to the left... I need to grab some screenshots quickly from IC and CID... Exciting times... YES IT DID... for 1 minute.... I bet that they just needed one of the 3 cars i was blocking... It moved from blocking 3 on the left to blocking 3 on the right... Service Day 4 3:07 PM - NOTHING changed... same position ... untouched... still there... 5:00 PM - Another 10 ft move... at least now it's parked in a parking spot, not just blocking other cars... yet 4 days I could have drove my car because definitely Tesla tech don't have time for my car even though it was scheduled 3 week prior to the appointment... 6:00 PM - Just got home after driving the Malibu for an hour... Unfortunately it was raining so i could not keep the windows open. Got the headache about 30 min into my 1 hour drive... I'm really starting to think if it's from whatever they use to disinfect for COVID. Whatever that chemical is, it stinks and gives me headaches....","title":"Service Centers"},{"location":"Tesla_Service_Center_Frustration/#tesla-service-center-events","text":"","title":"Tesla Service Center Events"},{"location":"Tesla_Service_Center_Frustration/#august-2020-2nd-issues-with-emmc","text":"Long story.... 07/27/2020 - CID goes black On 07/27/2020, as I was returning home, my central display started to be very sluggish in reacting to my commands... It happens sometimes as it is just a big computer run by a NVIDIA processor. So when I get home, I use the steering wheel buttons to do a normal reboot (done many times, maybe one a week recently). Usually within a minute it comes back up and all is fine... well... not this time... after about 5 minutes of nothing happening I decide to go in the house and have dinner. I come back hours later and the screen is still black. I reboot it again... Now it's like 9pm and getting dark, and you can see that the computer is stuck in a cyclic boot: the screen backlight goes on and off. Oh well, this is a two years old computer and I had to go through the same exercise in April 2018. Back then Tesla had the car in service for 40 (forty) days. And in the end they told me they put a new CID. Well, I've learned later (once I got my way inside the car's computers) that it was NOT a new one how they claimed, it was actually manufactured some time in 2016 and most likely was in another car before (back then there was a shortage of this part at Tesla). So, not my first battle and nothing to panic about. I go on the Tesla App (it's so nice to be able to schedule stuff without having to call) and pick August 11 th as the first available date for the Tesla Ranger to come to my house and fix it (I do love this feature also, when they come and fix it at your place). Anyway, I set it and start wondering what I'm going to do all this time without the car. Well, one can drive it, but the central display also control the AC, and driving in a hot and humid Philly day without AC in July is not fun. So I put my Security Researcher (aka white hacker) hat on, get access to the central computer and find the issue... the file system is corrupted. Good, cause Tesla has two.... and the only way I know how to switch them is to do a software redeploy... so I do that and 3 hours later the car is back online! But... when I start going through the logs I see even this partition has signs of data corruption. So will keep the appointment. 08/07/2020 - Remote troubleshooting It is standard operating procedure for Tesla to have their tech remote into a car to gather more information before an appointment. This helps to get all the data needed so they have all the parts and items needed to fix your car very fast... or at least that's the plan. 08/07/2020So I start getting texts from a technician... he is trying to get inside my car but he does not have much success... I tell him that some of the errors are clean because I switched the EMMC banks. That's when I lost him.**What do you mean?**he asks.**Your vehicle is not showing faulty EMMC errors at this time.**I explained that I am a registered Security Researcher and that I happen to have access to my car's computers and that I do have screenshots of the logs full of errors. I also explained to him how I switched banks by redeployment. He tells me this is nothing that a Tesla Ranger can fix and I have to get my car in for service. He offered 8/10/2020 (a day earlier than the Ranger visit) and a Uber ride home. I explain to him I can not be without the car and that the car is \"kind of\" fixed and would rather bring it in when they have a loaner. He tells me that 8/25 is the first day they will have a loaner for me. I say OK. And tell him that if it gets worse, I will try to change the appointment. 08/08/2020 - The logs Today I get a text from the technician that he was able to pull the logs and he indeed sees memory corruption messages (on the \"good\" memory bank). He also sees that my storage is low (an issue I've been having, and other owners too, since the upgrade to version 2020.24.6.11). I tell him yes, the**syslog**gets full because it is not rotated and fills up the whole**/var**partition. I also tell him I cleared it 4 days ago and it's almost full. So we leave it that this has to be done on 8/25/2020. OK. At least they know all the parts they need and from previous personal experience the whole process is way less than 2 hrs... 08/08/2020**Service Day 1** 8:30 AM - Drop my car to the Tesla Service Center in Devon PA per my appointment. I try to park up front but I'm asked to double park it in any open spot. Knowing this will go fast (oh, how wrong is to assume) I left it close by, blocking 3 other cars that were there for service. Few other people were dropping cars the same way, so I said they will move it if they need to... 8:32 AM - Technician goes inside the vehicle and performs an MCU reboot. 40 seconds. This timestamp will be on the IC for quite some time. Then he goes with me over what I had in my file. I mention that I have two other items: with the rain the previous night, I get water in the liftgate and the left tail light shows condensation. Also I show him that I have bubbles on the IC screen, so most likely that will have to be replaced. I have extended warranty until 10.2022 so not a big deal, correct? I was wrong again. 8:35 AM - Technician starts to be fairly mean. Like I'm bothering him. Man, it's just early in the morning what is he going to do the whole day? He explains to me how these items are not on the ticket he has. Like it was my fault it rained the night before. And he truly believed it. 8:40 AM - Technician finally goes inside to get the paperwork I need to sign... On the way towards inside he tells me that he doesn't know when I'm getting a loaner, because they are out... You can feel in his voice that it gave him pleasure telling me that. Like he still had the upper hand. He is the king of that service center. I can't just throw items his way any time I feel like... 8:50 AM - It's getting south FAST... He comes up with the paperwork, showing the original two items I had on the ticket and the total deductible per my warranty, which is $200. Then he shows me the other two items I brought up today and he perceives to tell me (again, with great internal pleasure, cause he's making more money for Tesla) that EACH of the items is going to cost me 87.50. (wonder where they came up with these numbers...). I am whatever, I'll not gonna fight him now or maybe he's gonna reschedule me in December... He knows he has the power to and he even has a smirk on his face. 9:15 AM - I finally get my loaner.... I am late for a meeting and tired of dealing with people... It's a Chevy Malibu.... a CHEVY ... MALIBU... at a Tesla dealership... what, are they trying to get me to switch back to gas? They even want for me to pay for extra insurance... I'm like ... it's not my car... they pay for it.. it's their problem... I get inside and leave... 9:18 AM - Is it the perfume from the enterprise lady that dropped the car or what... at my meeting I leave the windows cracked... can't wait for the end of the day to get my car back (yeah right). 11:00 AM - Nope... car smells the same way... cheap perfume somebody used a lot to cover some worse smell and by the time I get home I already have a migraine... 11:15 AM - I take it to twitter as the frustration with the customer support person, the extra charges and the loaner are getting to me. 12:55 PM - After I checked my notes and the discussions I had with the Tesla online technician at the beginning of August I get even more frustrated. The date was switched from 8/10 to 8/25 so that I can be guaranteed a loaner. On 8/10 they offered to Uber me home... So back to twitter I go 2:00 PM - I look on the Tesla App on my phone and guess what: the car did not move... So I log in remotely and take snapshots of the instrument cluster (IC) and the central display (CID)... nothing has changed since I dropped my car in the AM... there is still time to finish it... 4:25 PM - Another check on car location and status shows that it is still there, not changed, not touched... so it take it to twitter again in frustration 9:15 PM - After dinner, I check again on the car. Nope, nobody, not even remotely, came to look at the car to start fixing it... Lost day... Let's try to make the technician smile, I am sure many people like me get frustrated with them and that can't be easy on them. So I remote into the car and display a funny letter on the central display. Then I post it on twitter Service Day 2 8:00 AM - Let's look, maybe something did happen overnight from the Tesla HQ team... nope... my love note is still there on the CID and car did not move... still shows the 8:32 AM time when it was last turned on on 08/25... I am sure they will get to it today. 12:00 PM - No changes in location... what is going on? So these 4 cars (mine and the 3 I'm blocking) have not been accessed in 30 hrs (at least) 3:00 PM - 2 hrs to go until they close... Maybe I should open a betting line on Fan Duel... Odds are nobody will bet on the car being finished today... Even though last time I took the MCU out from a Model S to replace it on an out-of-warranty car it only took 30 minutes... 5:00 PM - It's official, day 2 passed and nothing happened... 5:12 PM - Too frustrated I take to it twitter ... I know it's not Elon's fault but this customer support sucks! I have stocks, I am a Tesla Fan, I have my tri-motor Cyber Truck on order... I just need to feel that I will be taken care off... 6:30 PM - Take my son to soccer... Oh, the SMELL!!! Open the windows to get some fresh air but it's humid outside. Can't win today! Service Day 3 8:00 AM - Maybe today is the day. Maybe today they will look at my car and I can take it back. 9:00 AM - I had to drive to a client and 3 minutes in the drive the headache came back from the weird smell in this rental car... 11:00 AM - Car is in the same spot... nobody touched it... nobody even opened a door... my monitors did not detect any remote access from a Tesla HQ employee either... 2:30 PM - This is getting frustrating again... I feel I should press the horn button on the remote to get somebody to pay attention to my baby. It's been there for 54 hrs without even being moved to better parking spot. 4:30 PM - Was it really moved??? Is it that or just a glitch in the GPS showing me the car now 5 ft to the left... I need to grab some screenshots quickly from IC and CID... Exciting times... YES IT DID... for 1 minute.... I bet that they just needed one of the 3 cars i was blocking... It moved from blocking 3 on the left to blocking 3 on the right... Service Day 4 3:07 PM - NOTHING changed... same position ... untouched... still there... 5:00 PM - Another 10 ft move... at least now it's parked in a parking spot, not just blocking other cars... yet 4 days I could have drove my car because definitely Tesla tech don't have time for my car even though it was scheduled 3 week prior to the appointment... 6:00 PM - Just got home after driving the Malibu for an hour... Unfortunately it was raining so i could not keep the windows open. Got the headache about 30 min into my 1 hour drive... I'm really starting to think if it's from whatever they use to disinfect for COVID. Whatever that chemical is, it stinks and gives me headaches....","title":"August 2020 - 2nd Issues with EMMC"},{"location":"Tesla_Unity_Configuration/","text":"Intro On top of the standard settings offered by Open Pilot, Tinkla Unity has three separate sections which configure how the software behaves in your car. Understanding these settings and what they do is a crucial component on having the best experience with Tinkla Unity in your vehicle. Because our cars are so similar yet so different (just between 2012 and 2014 the number of available factory configurations for Model S is ridiculously high), combined with changes made by Tesla between software updates, it is hard to automate the configuration. So please take your time to read through these settings and understand them. If you have questions, please join us on Discord where people will be happy to answer your questions. Do not turn on settings for features you do not have installed at the moment (like using the Tesla Radar or using the Pedal Interceptor) as they will prevent the software from running (they expect to receive data from those devices once enabled). For theeditable settings, do not change them from the default values to one of the extremes (max or min) without understanding how they work. Editing numerical values Some of our settings are just toggles (ON green, OFF grey), but some are editable as numbers. It is important to understand how these numerical settings work. Look at the screen shots below. The screen shows the title of the setting, some tips/description for what you are doing and (if applicable) the unit of measure. Then the third row has the minimum value, maximum value and step. Values are always limited between min and max and based on the step. If you enter a value lower than the min, the min value will be used. If you enter a value larger than the max, the max value will be used. If you enter a value between min and max, it will be approximated to the closest step increment from the value you entered. It is very important to check the value once you save it. It will be displayed in the settings screen, next to the \"Change\" button. There is no need to enter the units of measure. Any text other than numbers is ignored and the units of measure are added automatically. There is one field ( Speed Limit Offset ) which can be either in your car's units of measure (km/h or MPH) OR can represent a percentage of the speed limit. The way this field is interpreted depends on the value of the**Use relative offset**toggle. Editing numerical values in Tesla Unity settings page (\u00bd) Editing numerical values in Tesla Unity settings page (2/2) Tinkla These settings apply to all models of Tesla. They control software that was created only for the Tesla branch. Enable HSO (toggle): Enables Human Steering Override (HSO) feature, which allows the driver to take over the steering wheel without disengaging the Open Pilot software. Once the hand is removed from the steering wheel, the software takes over again to keep the vehicle in the lane. HSO numb period (editable field): This is the interval, in seconds, at which Open Pilot checks if the driver is still overriding the steering. Default values is 1.5 seconds. A value to small and you might have to fight Open Pilot over control. A value too large will delay Open Pilot from taking control in time after you let go of the steering wheel. Enable HAO (toggle): Enables the Human Acceleration Override (HAO) feature, which allows the driver to accelerate the car while Open Pilot has longitudinal control of the vehicle without disengaging the software. Enable ALC (toggle): Enables Automatic Lane Change (ALC) feature, which automatically changes lanes x seconds (see ALC delay) after the turn signal stalk was tapped (not fully pressed). During the whole process of ALC, the turn signals will be kept on and the software will check if the line between lanes allows for a lane change and (on AP1/AP2 cars) if there is any vehicle in the blind spot. For pre AP cars, which do not have blind spot monitoring, please confirm there is no vehicle. If there is, fully press the turn signal to cancel the ALC process ALC delay (editable field): The dalay, in seconds, from the turn signal stalk press until the Open Pilot initiates the lane change. During this time the blinker will remain on, allowing the other drivers to see your intentions. You can reduce the wait time by slightly touching the steering wheel in the direction of lane change, which will initiate it at that moment. Enable OP Long Control (toggle): Allows Open Pilot to control the acceleration and braking of your vehicle. If this toggle is Off, you will have to accelerate/brake on your own for pre AP Tesla Model S (Open Pilot will just do lane keep assist) or it will use the built in adaptive cruise control (ACC) feature of your Tesla Model S/X with AP1 / AP2 . Turn screen off while engaged (toggle): Turns off the Comma devkit screen when there are no messages/warnings to be shown. It turns on automatically if there is something to be displayed. Show Debug View (toggle): For development purpose only. Please leave this toggle OFF. Hide GPS Warnings (toggle): Because of the window treatments on our Tesla vehicles, the GPS signal inside the vehicle is very low. This will create constant warning on the Comma devkit display about the quality of GPS signal. By turning this toggle on you will mute those messages. Maps on left side (toggle): hows the maps on the left side of the screen (Comma3 only). Flip screen (for RHD) (toggle): Flips the screen for people driving on the wrong side of the road. Changes to C2 hardware are needed (C2 only) (under development) . Shutdown after # of hours (editable field): Allows the Comma devkit to automatically shutdown (reducing the power consumption on your vehicle) after x hours of car being off. When returning to your vehicle, the Comma devkit will turn back on after detecting your car is on. Hands on level (editable field): Level at which to detect hands on wheel. Higher number means more force needed. Tinkla Development Unit (toggle): For development purpose only. Please leave this toggle OFF. Flash Panda (button): Panda is a separate internal component inside your Comma devkit. It has its own software and does a lot of the safety controls and checks between your car and the Comma devkit. You can think of it as the CAN Police. Every time you update your Comma devkit software you will also have to flash the new code on the Panda. This button starts the process to flash your Panda . Tinkla specific settings for the Tesla Unity branch of Open Pilot (\u00bd) Tinkla specific settings for the Tesla Unity branch of Open Pilot (2/2) Tesla pre AP These settings apply only to pre AP Tesla Model S. They control how OP software works on a Tesla that never had Auto Pilot hardware. Tesla software post 2019.16 (toggle): Most users should have this toggle ON. If by any chance (I do hope not) you're running Tesla software older than version 2019.16, do turn this OFF to see if it works on your car. There were CAN messages changed between pre and post version 2019.16. Use pedal (toggle): If you have a pedal interceptor installed in your car, please turn this toggle ON. Otherwise, leave it OFF. This can create issues if turned ON without a pedal interceptor installed. Use pedal over CC (toggle): If you have a pedal interceptor installed in your car AND want to have pedal based adaptive cruise control (PCC) enabled all the time no matter what the status of your car's cruise control is, turn this ON. It will completely disable your car's cruise control. If you have pedal interceptor and leave this OFF, then when the car's cruise control is ON you can not engage Open Pilot but it will allow you to use the factory Cruise Control. Pedal on CAN0 (toggle): If you have a pedal interceptor installed in your car and it is connected on CAN0, then turn this toggle ON. An example when you would need this on would be connecting the pedal to the Comma Relay RJ45. If your pedal is connected to the Tinkla OBD-C Adapter , then leave this toggle OFF as your pedal will be on CAN2. Pedal Profile (editable field): The profile to be used with the Tinkla Pedal Interceptor. 1-wider range to 4-narrower range, 5-no limits (default). If 5 seems to aggressive, try 2,3 or 4. Auto Resume ACC (toggle): Not used at the moment Follow Distance (editable field): This field adjusts the follow distance, in seconds, from the lead car. A smaller value will keep you closer to the lead car while a larger value will keep you farther out from the lead car. It is speed dependent. For example, at 60 MPH your vehicle travels at a speed of 27 m/s (meters per second). A value of 0.8s for the follow distance will keep your vehicle 27 * 0.8 = 21.6m (72ft) back, while a value of 1.2s will keep your vehicle 27 * 1.2 = 32.4m (108ft) back. At 30 MPH the distance will be 10.8m (36ft) for 0.8s and 16.2m (54ft) for 1.2s. Use Tinkla Buddy (toggle): Tells the Tesla Unity code to send the messages for IC integration if you have a Tinkla Buddyinstalled in your pre AP Tesla Model S with MCU1 car. (does not work for MCU2 cars). Use Tesla Radar (toggle): Tells the Tesla Unity code that you have installed a Tesla Bosch Radar in your car. Do not turn this ON unless you have properly installed and configured a radar in your car or the software will not work. Radar behind nosecone (toggle): If you installed the Tesla Bosch Radar behind the nosecone, turn this feature ON before doing the Radar VIN Learn process so that the radar learns about its position. Radar offset (editable field): If you installed a Tesla Bosch Radar in your car and have the radar off-center (like when it is behind the nose cone), adjust this value to show the**horizontal**distance, in meters, between the center of the nosecone (the middle of the Tesla logo) and the center of the radar. Positive numbers towards left of the car (as seen from the driver seat). Use Radar Upside Down (toggle): Allows one to install the Tesla Radar upside down. Car has i Booster (toggle): Turn this toggle on if you have retrofitted your car with the SGH Innovations' i Booster ECU to take advantage of full stop-and-go capabilities. Ignore wrong Date/Time (toggle): Allows a rebooted EON to run even if the date is incorrect. Prevents need to connect to network upon restarting. Force Pre AP Tesla Model S (toggle): This toggle has to be always ON if you have a pre AP Tesla Model S. It has to be OFF for any other Tesla vehicle. It forces the Tesla Unity code to think it is connected to a pre AP Tesla Model S and to adjust all the settings accordingly. Turing this feature ON on an AP1/AP2 Tesla will make the software stop working. Flash EPAS (button): This feature patches the code in the electronic power assisted steering (EPAS) ECU of your car, allowing us to control the steering. It is a necessary step when installing the software for the first time and might be needed again if the software stops steering your car after a Tesla software update. Flash Pedal (button): Use this feature if you just installed a pedal interceptor in your car to ensure the Tesla specific software is loaded on the pedal interceptor. Please make sure you set your toggles properly for the pedal interceptor (see above) BEFORE attempting to flash the code onto the device. Calibrate Pedal (button): Use this feature to calibrate your pedal interceptor device in order to enable the right experience when using PCC. Pedal will not work (will not allow you to enable PCC) until it is calibrated. Radar VIN Learn (button):Use this feature to configure your radar if you have installed a Tesla Bosch Radar in your car. It will program the VIN of your car as well as the location of the radar. Please make sure you configure all the toggles and settings for the radar (see radar options on this page) before attempting the Radar VIN Learn. Tesla pre AP specific settings for the Tesla Unity branch of Open Pilot (\u2153) Tesla pre AP specific settings for the Tesla Unity branch of Open Pilot (\u2154) Tesla pre AP specific settings for the Tesla Unity branch of Open Pilot (3/3) Tesla Generic These settings apply to all models of Tesla. They control how OP software works on a Tesla. Adjust ACC max with speed limit (toggle): Enables Open Pilot to adjust the top speed allowed for adaptive cruise control (ACC) based on the speed limit information provided by our Tesla maps system OR detected by AP1/AP2. Once enabled, your top speed will adjust based on the speed limit for that road**plus**the offset (either relative or fixed) that you set in the next two settings. Use relative offset (toggle): When enabled, Open Pilot uses the**Speed limit offset**values as a percentage of the speed limit. For example if you set the**Speed limit offset**and the detected speed limit in your area is 60, the max will be set to 60 + 60x15% = 69. If the speed limit was 35, the max will be 35 + 35x15% = 40. If this toggle is OFF, then the calculations will use the**speed limit offset**as a fixed delta. If the speed limit is 60, and your offset is set to 15, the max will be set to 60 + 15 = 75. If the speed limit is 35, and your offset is set to 15, the max will be 35 + 15 = 50. Speed limit offset (editable field): This is the offset (in either units of measure for your speed limit - km/h or MPH - or in % for relative offset) for the max speed limit when adjusted based on detected speed limits for the roads you are driving on. Slowdown in Turns (toggle): Reduces the car' speed in turns based on road curvature and current speed. Slowdown Factor in Turns (editable field): The multiplier used to compute the safe speed to take a turn. 0.5 is slower, 1.5 is faster. If you think the car takes turns too fast, use a lower factor. If you want the car to take faster turns, increase the factor. Braking Factor (editable field): The multiplier used to compute the Tesla braking power. 0.5 means less braking and 1.5 means more braking. Acceleration Profile (editable field): The profile to be used for acceleration: 1-Chill, 2-Standard, 3-Mad Max Use Long Control data (toggle): Uses data from Tesla fleet to control speed based on maps. Only works on cars factory equipped with Auto Pilot. Ignore Radar Errors (toggle): Ignore Tesla Radar errors about calibration not being done. Force Tesla AP Fingerprint (editable field): Forces fingerprint for a specific model of Tesla with Auto Pilot. This should not be used for pre AP Tesla Model S.Possible values are*TESLA AP1 MODEL S*, TESLA AP1 MODEL X , TESLA AP2 MODEL S . Disable Main Sounds (toggle): Disables the device from playing the Engagement and Disengagement sounds. To be used when the car will generate these sounds by itself. Prompt and Warning sounds will still be played. Disable Prompt Sounds (toggle): Disables the device from playing the Prompt sounds. To be used when the car will generate these sounds by itself. Engagement/Disengagement and Warning sounds will still be played. Tesla specific settings for the Tesla Unity branch of Open Pilot (1/1)","title":"Tesla Unity Config"},{"location":"Tesla_Unity_Configuration/#intro","text":"On top of the standard settings offered by Open Pilot, Tinkla Unity has three separate sections which configure how the software behaves in your car. Understanding these settings and what they do is a crucial component on having the best experience with Tinkla Unity in your vehicle. Because our cars are so similar yet so different (just between 2012 and 2014 the number of available factory configurations for Model S is ridiculously high), combined with changes made by Tesla between software updates, it is hard to automate the configuration. So please take your time to read through these settings and understand them. If you have questions, please join us on Discord where people will be happy to answer your questions. Do not turn on settings for features you do not have installed at the moment (like using the Tesla Radar or using the Pedal Interceptor) as they will prevent the software from running (they expect to receive data from those devices once enabled). For theeditable settings, do not change them from the default values to one of the extremes (max or min) without understanding how they work.","title":"Intro"},{"location":"Tesla_Unity_Configuration/#editing-numerical-values","text":"Some of our settings are just toggles (ON green, OFF grey), but some are editable as numbers. It is important to understand how these numerical settings work. Look at the screen shots below. The screen shows the title of the setting, some tips/description for what you are doing and (if applicable) the unit of measure. Then the third row has the minimum value, maximum value and step. Values are always limited between min and max and based on the step. If you enter a value lower than the min, the min value will be used. If you enter a value larger than the max, the max value will be used. If you enter a value between min and max, it will be approximated to the closest step increment from the value you entered. It is very important to check the value once you save it. It will be displayed in the settings screen, next to the \"Change\" button. There is no need to enter the units of measure. Any text other than numbers is ignored and the units of measure are added automatically. There is one field ( Speed Limit Offset ) which can be either in your car's units of measure (km/h or MPH) OR can represent a percentage of the speed limit. The way this field is interpreted depends on the value of the**Use relative offset**toggle. Editing numerical values in Tesla Unity settings page (\u00bd) Editing numerical values in Tesla Unity settings page (2/2)","title":"Editing numerical values"},{"location":"Tesla_Unity_Configuration/#tinkla","text":"These settings apply to all models of Tesla. They control software that was created only for the Tesla branch. Enable HSO (toggle): Enables Human Steering Override (HSO) feature, which allows the driver to take over the steering wheel without disengaging the Open Pilot software. Once the hand is removed from the steering wheel, the software takes over again to keep the vehicle in the lane. HSO numb period (editable field): This is the interval, in seconds, at which Open Pilot checks if the driver is still overriding the steering. Default values is 1.5 seconds. A value to small and you might have to fight Open Pilot over control. A value too large will delay Open Pilot from taking control in time after you let go of the steering wheel. Enable HAO (toggle): Enables the Human Acceleration Override (HAO) feature, which allows the driver to accelerate the car while Open Pilot has longitudinal control of the vehicle without disengaging the software. Enable ALC (toggle): Enables Automatic Lane Change (ALC) feature, which automatically changes lanes x seconds (see ALC delay) after the turn signal stalk was tapped (not fully pressed). During the whole process of ALC, the turn signals will be kept on and the software will check if the line between lanes allows for a lane change and (on AP1/AP2 cars) if there is any vehicle in the blind spot. For pre AP cars, which do not have blind spot monitoring, please confirm there is no vehicle. If there is, fully press the turn signal to cancel the ALC process ALC delay (editable field): The dalay, in seconds, from the turn signal stalk press until the Open Pilot initiates the lane change. During this time the blinker will remain on, allowing the other drivers to see your intentions. You can reduce the wait time by slightly touching the steering wheel in the direction of lane change, which will initiate it at that moment. Enable OP Long Control (toggle): Allows Open Pilot to control the acceleration and braking of your vehicle. If this toggle is Off, you will have to accelerate/brake on your own for pre AP Tesla Model S (Open Pilot will just do lane keep assist) or it will use the built in adaptive cruise control (ACC) feature of your Tesla Model S/X with AP1 / AP2 . Turn screen off while engaged (toggle): Turns off the Comma devkit screen when there are no messages/warnings to be shown. It turns on automatically if there is something to be displayed. Show Debug View (toggle): For development purpose only. Please leave this toggle OFF. Hide GPS Warnings (toggle): Because of the window treatments on our Tesla vehicles, the GPS signal inside the vehicle is very low. This will create constant warning on the Comma devkit display about the quality of GPS signal. By turning this toggle on you will mute those messages. Maps on left side (toggle): hows the maps on the left side of the screen (Comma3 only). Flip screen (for RHD) (toggle): Flips the screen for people driving on the wrong side of the road. Changes to C2 hardware are needed (C2 only) (under development) . Shutdown after # of hours (editable field): Allows the Comma devkit to automatically shutdown (reducing the power consumption on your vehicle) after x hours of car being off. When returning to your vehicle, the Comma devkit will turn back on after detecting your car is on. Hands on level (editable field): Level at which to detect hands on wheel. Higher number means more force needed. Tinkla Development Unit (toggle): For development purpose only. Please leave this toggle OFF. Flash Panda (button): Panda is a separate internal component inside your Comma devkit. It has its own software and does a lot of the safety controls and checks between your car and the Comma devkit. You can think of it as the CAN Police. Every time you update your Comma devkit software you will also have to flash the new code on the Panda. This button starts the process to flash your Panda . Tinkla specific settings for the Tesla Unity branch of Open Pilot (\u00bd) Tinkla specific settings for the Tesla Unity branch of Open Pilot (2/2)","title":"Tinkla"},{"location":"Tesla_Unity_Configuration/#tesla-pre-ap","text":"These settings apply only to pre AP Tesla Model S. They control how OP software works on a Tesla that never had Auto Pilot hardware. Tesla software post 2019.16 (toggle): Most users should have this toggle ON. If by any chance (I do hope not) you're running Tesla software older than version 2019.16, do turn this OFF to see if it works on your car. There were CAN messages changed between pre and post version 2019.16. Use pedal (toggle): If you have a pedal interceptor installed in your car, please turn this toggle ON. Otherwise, leave it OFF. This can create issues if turned ON without a pedal interceptor installed. Use pedal over CC (toggle): If you have a pedal interceptor installed in your car AND want to have pedal based adaptive cruise control (PCC) enabled all the time no matter what the status of your car's cruise control is, turn this ON. It will completely disable your car's cruise control. If you have pedal interceptor and leave this OFF, then when the car's cruise control is ON you can not engage Open Pilot but it will allow you to use the factory Cruise Control. Pedal on CAN0 (toggle): If you have a pedal interceptor installed in your car and it is connected on CAN0, then turn this toggle ON. An example when you would need this on would be connecting the pedal to the Comma Relay RJ45. If your pedal is connected to the Tinkla OBD-C Adapter , then leave this toggle OFF as your pedal will be on CAN2. Pedal Profile (editable field): The profile to be used with the Tinkla Pedal Interceptor. 1-wider range to 4-narrower range, 5-no limits (default). If 5 seems to aggressive, try 2,3 or 4. Auto Resume ACC (toggle): Not used at the moment Follow Distance (editable field): This field adjusts the follow distance, in seconds, from the lead car. A smaller value will keep you closer to the lead car while a larger value will keep you farther out from the lead car. It is speed dependent. For example, at 60 MPH your vehicle travels at a speed of 27 m/s (meters per second). A value of 0.8s for the follow distance will keep your vehicle 27 * 0.8 = 21.6m (72ft) back, while a value of 1.2s will keep your vehicle 27 * 1.2 = 32.4m (108ft) back. At 30 MPH the distance will be 10.8m (36ft) for 0.8s and 16.2m (54ft) for 1.2s. Use Tinkla Buddy (toggle): Tells the Tesla Unity code to send the messages for IC integration if you have a Tinkla Buddyinstalled in your pre AP Tesla Model S with MCU1 car. (does not work for MCU2 cars). Use Tesla Radar (toggle): Tells the Tesla Unity code that you have installed a Tesla Bosch Radar in your car. Do not turn this ON unless you have properly installed and configured a radar in your car or the software will not work. Radar behind nosecone (toggle): If you installed the Tesla Bosch Radar behind the nosecone, turn this feature ON before doing the Radar VIN Learn process so that the radar learns about its position. Radar offset (editable field): If you installed a Tesla Bosch Radar in your car and have the radar off-center (like when it is behind the nose cone), adjust this value to show the**horizontal**distance, in meters, between the center of the nosecone (the middle of the Tesla logo) and the center of the radar. Positive numbers towards left of the car (as seen from the driver seat). Use Radar Upside Down (toggle): Allows one to install the Tesla Radar upside down. Car has i Booster (toggle): Turn this toggle on if you have retrofitted your car with the SGH Innovations' i Booster ECU to take advantage of full stop-and-go capabilities. Ignore wrong Date/Time (toggle): Allows a rebooted EON to run even if the date is incorrect. Prevents need to connect to network upon restarting. Force Pre AP Tesla Model S (toggle): This toggle has to be always ON if you have a pre AP Tesla Model S. It has to be OFF for any other Tesla vehicle. It forces the Tesla Unity code to think it is connected to a pre AP Tesla Model S and to adjust all the settings accordingly. Turing this feature ON on an AP1/AP2 Tesla will make the software stop working. Flash EPAS (button): This feature patches the code in the electronic power assisted steering (EPAS) ECU of your car, allowing us to control the steering. It is a necessary step when installing the software for the first time and might be needed again if the software stops steering your car after a Tesla software update. Flash Pedal (button): Use this feature if you just installed a pedal interceptor in your car to ensure the Tesla specific software is loaded on the pedal interceptor. Please make sure you set your toggles properly for the pedal interceptor (see above) BEFORE attempting to flash the code onto the device. Calibrate Pedal (button): Use this feature to calibrate your pedal interceptor device in order to enable the right experience when using PCC. Pedal will not work (will not allow you to enable PCC) until it is calibrated. Radar VIN Learn (button):Use this feature to configure your radar if you have installed a Tesla Bosch Radar in your car. It will program the VIN of your car as well as the location of the radar. Please make sure you configure all the toggles and settings for the radar (see radar options on this page) before attempting the Radar VIN Learn. Tesla pre AP specific settings for the Tesla Unity branch of Open Pilot (\u2153) Tesla pre AP specific settings for the Tesla Unity branch of Open Pilot (\u2154) Tesla pre AP specific settings for the Tesla Unity branch of Open Pilot (3/3)","title":"Tesla pre AP"},{"location":"Tesla_Unity_Configuration/#tesla-generic","text":"These settings apply to all models of Tesla. They control how OP software works on a Tesla. Adjust ACC max with speed limit (toggle): Enables Open Pilot to adjust the top speed allowed for adaptive cruise control (ACC) based on the speed limit information provided by our Tesla maps system OR detected by AP1/AP2. Once enabled, your top speed will adjust based on the speed limit for that road**plus**the offset (either relative or fixed) that you set in the next two settings. Use relative offset (toggle): When enabled, Open Pilot uses the**Speed limit offset**values as a percentage of the speed limit. For example if you set the**Speed limit offset**and the detected speed limit in your area is 60, the max will be set to 60 + 60x15% = 69. If the speed limit was 35, the max will be 35 + 35x15% = 40. If this toggle is OFF, then the calculations will use the**speed limit offset**as a fixed delta. If the speed limit is 60, and your offset is set to 15, the max will be set to 60 + 15 = 75. If the speed limit is 35, and your offset is set to 15, the max will be 35 + 15 = 50. Speed limit offset (editable field): This is the offset (in either units of measure for your speed limit - km/h or MPH - or in % for relative offset) for the max speed limit when adjusted based on detected speed limits for the roads you are driving on. Slowdown in Turns (toggle): Reduces the car' speed in turns based on road curvature and current speed. Slowdown Factor in Turns (editable field): The multiplier used to compute the safe speed to take a turn. 0.5 is slower, 1.5 is faster. If you think the car takes turns too fast, use a lower factor. If you want the car to take faster turns, increase the factor. Braking Factor (editable field): The multiplier used to compute the Tesla braking power. 0.5 means less braking and 1.5 means more braking. Acceleration Profile (editable field): The profile to be used for acceleration: 1-Chill, 2-Standard, 3-Mad Max Use Long Control data (toggle): Uses data from Tesla fleet to control speed based on maps. Only works on cars factory equipped with Auto Pilot. Ignore Radar Errors (toggle): Ignore Tesla Radar errors about calibration not being done. Force Tesla AP Fingerprint (editable field): Forces fingerprint for a specific model of Tesla with Auto Pilot. This should not be used for pre AP Tesla Model S.Possible values are*TESLA AP1 MODEL S*, TESLA AP1 MODEL X , TESLA AP2 MODEL S . Disable Main Sounds (toggle): Disables the device from playing the Engagement and Disengagement sounds. To be used when the car will generate these sounds by itself. Prompt and Warning sounds will still be played. Disable Prompt Sounds (toggle): Disables the device from playing the Prompt sounds. To be used when the car will generate these sounds by itself. Engagement/Disengagement and Warning sounds will still be played. Tesla specific settings for the Tesla Unity branch of Open Pilot (1/1)","title":"Tesla Generic"},{"location":"The_EON/","text":"The original EON is not supported in the latest releases of software from Open Pilot. The Tinkla Unity software will not run on the original EON. You can still find some old versions of Open Pilot for Tesla (v0.6.6 and v0.7.4) but you will not be able to take advantage of the newer features. Also the EON requires the EPAS harness to work on pre AP Tesla Model S. The EON is the name associated in the Comma.ai community to the device that sits in your windshield and does all the calculations for LKA and ACC. Comma.ai EON Dev Kit EON Dev Kit (or Fr EON) The EON is based on the Qualcom Snapdragon 821 mobile platform . Phones like One Plus 3T or Le Eco Le Pro3 have been used to create the Fr EON (the free EON). You can find some instructions here . If you choose to buy your EON already made, you can do so from Comma.ai store for $599 USD. Also, as we run more and more processing on the EON, it gets hotter and hotter. Some of us have opted to replace the original fan (which is also noisy when you're inside of a Tesla) with super quiet Noctua fans . $15 from Amazon and soldering two wires and you're good to go! We might have to actually double that to two Noctua fans in the near future. Also, keeping the phone screen off helps keeping the temperature low. I know, in the beginning one wants to see those lines matching the lines in the video, but after a while you stop paying attention to the screen. And if you have the IC integration all the data is on IC anyway. So turn that screen off and you will see the temperature drop about 15F. Code for power management of battery (only charging when below 60% and stopping the charge when it reaches 80%) has helped keep the battery temperature lower and hence the CPU cooler. And this is a free upgrade, as the code is already in my repo. Here is a helpful EON bash profile (.bash_profile). Installing the EON EON installation is pretty simple. Your main objective is to ensure the EON is level with the ground, and pointed as straight as you can get it. If you're uncomfortable \"eyeballing it,\" you may want to use: A measuring tape A roll of masking tape A friend to help Instructions Find a place at the bottom of the windshield, along the driver's side pillar that has a similar position on the passenger side (such as the place where the corner of the front hood meets the fender). With the tape starting from that point, mark 3 places along the side of the windshield. Use the edge of the masking tape to mark them. I personally used 3\" from the bottom, the top of the windshield and then about \u2153 from the bottom, \u2154 from the top. It does not matter what the measuring tape says, as long as it says the SAME distance on driver's and passenger's sides. Repeat the process on the other side of the windshield, ensuring you mark the same spots. measure the distance between one edge of the windshield and the other end, keeping the tape at each pair of marked points from before. use masking tape to mark the middle of the windshield. again, use the EDGE of the tape, not the center. Now use a long piece of masking tape to mark the center of the windshield from top to bottom. This (if you did everything correctly) will cover all 3 of your markers from before and provide a straight line. One edge of the masking tape is now the perfect middle of the windshield. Your mount will have to be aligned with that for a perfect position. Take a small piece of tape and mark the middle of the Go Pro mount. use a slightly longer piece than the go-pro (maybe \u00bc-\u00bd\" more on each side) and ensure it is straight and down the middle of the Go Pro. If, when looking from inside of the car, your tape is to the RIGHT of the center, then put the tape on the LEFT side of the Go Pro. Reverse if the other way. Using your EON without the mounting bracket, determine the location along the center of the windshield where you want it placed. Make sure the grove on the support is alongside the center of the windshield. use a small piece of masking tape to mark the upper part of the position where you want your EON to be. Remove the RED protective tape from the back of the 3M adhesive and be ready to place the Go Pro on the windshield. Align the masking tape we placed on the Go Pro mount on the inside with the masking tape we have on the outside of the windshield. They should not overlap at all AND you should not see light either. when you are confident on the position press hard on the mount. Remove all masking tape. You are done. You now have a perfectly centered, perfectly vertical EON. Hide the USB/antenna cable above the Headliner Pull your USB and GPS antenna cables from the footwell gap (where the OBDII port with a giraffe or giraffe-less cable, and Panda are) up to where the \"A\" pillar is... Follow the instructions to remove the air bag cover from the \"A\" pillar Pull the USB/antenna cables up the height of the \"A\" pillar across the the mirror holding them close to the headliner. Adjust the length and to reach where you will place your panda and your EON. The GPS receiver can be placed under the mirror*Frit*, it won't effect performance (the pattern is only to prevent glare on the mirror). Drape the receiver and USB plug ends over the rear view mirror. Move to the corner where the headliner and the removed airbag panel intersect, this corner is the easiest place to stick a pry tool... Using your pry tool lift the corner and move the pry-tool along the top of the windshield tucking the two wires into the headliner as you go. When you reach the mirror base, this can be lifted slightly route the GPS into the headliner crossing in between headliner and mirror base, while the EON USB cable can be routed down the front of the windshield to emerge at the bottom of the mirror base closer to the centre of the windshield. Once the cabling is tucked in the headliner, move back to the \"A\" pillar and tuck the cable into the pillar cover routing it down towards the door seal, then secure the pillar cover to conceal the wiring. Installing Open Pilot for Tesla Comma.ai doesn't support Tesla cars. That's why we maintain our own fork, which you will have to manually check out after setting up your EON. DON\u2019T INSTALL ON ANYTHING OTHER THAN A TESLA! (Someone bricked their Jeep trying.) Start with Stock Open Pilot Follow the instructions for setting up an EON with Open Pilot using these instructions: Comma EON Initial Setup with Open Pilot Then we will#Git the Tesla OP Fork Git the Tesla OP Fork SSH into your EON and execute the following commands (you need internet connectivity on your EON): cd /data rm -rf /data/openpilot git clone --depth 1 https://github.com/Bog Gyver/openpilot.git -b tesla_0.6.6 /data/openpilot reboot The first reboot will take around 20 minutes to set everything up. Edit your Config After the EON has booted you can edit your config , which now has been automatically created. At the top find user_handle = your_tinkla_username , set force fingerprint to True, and change your_tinkla_username to your Tinkla username (preferred, if available) or to your Discord handle. nano /data/bb_openpilot.cfg Make sure to set use_tesla_gps = True in case you're using a White Panda (Grey Panda has GPS built in). With GPS info of your drives you're helping Comma to improve their models (Open Pilot uploads your drives to their servers). Keep in mind that config changes only apply after rebooting the EON. Flash your Panda After installing or updating Open Pilot on your EON, you need to also update the software on your Panda. Here's how: In your Tesla while it says \u201cCar Off\u201d connect your Panda to your Giraffe rev B OBD (or EPAS OBD). Connect your EON to the Panda via USB. Then SSH in and run: cd /data/openpilot/panda/board killall boardd make clean make && sleep 1 && (make recover || make recover) && echo Success! Rebooting in 2s... && sleep 2 && reboot The kill command ensures that the EON stops regular communication to the Panda. That's also why a reboot is needed at the end. If any error occurs (which of course should not happen) the reboot will be skipped so you can troubleshoot. Assertion Errors should be fixed by rebooting EON and trying a second time. Optionally you may also power cycle your Panda by reseating it. Final steps Finally, check here to learn more about all the controls, functions and features related to longitudinal control: Using adaptive cruise control First Open Pilot Drive Make sure the EON is mounted properly and connected to the Panda by following #Installing the EON Make sure the EON has Internet access (either your wifi at home or a SIM card). Connect to a mobile hotspot if you don't have a SIM card1. Reboot your EON before turning your car on for good measure Turn your car on and verify that the Panda LEDs are pulsing red/blue/purple. If they are green, your panda is not flashed, see flashing instructions here Panda Flashing . Open Pilot should switch to \"drive mode\" and show the camera view with white lane marking Make sure that your EON is connected to the Internet or Calibration will not start Read up and understand the controls from Using adaptive cruise control IF YOUR CAR IS RECOGNIZED: Calibration will increment at above 15mph. It will take less than 30 seconds to fully calibrate. If you move the mount, it's recommended to reset camera calibration under \"device settings\". When driving, Double Pull the Cruise Control Stalk to use Open Pilot IF YOUR CAR IS NOT RECOGNIZED Ask for help on the #tesla channel of the Comma.ai Discord Experiencing issues? In case you use a Pedal and it just won't work, chances are it doesn't have Tesla firmware on it yet. You can flash it with this guide . Various other problems can be related to wiring, so double check each installation page, especially EPAS Harness . On any other issue, please use the search function or ask us on Discord .","title":"EON Details"},{"location":"The_EON/#eon-dev-kit-or-fr-eon","text":"The EON is based on the Qualcom Snapdragon 821 mobile platform . Phones like One Plus 3T or Le Eco Le Pro3 have been used to create the Fr EON (the free EON). You can find some instructions here . If you choose to buy your EON already made, you can do so from Comma.ai store for $599 USD. Also, as we run more and more processing on the EON, it gets hotter and hotter. Some of us have opted to replace the original fan (which is also noisy when you're inside of a Tesla) with super quiet Noctua fans . $15 from Amazon and soldering two wires and you're good to go! We might have to actually double that to two Noctua fans in the near future. Also, keeping the phone screen off helps keeping the temperature low. I know, in the beginning one wants to see those lines matching the lines in the video, but after a while you stop paying attention to the screen. And if you have the IC integration all the data is on IC anyway. So turn that screen off and you will see the temperature drop about 15F. Code for power management of battery (only charging when below 60% and stopping the charge when it reaches 80%) has helped keep the battery temperature lower and hence the CPU cooler. And this is a free upgrade, as the code is already in my repo. Here is a helpful EON bash profile (.bash_profile).","title":"EON Dev Kit (or Fr EON)"},{"location":"The_EON/#installing-the-eon","text":"EON installation is pretty simple. Your main objective is to ensure the EON is level with the ground, and pointed as straight as you can get it. If you're uncomfortable \"eyeballing it,\" you may want to use: A measuring tape A roll of masking tape A friend to help","title":"Installing the EON"},{"location":"The_EON/#instructions","text":"Find a place at the bottom of the windshield, along the driver's side pillar that has a similar position on the passenger side (such as the place where the corner of the front hood meets the fender). With the tape starting from that point, mark 3 places along the side of the windshield. Use the edge of the masking tape to mark them. I personally used 3\" from the bottom, the top of the windshield and then about \u2153 from the bottom, \u2154 from the top. It does not matter what the measuring tape says, as long as it says the SAME distance on driver's and passenger's sides. Repeat the process on the other side of the windshield, ensuring you mark the same spots. measure the distance between one edge of the windshield and the other end, keeping the tape at each pair of marked points from before. use masking tape to mark the middle of the windshield. again, use the EDGE of the tape, not the center. Now use a long piece of masking tape to mark the center of the windshield from top to bottom. This (if you did everything correctly) will cover all 3 of your markers from before and provide a straight line. One edge of the masking tape is now the perfect middle of the windshield. Your mount will have to be aligned with that for a perfect position. Take a small piece of tape and mark the middle of the Go Pro mount. use a slightly longer piece than the go-pro (maybe \u00bc-\u00bd\" more on each side) and ensure it is straight and down the middle of the Go Pro. If, when looking from inside of the car, your tape is to the RIGHT of the center, then put the tape on the LEFT side of the Go Pro. Reverse if the other way. Using your EON without the mounting bracket, determine the location along the center of the windshield where you want it placed. Make sure the grove on the support is alongside the center of the windshield. use a small piece of masking tape to mark the upper part of the position where you want your EON to be. Remove the RED protective tape from the back of the 3M adhesive and be ready to place the Go Pro on the windshield. Align the masking tape we placed on the Go Pro mount on the inside with the masking tape we have on the outside of the windshield. They should not overlap at all AND you should not see light either. when you are confident on the position press hard on the mount. Remove all masking tape. You are done. You now have a perfectly centered, perfectly vertical EON.","title":"Instructions"},{"location":"The_EON/#hide-the-usbantenna-cable-above-the-headliner","text":"Pull your USB and GPS antenna cables from the footwell gap (where the OBDII port with a giraffe or giraffe-less cable, and Panda are) up to where the \"A\" pillar is... Follow the instructions to remove the air bag cover from the \"A\" pillar Pull the USB/antenna cables up the height of the \"A\" pillar across the the mirror holding them close to the headliner. Adjust the length and to reach where you will place your panda and your EON. The GPS receiver can be placed under the mirror*Frit*, it won't effect performance (the pattern is only to prevent glare on the mirror). Drape the receiver and USB plug ends over the rear view mirror. Move to the corner where the headliner and the removed airbag panel intersect, this corner is the easiest place to stick a pry tool... Using your pry tool lift the corner and move the pry-tool along the top of the windshield tucking the two wires into the headliner as you go. When you reach the mirror base, this can be lifted slightly route the GPS into the headliner crossing in between headliner and mirror base, while the EON USB cable can be routed down the front of the windshield to emerge at the bottom of the mirror base closer to the centre of the windshield. Once the cabling is tucked in the headliner, move back to the \"A\" pillar and tuck the cable into the pillar cover routing it down towards the door seal, then secure the pillar cover to conceal the wiring.","title":"Hide the USB/antenna cable above the Headliner"},{"location":"The_EON/#installing-open-pilot-for-tesla","text":"Comma.ai doesn't support Tesla cars. That's why we maintain our own fork, which you will have to manually check out after setting up your EON. DON\u2019T INSTALL ON ANYTHING OTHER THAN A TESLA! (Someone bricked their Jeep trying.)","title":"Installing Open Pilot for Tesla"},{"location":"The_EON/#start-with-stock-open-pilot","text":"Follow the instructions for setting up an EON with Open Pilot using these instructions: Comma EON Initial Setup with Open Pilot Then we will#Git the Tesla OP Fork","title":"Start with Stock Open Pilot"},{"location":"The_EON/#git-the-tesla-op-fork","text":"SSH into your EON and execute the following commands (you need internet connectivity on your EON): cd /data rm -rf /data/openpilot git clone --depth 1 https://github.com/Bog Gyver/openpilot.git -b tesla_0.6.6 /data/openpilot reboot The first reboot will take around 20 minutes to set everything up.","title":"Git the Tesla OP Fork"},{"location":"The_EON/#edit-your-config","text":"After the EON has booted you can edit your config , which now has been automatically created. At the top find user_handle = your_tinkla_username , set force fingerprint to True, and change your_tinkla_username to your Tinkla username (preferred, if available) or to your Discord handle. nano /data/bb_openpilot.cfg Make sure to set use_tesla_gps = True in case you're using a White Panda (Grey Panda has GPS built in). With GPS info of your drives you're helping Comma to improve their models (Open Pilot uploads your drives to their servers). Keep in mind that config changes only apply after rebooting the EON.","title":"Edit your Config"},{"location":"The_EON/#flash-your-panda","text":"After installing or updating Open Pilot on your EON, you need to also update the software on your Panda. Here's how: In your Tesla while it says \u201cCar Off\u201d connect your Panda to your Giraffe rev B OBD (or EPAS OBD). Connect your EON to the Panda via USB. Then SSH in and run: cd /data/openpilot/panda/board killall boardd make clean make && sleep 1 && (make recover || make recover) && echo Success! Rebooting in 2s... && sleep 2 && reboot The kill command ensures that the EON stops regular communication to the Panda. That's also why a reboot is needed at the end. If any error occurs (which of course should not happen) the reboot will be skipped so you can troubleshoot. Assertion Errors should be fixed by rebooting EON and trying a second time. Optionally you may also power cycle your Panda by reseating it.","title":"Flash your Panda"},{"location":"The_EON/#final-steps","text":"Finally, check here to learn more about all the controls, functions and features related to longitudinal control: Using adaptive cruise control","title":"Final steps"},{"location":"The_EON/#first-open-pilot-drive","text":"Make sure the EON is mounted properly and connected to the Panda by following #Installing the EON Make sure the EON has Internet access (either your wifi at home or a SIM card). Connect to a mobile hotspot if you don't have a SIM card1. Reboot your EON before turning your car on for good measure Turn your car on and verify that the Panda LEDs are pulsing red/blue/purple. If they are green, your panda is not flashed, see flashing instructions here Panda Flashing . Open Pilot should switch to \"drive mode\" and show the camera view with white lane marking Make sure that your EON is connected to the Internet or Calibration will not start Read up and understand the controls from Using adaptive cruise control IF YOUR CAR IS RECOGNIZED: Calibration will increment at above 15mph. It will take less than 30 seconds to fully calibrate. If you move the mount, it's recommended to reset camera calibration under \"device settings\". When driving, Double Pull the Cruise Control Stalk to use Open Pilot IF YOUR CAR IS NOT RECOGNIZED Ask for help on the #tesla channel of the Comma.ai Discord Experiencing issues? In case you use a Pedal and it just won't work, chances are it doesn't have Tesla firmware on it yet. You can flash it with this guide . Various other problems can be related to wiring, so double check each installation page, especially EPAS Harness . On any other issue, please use the search function or ask us on Discord .","title":"First Open Pilot Drive"},{"location":"The_Panda/","text":"The newer Comma devkits (Comma two and Comma three) have a built-in Panda which is similar in hardware to the Black Panda. This article is for the older versions of Panda used with EON, like the White Panda and the Grey Panda. The Panda is an OBD II dongle created by Comma.ai. It allows the EON to talk to the car via CAN busmessaging. It supports 3 CAN buses, 2 LIN buses, and 1 GMLAN. The software for the Panda is opensource (and heavily modified for Tesla). When installed on a Tesla, the Panda (by itself) creates all the messages to emulate a DAS (the Auto Pilot computer) as well as to keep the Bosch radar talking. It has CAN0 connected to the Tesla Chassis CAN, CAN1 connected to the Bosch radar, and CAN2 connected to the Tesla EPAS (the electric power steering). There are two \"flavors\" of Panda: White Panda: $99 USD - The white panda has Wi Fi and USB capabilities and can work directly with your computer running Cabana. Grey Panda: $199 USD - The grey panda has high precision GPS (to be used with maps integration) but no wifi and can't be used with Cabana. Both versions are currently fully supported because we actually use the Tesla GPS for maps integration. I have both pandas due to the amount of development I do. I use the Grey Panda for driving the car and I use the White Panda for debugging/monitoring/reverse engineering CAN messages (in conjunction with an OBD II splitter). The Comma.ai Panda can be purchased from the Comma.ai store . Flashing the Panda After installing or updating Open Pilot on your EON, you need to also update the software on your Panda. Here's how: In your Tesla while it says \u201cCar Off\u201d connect your Panda to your Giraffe rev B OBD (or EPAS OBD). Connect your EON to the Panda via USB. Then SSH in and run: cd /data/openpilot/panda/board killall boardd make clean make && sleep 1 && (make recover || make recover) && echo Success! Rebooting in 2s... && sleep 2 && reboot The kill command ensures that the EON stops regular communication to the Panda. That's also why a reboot is needed at the end. If any error occurs (which of course should not happen) the reboot will be skipped so you can troubleshoot. Assertion Errors should be fixed by rebooting EON and trying a second time. Optionally you may also power cycle your Panda by reseating it. Future updates Tesla OP is constantly being developed, tweaked, and improved. Therefore, there will be future updates which will require pulling an update and flashing your Panda. To save ourselves some time, the developers have introduced an easy way to run the commands in the \"Flashing the Panda\" section. Simply follow the instructions in EON_bash_profile to setup a .bash_profile for your EON. Then you simply run the following command while your Tesla says \u201cCar Off\u201d and your Panda is connected to your Giraffe's OBD and your EON: fp","title":"Panda Details"},{"location":"The_Panda/#flashing-the-panda","text":"After installing or updating Open Pilot on your EON, you need to also update the software on your Panda. Here's how: In your Tesla while it says \u201cCar Off\u201d connect your Panda to your Giraffe rev B OBD (or EPAS OBD). Connect your EON to the Panda via USB. Then SSH in and run: cd /data/openpilot/panda/board killall boardd make clean make && sleep 1 && (make recover || make recover) && echo Success! Rebooting in 2s... && sleep 2 && reboot The kill command ensures that the EON stops regular communication to the Panda. That's also why a reboot is needed at the end. If any error occurs (which of course should not happen) the reboot will be skipped so you can troubleshoot. Assertion Errors should be fixed by rebooting EON and trying a second time. Optionally you may also power cycle your Panda by reseating it.","title":"Flashing the Panda"},{"location":"The_Panda/#future-updates","text":"Tesla OP is constantly being developed, tweaked, and improved. Therefore, there will be future updates which will require pulling an update and flashing your Panda. To save ourselves some time, the developers have introduced an easy way to run the commands in the \"Flashing the Panda\" section. Simply follow the instructions in EON_bash_profile to setup a .bash_profile for your EON. Then you simply run the following command while your Tesla says \u201cCar Off\u201d and your Panda is connected to your Giraffe's OBD and your EON: fp","title":"Future updates"},{"location":"Tinkla_Buddy/","text":"What is Tinkla Buddy? Tinkla Buddy Install Kit Installing your Tinkla Buddy Configuring your Tinkla Buddy What is Tinkla Buddy? Tinkla Buddy (formerly r Panda) is a nice solution for our Teslas to have Instrument Cluster [IC] integration without root. If you don't have root access to your Tesla, you can now enjoy these benefits: Open Pilot Integration into IC for pre-AP cars. In car Wi Fi Access Point Control Relay via CID buttons for after-market features Secure Remote Access to your Buddy from ANYWHERE and More! Pricing Hardware Prices And Options The Tinkla Buddy install kit costs about $200 USD, depending where your source components. Software License Prices Tinkla Buddy software license is a yearly subscription model locked to the VIN of the car, so if you replace the hardware on the same car it will still work, but will not work to move the license to another car. The cost of the Tinkla Buddy software subscription is: $150.00 USD for the first year and $100.00 USD for each subsequent year. Software Design History v1.44 Tesla 2020.36.3.1 compatibility Fast setup detection Wi Fi Client mode Keep Awake for Tegras Control Relays using Tinkla Buddy Menu v1.37 Fix screenshot capturing script Fix issues with detecting MCU1 vs MCU2 Added sound triggering capabilities on CID Fix issues when running old firmware and cid-updater is not working anymore v1.33 Tesla 2020.24.6.1 compatibility Remote cron capabilities that allow you to run bash scripts on CID every 1, 5, 15 or 60 minutes (requires root persistence) Fixes for persistence scripts to work well with 2020.20 and newer Tesla software Speed/reliability improvements v1.27 Fully boot without being connected to either IC or CID Reduce number of Qt Car restarts by detecting IC state Increase automatically switch back to analog to 5 min to allow for buddy reboots without changes to IC Increase number of checks for state of IC and CID before pulling Vitals v1.26 Allow Buddy to boot without IC/CID on Bug fix for IC not turning on after deep sleep (Note: Vitals need to be re-enabled after each version upgrade) v1.25 Bug fix for vitals without root on latest versions (up to 2020.12.11.5) Bug fix with Factory Mode on latest versions (up to 2020.12.11.5) Detects automatically if cars has AP hardware (\u00bd/2.5/3) Detects automatically if car has MCU1 or MCU2 hardware Vitals checking is an option now in Tinkla Menu and is disabled by default v1.22 Fully redesigned networking stack for faster response on boot, activation and interaction Now Tinkla Buddy can be installed between IC and MCU (IC \u2194 Buddy \u2194 MCU) or between MCU and APE (MCU \u2194 Buddy \u2194 APE) allowing it to work on both MCU1 and MCU2 cars. Auto-detection of MCU type (Tegra vs Intel) Auto-detection of AP type (pre-AP, AP1, AP2, AP2.5, AP3) Auto-detection of installation location Improved Wi Fi stability v1.21 Fixes issue with starting persistence mode LEDs now show status of tinkla Buddy and availability of valid cert v1.20 Menu button trigger for Tinkla Menu for older (LIN based) steering wheel controls Fixes brightness control Resolves issue with crash when car would go in sleep mode","title":"Overview"},{"location":"Tinkla_Buddy/#what-is-tinkla-buddy","text":"Tinkla Buddy (formerly r Panda) is a nice solution for our Teslas to have Instrument Cluster [IC] integration without root. If you don't have root access to your Tesla, you can now enjoy these benefits: Open Pilot Integration into IC for pre-AP cars. In car Wi Fi Access Point Control Relay via CID buttons for after-market features Secure Remote Access to your Buddy from ANYWHERE and More!","title":"What is Tinkla Buddy?"},{"location":"Tinkla_Buddy/#pricing","text":"","title":"Pricing"},{"location":"Tinkla_Buddy/#hardware-prices-and-options","text":"The Tinkla Buddy install kit costs about $200 USD, depending where your source components.","title":"Hardware Prices And Options"},{"location":"Tinkla_Buddy/#software-license-prices","text":"Tinkla Buddy software license is a yearly subscription model locked to the VIN of the car, so if you replace the hardware on the same car it will still work, but will not work to move the license to another car. The cost of the Tinkla Buddy software subscription is: $150.00 USD for the first year and $100.00 USD for each subsequent year.","title":"Software License Prices"},{"location":"Tinkla_Buddy/#software-design-history","text":"","title":"Software Design History"},{"location":"Tinkla_Buddy/#v144","text":"Tesla 2020.36.3.1 compatibility Fast setup detection Wi Fi Client mode Keep Awake for Tegras Control Relays using Tinkla Buddy Menu","title":"v1.44"},{"location":"Tinkla_Buddy/#v137","text":"Fix screenshot capturing script Fix issues with detecting MCU1 vs MCU2 Added sound triggering capabilities on CID Fix issues when running old firmware and cid-updater is not working anymore","title":"v1.37"},{"location":"Tinkla_Buddy/#v133","text":"Tesla 2020.24.6.1 compatibility Remote cron capabilities that allow you to run bash scripts on CID every 1, 5, 15 or 60 minutes (requires root persistence) Fixes for persistence scripts to work well with 2020.20 and newer Tesla software Speed/reliability improvements","title":"v1.33"},{"location":"Tinkla_Buddy/#v127","text":"Fully boot without being connected to either IC or CID Reduce number of Qt Car restarts by detecting IC state Increase automatically switch back to analog to 5 min to allow for buddy reboots without changes to IC Increase number of checks for state of IC and CID before pulling Vitals","title":"v1.27"},{"location":"Tinkla_Buddy/#v126","text":"Allow Buddy to boot without IC/CID on Bug fix for IC not turning on after deep sleep (Note: Vitals need to be re-enabled after each version upgrade)","title":"v1.26"},{"location":"Tinkla_Buddy/#v125","text":"Bug fix for vitals without root on latest versions (up to 2020.12.11.5) Bug fix with Factory Mode on latest versions (up to 2020.12.11.5) Detects automatically if cars has AP hardware (\u00bd/2.5/3) Detects automatically if car has MCU1 or MCU2 hardware Vitals checking is an option now in Tinkla Menu and is disabled by default","title":"v1.25"},{"location":"Tinkla_Buddy/#v122","text":"Fully redesigned networking stack for faster response on boot, activation and interaction Now Tinkla Buddy can be installed between IC and MCU (IC \u2194 Buddy \u2194 MCU) or between MCU and APE (MCU \u2194 Buddy \u2194 APE) allowing it to work on both MCU1 and MCU2 cars. Auto-detection of MCU type (Tegra vs Intel) Auto-detection of AP type (pre-AP, AP1, AP2, AP2.5, AP3) Auto-detection of installation location Improved Wi Fi stability","title":"v1.22"},{"location":"Tinkla_Buddy/#v121","text":"Fixes issue with starting persistence mode LEDs now show status of tinkla Buddy and availability of valid cert","title":"v1.21"},{"location":"Tinkla_Buddy/#v120","text":"Menu button trigger for Tinkla Menu for older (LIN based) steering wheel controls Fixes brightness control Resolves issue with crash when car would go in sleep mode","title":"v1.20"},{"location":"Tinkla_Buddy_Admin/","text":"","title":"Admin"},{"location":"Tinkla_Buddy_Configuration/","text":"What is Tinkla Buddy? Tinkla Buddy Install Kit Installing your Tinkla Buddy Configuring your Tinkla Buddy Registering your Tinkla Buddy In order for your Tinkla Buddy to operate, it needs certificates which are given by the Tinkla server to those that registered their product. When you register your device you receive a free 14 day trial period. During this time your Tinkla Buddy has full functionality. Expand section for details. 30 days prior to your the expiration of your license or trial period, you have the option to purchase or renew the yearly subscription using the built in Pay Pal connection. Once your trial or license period expires, all functionality on the Tinkla Buddy is removed until you purchase / renew your license. To register your Tinkla Buddy first you need to create an account ontinkla.us AND confirm your email. Once you have yourtinkla.usaccount setup, you can register your Tinkla Buddy using the Tinkla Buddy Adminportal. Once you have verified your credentials, you will be required to enter your personal information as well as select your email notification preferences. These settings can be later changed from the**Account**menu, by selecting**User Preferences** Now it is time to finally register your Tinkla Buddy. You will need to know the VIN of the car you are installing the Tinkla Buddy on. From the main menu select**Tinkla Buddy**and then**Register**. Enter your VIN and a nickname for your car. The nickname can be later changed by clicking on it in the details page for your Tinkla Buddy. The VIN can not be changed, so please double check it before creating the record.Then click the**Save**button. You will notice that for now your Tinkla Buddy record has no data. The**Buddy Software**,**Tesla Software**fields will be empty and the**Last Signal**and**Cert Update**fields will show dates in the past. Do not worry, they will get updated the moment your Tinkla Buddy gets its certs for the first time. It is now time to power up your Tinkla Buddy for the first time . Using the Tinkla Buddy Admin portal Do you need to see data from your Tesla? Do you need to look at the Tesla Vitals? Do you want to remotely**ssh**into your Tinkla Buddy? Do you need to give somebody that is helping you remote access ( ssh ) to your Tinkla Buddy? Do you need to purchase/renew your Tinkla Buddy software license? You can do all of the above plus much more from the Tinkla Buddy Admin. Expand section for details. Using the Tinkla Menu The Tinkla Menu has various basic configuration settings you can activate. You can activate the menu with either four presses on the Wheel's Menu button or (if you're parked) four presses on the Parking Brake. Expand section for details. If you plan to use email to send screenshots, please make sure you setup your email address correctly in /home/pi/.tinkla/email_settings. Please allow at least 20 seconds between requests to allow the command to complete. CID screen shot only works if you have persistence enabled. Tinkla - Buddy - Restart - Restarts Tinkla Buddy's processes. Reboot - Reboots Tinkla Buddy, entirely. ( Not recommend ) Update - Checks for a Tinkla Buddy update. Quiet - Puts the device in a quiet mode for Service Center visits. Wifi - Info - This shows the current Wireless Access Point name and password to join the network and use your car's 3g or LTE internet. IC Int. - Here you can Turn Integration**On**or**Off**- IC integration allows Open Pilot to appear on the Instrument Cluster similar to Tesla Auto Pilot. It also shows data from your Baolong TPMS as if you have a Conti TPMS retrofit. **Please note:**it can take up to a minute for your IC to restart the processes in integration mode and it will flicker twice during the process. The IC isn't rebooted, just restarting processes. Tunnels - Here you can turn Tunnels**On**or**Off**- Turning tunnels on allows you to use the Tinkla Bastillion server to SSH into your Tinkla Buddy and it enables the remote control app (in development) Tesla - Tokens - If you are a security researcher and have access to your car's systems, you'll be able to see it here. Ludi - Temps - This option adds a temperature gauge to the bottom left third of the power graph when using IC Int. On - This option adds the temperature gauge from above, shows a wireframe of your car exposing front and rear motors, and adds a power value and peak usage graph to the left side of your IC. Off - Disables all of the Ludi additions. Misc - VLow - Sets air suspension very low (your car must be parked to enable). IC SS - This will take a screenshot of your IC and email it to you. (You'll need to SSH into Tinkla Buddy to configure /home/pi/.tinkla/email_settings ) CID SS - This will take a screenshot of your Central Infotainment Display [CID] and email it to you. (You'll need to SSH into Tinkla Buddy to configure /home/pi/.tinkla/email_settings ). CID screen shot only works if you have persistence enabled! Advanced - Dev - This will enable you to access Dev Mode. Fact - This will enable you to enter Factory Mode. Unlock -This will unlock the Diagnostic Port. Kill - This will kill any staged software updates. Info - ... Custom - This set of menus are for your use to add/run your own menu scripts to run from the Tinkla Buddy and show the results on your CID. All additions and changes will need to be added to your Tinkla Buddy via SSH to /home/pi/.tinkla/your_commands.json Using the Tinkla Buddy Webapp Tinkla Buddy Webapp is a web based application hosted on your Tinkla Buddy. It allows you to do more configurations on your Tinkla Buddy that can not be achieved through the Tinkla Menu, such as setting up token persistence, changing your Wi Fi access point password, etc. Expand section for details. Setup Wi Fi for access to Tinkla Buddy App. First activate the TB on your CID using either the wheel menu button or (if parked) parking button four times. Select**Tinkla**. Then select**Wi Fi**. Then select**On**, to turn on the Wi Fi SSID. On your Cell phone look for the SSID tinkla AP , the Wi Fi password is tesla Fr33 Select the SSID and it will assign an IP (it may tell you there is no internet). The next thing to do is go to your favorite browser on the phone, and enter the following URL http://10.5.5.1 You will be presented with the log in screen. The first time password is 1234 Then of course hit Login Now you can start exploring. Customize Tinkla Menu If you want to add new options to your Tinkla Menu, this is the place to learn how to. You can add commands that run scripts, turn features on or change car configuration with one press of a button. Expand section for details. In the /home/pi/.tinkla folder there is a file called your_commands.json Where the custom menu items should be added. There are already examples in the file you can follow. For long command sequences it is best to create a script in /home/pi/.tinkla and just call the script with something like /bin/bash /home/pi/.tinkla/my_script.sh from the your_commands.json . {\"menu\":[ {\"id\":1000,\"text\":\"The file that generates this section is /home/pi/.tinkla/your_commands.json. The base menu for it has ID 1000 and we suggest to keep all the other submenus you might create with unique IDs above 1000. Look at the file for suggestions how to create custom commands. \",\"options\":[ {\"label\":\"Menu\",\"type\":\"menu\",\"value\":\"1001\"}, #this will open the menu defined as id:1001 {\"label\":\"Reboot TB\",\"type\":\"shell\",\"value\":\"reboot\"}, #this sends \"reboot\" as a command. {\"label\":\"Some Script\",\"type\":\"shell\",\"value\":\"/bin/bash /home/pi/.tinkla/my_script.sh\"} #no comma after the last option. ]}, {\"id\":1001,\"text\":\"This is just an example of a submenu. Here I just defined 1 button. The Back button is added automatically to any Menu.\",\"options\":[ {\"label\":\"Main Menu\",\"type\":\"menu\",\"value\":\"1\"} ]} ]} To run a script on the CID, and as long as you have persistence enabled, then you can include these commands inside my_script.sh to have some thing run on the CID: scp CID_script.sh cid:/tmp/CID_script.sh ssh cid bash /tmp/CID_script.sh ssh cid rm /tmp/CID_script.sh Cron Jobs If you already have root and token persistence setup, then you can have scripts set to run periodically on the CID based on where you place your script.sh . Based on the directory you use, you can have a script run after Reboot (MCU reboot, not Tinkla Buddy), every 1, 5, 15, or 60 minutes. Expand section for details. Scripts within these folders**MUST**have filenames ending in .sh . /opt/tinkla/cron/after Reboot /opt/tinkla/cron/every One Minute /opt/tinkla/cron/every Five Minutes /opt/tinkla/cron/every Fifteenminutes /opt/tinkla/cron/every Hour For those users that have root persistence, I recommend adding a**clean_traces.sh**file to the**/opt/tinkla/cron/every One Minute**folder containing the following code sed -i '/192\\.168\\.90\\.101/d' /var/log/sshd/current sed -i '/key type ssh-dss not/d' /var/log/sshd/current cat /dev/null > /var/log/auth.log echo 'set +o history' > /root/.bashrc cat /dev/null > /root/.bash_history echo 'set +o history' > /home/tesla/.bashrc cat /dev/null > /home/tesla/.bash_history If you have root persistence and want the Auto Pilot screen on CID, create a script called**ap_screen.sh**in the**/opt/tinkla/cron/after Reboot**folder containing this code: edit-settings-conf.pl -a vapi/force Has Autopilot=true edit-settings-conf.pl -a vapi/force Has Drive On Nav=true edit-settings-conf.pl -a vapi/force Has Drive On Nav Maps=true /usr/local/bin/sdv GUI_autopilot Always On true /usr/local/bin/sdv GUI_autosteer On Request true /usr/local/bin/sdv GUI_autosteer Disabled false /usr/local/bin/sdv GUI_acc From Zero true /usr/local/bin/sdv DAS_map Availability true /usr/local/bin/sdv GUI_red Light Stop Sign On Request true /usr/local/bin/sdv GUI_enable Map Stops true /usr/local/bin/sdv GUI_enable Vision Stops true /usr/local/bin/sdv GUI_enable FSDFunctions true /usr/local/bin/sdv GUI_stop And Go true /usr/local/bin/sdv GUI_noa Everywhere true /usr/local/bin/sdv DAS_nav Available true /usr/local/bin/sdv GUI_acc Follow Distance 2 /usr/local/bin/sdv GUI_acc Overtake On Request true /usr/local/bin/sdv GUI_autopilot Control Request 0 /usr/local/bin/sdv FEATURE_das Drive On Nav Enabled true /usr/local/bin/sdv FEATURE_das Drive On Nav Maps Okay true /usr/local/bin/sdv VAPI_backup Camera Calibrated true /usr/local/bin/sdv VAPI_fisheye Camera Calibrated true /usr/local/bin/sdv VAPI_l Pillar Camera Calibrated true /usr/local/bin/sdv VAPI_l Repeater Camera Calibrated true /usr/local/bin/sdv VAPI_main Camera Calibrated true /usr/local/bin/sdv VAPI_narrow Camera Calibrated true /usr/local/bin/sdv VAPI_r Pillar Camera Calibrated true /usr/local/bin/sdv VAPI_r Repeater Camera Calibrated true echo \"1\" > /var/etc/dashw echo \"dashw 1\" >> /var/etc/gateway.cfg echo \"autopilot 1\" >> /var/etc/gateway.cfg stop qtcar-audiod stop qtcar stop qtcar-carserver start qtcar-carserver start qtcar start qtcar-audiod Controlling Relays You can control relay banks of 4 or 8 channels easily with your Tinkla Buddy by configuring a custom menu. The channels can be controlled independently or in groups. To control a channel, we use the**usbrelay**application that is already installed on your Tinkla Buddy. When you get a new relays bank, you need to power it up via 12v from the car and also connect it to the Buddy via USB. Once all connections are done, the fun can begin. NOTE: If usbrelay command is not found on your Buddy, please run apt-get update; apt-get -y install usbrelay. Using the remote ssh feature of the website, open a terminal session to your Buddy. From the command prompt, type**usbrelay**and (if everything is connected correctly) you will see something like this usbrelay Device Found type: 16c0 05df path: /dev/hidraw0 serial_number: Manufacturer: www.dcttech.com Product: USBRelay4 Release: 100 Interface: 0 Number of Relays = 4 QAAMZ_1=0 QAAMZ_2=0 QAAMZ_3=0 QAAMZ_4=0 This for example is a 4 channel board, and the names associated with each channel are**QAAMZ_1-QAAMZ_4**. To change the status of a channel, all you have to do is issue a command like usbrelay QAAMZ_2=1 . That command will turn second channel ON. To turn it off, you type usbrelay QAAMZ_2=0 . To turn multiple channels on/off, you just list them, space separated, after**usbrelay**like this usbrelay QAAMZ_1=1 QAAMZ_2=0 QAAMZ_4=1 In this example channels 1 and 4 are turned on and channel 2 is turned off. Now that you know how to control the relays from the command prompt, you can incorporate them in your Custom Menu . The following example creates a custom menu for 2 options on the relays, one that switches 1 channel on/off and one that switches 3 channels at the same time on/off. {\"id\":1200,\"text\":\"This is just an example of using Relays with Tinkla Buddy. You have to run usbrealy from the prompt to identify the names of each relay first, then can configure and name your options.\", \"options\":[ {\"label\":\"HDMI\",\"type\":\"menu\",\"value\":\"1201\"}, {\"label\":\"Line\",\"type\":\"menu\",\"value\":\"1202\"} ] }, {\"id\":1201,\"text\":\"HDMI Input Using Rear View Camera\", \"options\":[ {\"label\":\"On\",\"type\":\"shell\",\"value\":\"/usr/bin/usbrelay QAAMZ_1=1\"}, {\"label\":\"Off\",\"type\":\"shell\",\"value\":\"/usr/bin/usbrelay QAAMZ_1=0\"} ] }, {\"id\":1202,\"text\":\"Line In Switch\", \"options\":[ {\"label\":\"Aux\",\"type\":\"shell\",\"value\":\"/usr/bin/usbrelay QAAMZ_2=1 QAAMZ_3=1 QAAMZ_4=1\"}, {\"label\":\"Tesla\",\"type\":\"shell\",\"value\":\"/usr/bin/usbrelay QAAMZ_2=0 QAAMZ_3=0 QAAMZ_4=0\"} ] } References","title":"Configuration"},{"location":"Tinkla_Buddy_Configuration/#registering-your-tinkla-buddy","text":"In order for your Tinkla Buddy to operate, it needs certificates which are given by the Tinkla server to those that registered their product. When you register your device you receive a free 14 day trial period. During this time your Tinkla Buddy has full functionality. Expand section for details. 30 days prior to your the expiration of your license or trial period, you have the option to purchase or renew the yearly subscription using the built in Pay Pal connection. Once your trial or license period expires, all functionality on the Tinkla Buddy is removed until you purchase / renew your license. To register your Tinkla Buddy first you need to create an account ontinkla.us AND confirm your email. Once you have yourtinkla.usaccount setup, you can register your Tinkla Buddy using the Tinkla Buddy Adminportal. Once you have verified your credentials, you will be required to enter your personal information as well as select your email notification preferences. These settings can be later changed from the**Account**menu, by selecting**User Preferences** Now it is time to finally register your Tinkla Buddy. You will need to know the VIN of the car you are installing the Tinkla Buddy on. From the main menu select**Tinkla Buddy**and then**Register**. Enter your VIN and a nickname for your car. The nickname can be later changed by clicking on it in the details page for your Tinkla Buddy. The VIN can not be changed, so please double check it before creating the record.Then click the**Save**button. You will notice that for now your Tinkla Buddy record has no data. The**Buddy Software**,**Tesla Software**fields will be empty and the**Last Signal**and**Cert Update**fields will show dates in the past. Do not worry, they will get updated the moment your Tinkla Buddy gets its certs for the first time. It is now time to power up your Tinkla Buddy for the first time .","title":"Registering your Tinkla Buddy"},{"location":"Tinkla_Buddy_Configuration/#using-the-tinkla-buddy-admin-portal","text":"Do you need to see data from your Tesla? Do you need to look at the Tesla Vitals? Do you want to remotely**ssh**into your Tinkla Buddy? Do you need to give somebody that is helping you remote access ( ssh ) to your Tinkla Buddy? Do you need to purchase/renew your Tinkla Buddy software license? You can do all of the above plus much more from the Tinkla Buddy Admin. Expand section for details.","title":"Using the Tinkla Buddy Admin portal"},{"location":"Tinkla_Buddy_Configuration/#using-the-tinkla-menu","text":"The Tinkla Menu has various basic configuration settings you can activate. You can activate the menu with either four presses on the Wheel's Menu button or (if you're parked) four presses on the Parking Brake. Expand section for details. If you plan to use email to send screenshots, please make sure you setup your email address correctly in /home/pi/.tinkla/email_settings. Please allow at least 20 seconds between requests to allow the command to complete. CID screen shot only works if you have persistence enabled. Tinkla - Buddy - Restart - Restarts Tinkla Buddy's processes. Reboot - Reboots Tinkla Buddy, entirely. ( Not recommend ) Update - Checks for a Tinkla Buddy update. Quiet - Puts the device in a quiet mode for Service Center visits. Wifi - Info - This shows the current Wireless Access Point name and password to join the network and use your car's 3g or LTE internet. IC Int. - Here you can Turn Integration**On**or**Off**- IC integration allows Open Pilot to appear on the Instrument Cluster similar to Tesla Auto Pilot. It also shows data from your Baolong TPMS as if you have a Conti TPMS retrofit. **Please note:**it can take up to a minute for your IC to restart the processes in integration mode and it will flicker twice during the process. The IC isn't rebooted, just restarting processes. Tunnels - Here you can turn Tunnels**On**or**Off**- Turning tunnels on allows you to use the Tinkla Bastillion server to SSH into your Tinkla Buddy and it enables the remote control app (in development) Tesla - Tokens - If you are a security researcher and have access to your car's systems, you'll be able to see it here. Ludi - Temps - This option adds a temperature gauge to the bottom left third of the power graph when using IC Int. On - This option adds the temperature gauge from above, shows a wireframe of your car exposing front and rear motors, and adds a power value and peak usage graph to the left side of your IC. Off - Disables all of the Ludi additions. Misc - VLow - Sets air suspension very low (your car must be parked to enable). IC SS - This will take a screenshot of your IC and email it to you. (You'll need to SSH into Tinkla Buddy to configure /home/pi/.tinkla/email_settings ) CID SS - This will take a screenshot of your Central Infotainment Display [CID] and email it to you. (You'll need to SSH into Tinkla Buddy to configure /home/pi/.tinkla/email_settings ). CID screen shot only works if you have persistence enabled! Advanced - Dev - This will enable you to access Dev Mode. Fact - This will enable you to enter Factory Mode. Unlock -This will unlock the Diagnostic Port. Kill - This will kill any staged software updates. Info - ... Custom - This set of menus are for your use to add/run your own menu scripts to run from the Tinkla Buddy and show the results on your CID. All additions and changes will need to be added to your Tinkla Buddy via SSH to /home/pi/.tinkla/your_commands.json","title":"Using the Tinkla Menu"},{"location":"Tinkla_Buddy_Configuration/#using-the-tinkla-buddy-webapp","text":"Tinkla Buddy Webapp is a web based application hosted on your Tinkla Buddy. It allows you to do more configurations on your Tinkla Buddy that can not be achieved through the Tinkla Menu, such as setting up token persistence, changing your Wi Fi access point password, etc. Expand section for details. Setup Wi Fi for access to Tinkla Buddy App. First activate the TB on your CID using either the wheel menu button or (if parked) parking button four times. Select**Tinkla**. Then select**Wi Fi**. Then select**On**, to turn on the Wi Fi SSID. On your Cell phone look for the SSID tinkla AP , the Wi Fi password is tesla Fr33 Select the SSID and it will assign an IP (it may tell you there is no internet). The next thing to do is go to your favorite browser on the phone, and enter the following URL http://10.5.5.1 You will be presented with the log in screen. The first time password is 1234 Then of course hit Login Now you can start exploring.","title":"Using the Tinkla Buddy Webapp"},{"location":"Tinkla_Buddy_Configuration/#customize-tinkla-menu","text":"If you want to add new options to your Tinkla Menu, this is the place to learn how to. You can add commands that run scripts, turn features on or change car configuration with one press of a button. Expand section for details. In the /home/pi/.tinkla folder there is a file called your_commands.json Where the custom menu items should be added. There are already examples in the file you can follow. For long command sequences it is best to create a script in /home/pi/.tinkla and just call the script with something like /bin/bash /home/pi/.tinkla/my_script.sh from the your_commands.json . {\"menu\":[ {\"id\":1000,\"text\":\"The file that generates this section is /home/pi/.tinkla/your_commands.json. The base menu for it has ID 1000 and we suggest to keep all the other submenus you might create with unique IDs above 1000. Look at the file for suggestions how to create custom commands. \",\"options\":[ {\"label\":\"Menu\",\"type\":\"menu\",\"value\":\"1001\"}, #this will open the menu defined as id:1001 {\"label\":\"Reboot TB\",\"type\":\"shell\",\"value\":\"reboot\"}, #this sends \"reboot\" as a command. {\"label\":\"Some Script\",\"type\":\"shell\",\"value\":\"/bin/bash /home/pi/.tinkla/my_script.sh\"} #no comma after the last option. ]}, {\"id\":1001,\"text\":\"This is just an example of a submenu. Here I just defined 1 button. The Back button is added automatically to any Menu.\",\"options\":[ {\"label\":\"Main Menu\",\"type\":\"menu\",\"value\":\"1\"} ]} ]} To run a script on the CID, and as long as you have persistence enabled, then you can include these commands inside my_script.sh to have some thing run on the CID: scp CID_script.sh cid:/tmp/CID_script.sh ssh cid bash /tmp/CID_script.sh ssh cid rm /tmp/CID_script.sh","title":"Customize Tinkla Menu"},{"location":"Tinkla_Buddy_Configuration/#cron-jobs","text":"If you already have root and token persistence setup, then you can have scripts set to run periodically on the CID based on where you place your script.sh . Based on the directory you use, you can have a script run after Reboot (MCU reboot, not Tinkla Buddy), every 1, 5, 15, or 60 minutes. Expand section for details. Scripts within these folders**MUST**have filenames ending in .sh . /opt/tinkla/cron/after Reboot /opt/tinkla/cron/every One Minute /opt/tinkla/cron/every Five Minutes /opt/tinkla/cron/every Fifteenminutes /opt/tinkla/cron/every Hour For those users that have root persistence, I recommend adding a**clean_traces.sh**file to the**/opt/tinkla/cron/every One Minute**folder containing the following code sed -i '/192\\.168\\.90\\.101/d' /var/log/sshd/current sed -i '/key type ssh-dss not/d' /var/log/sshd/current cat /dev/null > /var/log/auth.log echo 'set +o history' > /root/.bashrc cat /dev/null > /root/.bash_history echo 'set +o history' > /home/tesla/.bashrc cat /dev/null > /home/tesla/.bash_history If you have root persistence and want the Auto Pilot screen on CID, create a script called**ap_screen.sh**in the**/opt/tinkla/cron/after Reboot**folder containing this code: edit-settings-conf.pl -a vapi/force Has Autopilot=true edit-settings-conf.pl -a vapi/force Has Drive On Nav=true edit-settings-conf.pl -a vapi/force Has Drive On Nav Maps=true /usr/local/bin/sdv GUI_autopilot Always On true /usr/local/bin/sdv GUI_autosteer On Request true /usr/local/bin/sdv GUI_autosteer Disabled false /usr/local/bin/sdv GUI_acc From Zero true /usr/local/bin/sdv DAS_map Availability true /usr/local/bin/sdv GUI_red Light Stop Sign On Request true /usr/local/bin/sdv GUI_enable Map Stops true /usr/local/bin/sdv GUI_enable Vision Stops true /usr/local/bin/sdv GUI_enable FSDFunctions true /usr/local/bin/sdv GUI_stop And Go true /usr/local/bin/sdv GUI_noa Everywhere true /usr/local/bin/sdv DAS_nav Available true /usr/local/bin/sdv GUI_acc Follow Distance 2 /usr/local/bin/sdv GUI_acc Overtake On Request true /usr/local/bin/sdv GUI_autopilot Control Request 0 /usr/local/bin/sdv FEATURE_das Drive On Nav Enabled true /usr/local/bin/sdv FEATURE_das Drive On Nav Maps Okay true /usr/local/bin/sdv VAPI_backup Camera Calibrated true /usr/local/bin/sdv VAPI_fisheye Camera Calibrated true /usr/local/bin/sdv VAPI_l Pillar Camera Calibrated true /usr/local/bin/sdv VAPI_l Repeater Camera Calibrated true /usr/local/bin/sdv VAPI_main Camera Calibrated true /usr/local/bin/sdv VAPI_narrow Camera Calibrated true /usr/local/bin/sdv VAPI_r Pillar Camera Calibrated true /usr/local/bin/sdv VAPI_r Repeater Camera Calibrated true echo \"1\" > /var/etc/dashw echo \"dashw 1\" >> /var/etc/gateway.cfg echo \"autopilot 1\" >> /var/etc/gateway.cfg stop qtcar-audiod stop qtcar stop qtcar-carserver start qtcar-carserver start qtcar start qtcar-audiod","title":"Cron Jobs"},{"location":"Tinkla_Buddy_Configuration/#controlling-relays","text":"You can control relay banks of 4 or 8 channels easily with your Tinkla Buddy by configuring a custom menu. The channels can be controlled independently or in groups. To control a channel, we use the**usbrelay**application that is already installed on your Tinkla Buddy. When you get a new relays bank, you need to power it up via 12v from the car and also connect it to the Buddy via USB. Once all connections are done, the fun can begin. NOTE: If usbrelay command is not found on your Buddy, please run apt-get update; apt-get -y install usbrelay. Using the remote ssh feature of the website, open a terminal session to your Buddy. From the command prompt, type**usbrelay**and (if everything is connected correctly) you will see something like this usbrelay Device Found type: 16c0 05df path: /dev/hidraw0 serial_number: Manufacturer: www.dcttech.com Product: USBRelay4 Release: 100 Interface: 0 Number of Relays = 4 QAAMZ_1=0 QAAMZ_2=0 QAAMZ_3=0 QAAMZ_4=0 This for example is a 4 channel board, and the names associated with each channel are**QAAMZ_1-QAAMZ_4**. To change the status of a channel, all you have to do is issue a command like usbrelay QAAMZ_2=1 . That command will turn second channel ON. To turn it off, you type usbrelay QAAMZ_2=0 . To turn multiple channels on/off, you just list them, space separated, after**usbrelay**like this usbrelay QAAMZ_1=1 QAAMZ_2=0 QAAMZ_4=1 In this example channels 1 and 4 are turned on and channel 2 is turned off. Now that you know how to control the relays from the command prompt, you can incorporate them in your Custom Menu . The following example creates a custom menu for 2 options on the relays, one that switches 1 channel on/off and one that switches 3 channels at the same time on/off. {\"id\":1200,\"text\":\"This is just an example of using Relays with Tinkla Buddy. You have to run usbrealy from the prompt to identify the names of each relay first, then can configure and name your options.\", \"options\":[ {\"label\":\"HDMI\",\"type\":\"menu\",\"value\":\"1201\"}, {\"label\":\"Line\",\"type\":\"menu\",\"value\":\"1202\"} ] }, {\"id\":1201,\"text\":\"HDMI Input Using Rear View Camera\", \"options\":[ {\"label\":\"On\",\"type\":\"shell\",\"value\":\"/usr/bin/usbrelay QAAMZ_1=1\"}, {\"label\":\"Off\",\"type\":\"shell\",\"value\":\"/usr/bin/usbrelay QAAMZ_1=0\"} ] }, {\"id\":1202,\"text\":\"Line In Switch\", \"options\":[ {\"label\":\"Aux\",\"type\":\"shell\",\"value\":\"/usr/bin/usbrelay QAAMZ_2=1 QAAMZ_3=1 QAAMZ_4=1\"}, {\"label\":\"Tesla\",\"type\":\"shell\",\"value\":\"/usr/bin/usbrelay QAAMZ_2=0 QAAMZ_3=0 QAAMZ_4=0\"} ] } References","title":"Controlling Relays"},{"location":"Tinkla_Buddy_Install_Kit/","text":"What is Tinkla Buddy? Tinkla Buddy Install Kit Installing your Tinkla Buddy Configuring your Tinkla Buddy The Tinkla Buddy Install Kit is comprised of: RK3328 based ECU with dual Gb Ethernet, 1Gb RAM high endurance 32Gb SD card - pre-imaged RJ45 barrel for bypass 2.\u2158 GHz USB Wi Fi adapter Fakra to RJ45 adapters (you will need two 2-3 ft CAT5e/CAT6 cables) USB power cable (use with Tinkla OBD-C adapter) The install kit is available on our store.","title":"Install Kit"},{"location":"Tinkla_Buddy_Installation/","text":"What is Tinkla Buddy? Tinkla Buddy Install Kit Installing your Tinkla Buddy Configuring your Tinkla Buddy Creating the SD card On Windows PCs you can use Win32Disk Imagerto create to burn the image to the SD card for your Tinkla Buddy. On Linux flavors (including Mac OS) you can just use the dd command. dd if=tinkla_buddy.img of=/dev/dse status=progress where**tinkla_buddy.img**is the name of the disk image you downloaded from this site and**/dev/sde**is the device corresponding to your SD card mounted on Linux. Writing the image to the SD card can take 30 minutes. Disk Images Please select the appropriate image for your device. Device Image MD5sum R2S v1.44-R2S (built 11/11/2022) 422678aa480ed25058a7dbcbd623748c R1S H5 v1.44-H5 (built 09/22/2020) 6a4de9389a17438cbf7c198606eaf8d8 R1S H3/R1 H3 v1.44-H3 (built 09/22/2020) f08619695fef1c88584bd23e3dcd8bc8 **Note:**the image file is very large (650+ Mb compressed) and will take some time to download. Also, depending on the speed of your SD card, it may take a long time to burn. Physical Buddy Installation The hardest part of installing a Tinkla Buddy is finding an always-on power source. The three most viable options are (a) if you have a Tesla with the Cold Weather package there is a fuse box near the accelerator which makes this a 30 minute install, (b) if you have a fuse box behind the passenger kick panel (2016 and later) and you'll need to re-crimp your 12v red wire for an hour install, or \u00a9 if you don't have a fuse box in the cabin pull a wire through a gasket on the firewall behind the washer fluid reservoir in the Frunk which can take 1-2 hours. Instrument Cluster Connections After you have removed the Instrument Cluster (IC) , and you can access the Fakra cable on the back, you connect your LAN Fakra-RJ45 cable directly on to the back of the IC and then use the WAN Fakra-RJ45 cable and connect it to the cable that was previously connected to the IC. Remember you will have two use two CAT5e/CAT6 cables to connect the included Fakra-RJ45 adapters to the Tinkla Buddy. I recommend getting some 2ft or 3ft ones from your local store. Note: The fakra connector is coming straight out. Get a flat head and push on the tab. In my case it was taped tightly to the loom bringing power in, so there was no fear of it falling into the dash. If that does happen to you, you can get to it by going under the steering wheel (see pics below for reference). Plug your new cable into the IC and then plug the other into the car\u2019s cable (only one right way to plug them). Route the cables back in the hole behind the IC where the original network cable came from. Push the IC back into place on its alignment pegs. You\u2019ll want to get both cables over to the left \u201chatch\u201d on the left of the dash; that\u2019s a good place to put the Buddy. In my case I just stuck it next to the pedal so running power was easy. Here is a diagram of the end result: While the Dash is already open, this is a good time to run power for your Tinkla Buddy . Power Tinkla Buddy requires constant 5V/2A to operate. If you have a Tinkla OBD-C Adapter for pre AP Tesla Model S, you can use the specially designed USB-A port to power the Tinkla Buddy. If you do not have an Tinkla OBD-C adapter, you will have to install a power adapter for your Buddy to convert 12V power to 5V power like this one. If you do NOT have a Tinkla OBD-C Adapter , you will have to find a way to power your Tinkla Buddy from another source using a 12V to 5V power adapter like this one . Based on your Tesla Model and included packages, you'll want to follow the corresponding installation guide for Power. We'll need a 12v constant power supply. Places like the USB outlets or 12v accessory outlet are not good because those switch off when the car is \"off\". If you have an AP1 car or have completed the full AP1 retrofit**and**you aren't using it for Open Pilot power, you can just use the empty OBD port or tap the power line that goes to the OBD port behind it for a permanent install. There are different power options for accessories depending on the year your Tesla was built and the packages you have installed. Once you identify the fuse you will tap, remove the original fuse and, using a voltmeter, identify the side of the fuse socket that has the permanent 12V. This is important to know because otherwise you will end up running the circuit through two fuses and create issues. The side**without**the wire of your fuse tap should go where the 12V constant power was identified. Place the original fuse in the lower fuse socket and use the new fuse for the TB power circuit in the upper socket. See diagram below. Once you're done running power we can move on to powering up the Tinkla Buddy for the first time . Powering up the Tinkla Buddy for the first time Before you're ready to power the Buddy: Make sure you have the RJ-45 barrel on the network cables, Make sure the IC and CID are online, Make sure the Tesla is ON. (Press and hold the Brake until you hear/feel the car turn on.) If you have not done it yet, now it's the time to Register your Tinkla Buddy . It will not receive certificates from the server otherwise and thus it will not work. Then while the Buddy is unplugged from power, remove the RJ-45 barrel and insert the RJ-45 cables into the correct jack on the Buddy. The CID goes in the WAN port The IC goes in the LAN port. The SD card with the latest disk image should be inserted into the Tinkla Buddy BEFORE power is connected to the Buddy. Now you can plug power into the Tinkla Buddy. At this point the Buddy will reboot 3-4 times, and then attempt to receive the certs from the Tinkla Buddy server. This takes about 4-5 minutes. Image inflation can take a good deal longer. Walk away from your car and give the Buddy about 20 minutes to finish initializing. When you return you should see two flashing green LEDs on the Tinkla Buddy and one red flashing LED. Install Complete To get IC Auto Pilot integration view, update your Open Pilot Configuration File to look like: enable_das_emulation = True then when the car is \"On\" showing PRND, the IC will do a soft restart and change to the Auto Pilot view. To see if it is working you have two ways to activate the Tinkla Menu: Press steering wheel menu button 4 times, if this does not work, then go to step 2. Press park button 4 times fast. Forcing an update With the changes Tesla make to their software, there might be times when you need to manually force a software update on the Buddy. Such a situation happneed if your car was updated to 2022.8.10.8 but your buddy was still running v1.44 at that time. In order to update to the latest version, you will have to manually ssh into the Buddy and run a few commands. Force SSH into the Tinkla Buddy To force ssh into the Tinkla Buddy (either tunnels are not up because of some fault in the configuration or a certain Tesla software update rendered your code absolete) you will need a laptop that has ssh capabilities and a few configuration options all listed below. Disconnect the LAN cable from the Buddy (the one that connects the IC to the Buddy) and use the LAN port on the Buddy and an ethernet cable to connect your laptop to that port. Manually set the IP address on your laptop to match the IP address of the IC (192.168.90.101 with a net mask of 255.255.255.0) Once the IP is set, ssh into the Tinkla Buddy using the following command ssh pi@192.168.90.69 and use***pi***as the password, unless you changed it, then use the new password you set. Force Upgrade command sequence sudo su cd /opt/tinkla-updater curl --fail -s \"https://tinkla.us/buddy/cksftupd.php?v=1&sv=1.44&c=active&h=H5\" -o ./update.sh bash update.sh reboot","title":"Installation"},{"location":"Tinkla_Buddy_Installation/#creating-the-sd-card","text":"On Windows PCs you can use Win32Disk Imagerto create to burn the image to the SD card for your Tinkla Buddy. On Linux flavors (including Mac OS) you can just use the dd command. dd if=tinkla_buddy.img of=/dev/dse status=progress where**tinkla_buddy.img**is the name of the disk image you downloaded from this site and**/dev/sde**is the device corresponding to your SD card mounted on Linux. Writing the image to the SD card can take 30 minutes.","title":"Creating the SD card"},{"location":"Tinkla_Buddy_Installation/#disk-images","text":"Please select the appropriate image for your device. Device Image MD5sum R2S v1.44-R2S (built 11/11/2022) 422678aa480ed25058a7dbcbd623748c R1S H5 v1.44-H5 (built 09/22/2020) 6a4de9389a17438cbf7c198606eaf8d8 R1S H3/R1 H3 v1.44-H3 (built 09/22/2020) f08619695fef1c88584bd23e3dcd8bc8 **Note:**the image file is very large (650+ Mb compressed) and will take some time to download. Also, depending on the speed of your SD card, it may take a long time to burn.","title":"Disk Images"},{"location":"Tinkla_Buddy_Installation/#physical-buddy-installation","text":"The hardest part of installing a Tinkla Buddy is finding an always-on power source. The three most viable options are (a) if you have a Tesla with the Cold Weather package there is a fuse box near the accelerator which makes this a 30 minute install, (b) if you have a fuse box behind the passenger kick panel (2016 and later) and you'll need to re-crimp your 12v red wire for an hour install, or \u00a9 if you don't have a fuse box in the cabin pull a wire through a gasket on the firewall behind the washer fluid reservoir in the Frunk which can take 1-2 hours.","title":"Physical Buddy Installation"},{"location":"Tinkla_Buddy_Installation/#instrument-cluster-connections","text":"After you have removed the Instrument Cluster (IC) , and you can access the Fakra cable on the back, you connect your LAN Fakra-RJ45 cable directly on to the back of the IC and then use the WAN Fakra-RJ45 cable and connect it to the cable that was previously connected to the IC. Remember you will have two use two CAT5e/CAT6 cables to connect the included Fakra-RJ45 adapters to the Tinkla Buddy. I recommend getting some 2ft or 3ft ones from your local store. Note: The fakra connector is coming straight out. Get a flat head and push on the tab. In my case it was taped tightly to the loom bringing power in, so there was no fear of it falling into the dash. If that does happen to you, you can get to it by going under the steering wheel (see pics below for reference). Plug your new cable into the IC and then plug the other into the car\u2019s cable (only one right way to plug them). Route the cables back in the hole behind the IC where the original network cable came from. Push the IC back into place on its alignment pegs. You\u2019ll want to get both cables over to the left \u201chatch\u201d on the left of the dash; that\u2019s a good place to put the Buddy. In my case I just stuck it next to the pedal so running power was easy. Here is a diagram of the end result: While the Dash is already open, this is a good time to run power for your Tinkla Buddy .","title":"Instrument Cluster Connections"},{"location":"Tinkla_Buddy_Installation/#power","text":"Tinkla Buddy requires constant 5V/2A to operate. If you have a Tinkla OBD-C Adapter for pre AP Tesla Model S, you can use the specially designed USB-A port to power the Tinkla Buddy. If you do not have an Tinkla OBD-C adapter, you will have to install a power adapter for your Buddy to convert 12V power to 5V power like this one. If you do NOT have a Tinkla OBD-C Adapter , you will have to find a way to power your Tinkla Buddy from another source using a 12V to 5V power adapter like this one . Based on your Tesla Model and included packages, you'll want to follow the corresponding installation guide for Power. We'll need a 12v constant power supply. Places like the USB outlets or 12v accessory outlet are not good because those switch off when the car is \"off\". If you have an AP1 car or have completed the full AP1 retrofit**and**you aren't using it for Open Pilot power, you can just use the empty OBD port or tap the power line that goes to the OBD port behind it for a permanent install. There are different power options for accessories depending on the year your Tesla was built and the packages you have installed. Once you identify the fuse you will tap, remove the original fuse and, using a voltmeter, identify the side of the fuse socket that has the permanent 12V. This is important to know because otherwise you will end up running the circuit through two fuses and create issues. The side**without**the wire of your fuse tap should go where the 12V constant power was identified. Place the original fuse in the lower fuse socket and use the new fuse for the TB power circuit in the upper socket. See diagram below. Once you're done running power we can move on to powering up the Tinkla Buddy for the first time .","title":"Power"},{"location":"Tinkla_Buddy_Installation/#powering-up-the-tinkla-buddy-for-the-first-time","text":"Before you're ready to power the Buddy: Make sure you have the RJ-45 barrel on the network cables, Make sure the IC and CID are online, Make sure the Tesla is ON. (Press and hold the Brake until you hear/feel the car turn on.) If you have not done it yet, now it's the time to Register your Tinkla Buddy . It will not receive certificates from the server otherwise and thus it will not work. Then while the Buddy is unplugged from power, remove the RJ-45 barrel and insert the RJ-45 cables into the correct jack on the Buddy. The CID goes in the WAN port The IC goes in the LAN port. The SD card with the latest disk image should be inserted into the Tinkla Buddy BEFORE power is connected to the Buddy. Now you can plug power into the Tinkla Buddy. At this point the Buddy will reboot 3-4 times, and then attempt to receive the certs from the Tinkla Buddy server. This takes about 4-5 minutes. Image inflation can take a good deal longer. Walk away from your car and give the Buddy about 20 minutes to finish initializing. When you return you should see two flashing green LEDs on the Tinkla Buddy and one red flashing LED.","title":"Powering up the Tinkla Buddy for the first time"},{"location":"Tinkla_Buddy_Installation/#install-complete","text":"To get IC Auto Pilot integration view, update your Open Pilot Configuration File to look like: enable_das_emulation = True then when the car is \"On\" showing PRND, the IC will do a soft restart and change to the Auto Pilot view. To see if it is working you have two ways to activate the Tinkla Menu: Press steering wheel menu button 4 times, if this does not work, then go to step 2. Press park button 4 times fast.","title":"Install Complete"},{"location":"Tinkla_Buddy_Installation/#forcing-an-update","text":"With the changes Tesla make to their software, there might be times when you need to manually force a software update on the Buddy. Such a situation happneed if your car was updated to 2022.8.10.8 but your buddy was still running v1.44 at that time. In order to update to the latest version, you will have to manually ssh into the Buddy and run a few commands.","title":"Forcing an update"},{"location":"Tinkla_Buddy_Installation/#force-ssh-into-the-tinkla-buddy","text":"To force ssh into the Tinkla Buddy (either tunnels are not up because of some fault in the configuration or a certain Tesla software update rendered your code absolete) you will need a laptop that has ssh capabilities and a few configuration options all listed below. Disconnect the LAN cable from the Buddy (the one that connects the IC to the Buddy) and use the LAN port on the Buddy and an ethernet cable to connect your laptop to that port. Manually set the IP address on your laptop to match the IP address of the IC (192.168.90.101 with a net mask of 255.255.255.0) Once the IP is set, ssh into the Tinkla Buddy using the following command ssh pi@192.168.90.69 and use***pi***as the password, unless you changed it, then use the new password you set.","title":"Force SSH into the Tinkla Buddy"},{"location":"Tinkla_Buddy_Installation/#force-upgrade-command-sequence","text":"sudo su cd /opt/tinkla-updater curl --fail -s \"https://tinkla.us/buddy/cksftupd.php?v=1&sv=1.44&c=active&h=H5\" -o ./update.sh bash update.sh reboot","title":"Force Upgrade command sequence"},{"location":"Tinkla_General_disclaimer/","text":"Modifying your car can possibly result in damage, in jury and even death. Do not modify your car unless you understand and accept those risks. You alone are ultimately responsible, not the creator of this site, Comma.ai, Comma.ai community, Tesla, or anyone else. Licensing openpilot is released under the MIT license. Some parts of the software are released under other licenses as specified. Any user of this software shall indemnify and hold harmless Comma.ai, Inc. and its directors, officers, employees, agents, stockholders, affiliates, subcontractors and customers from and against all allegations, claims, actions, suits, demands, damages, liabilities, obligations, losses, settlements, judgments, costs and expenses (including without limitation attorneys\u2019 fees and costs) which arise out of, relate to or result from any use of this software by user. THIS IS ALPHA QUALITY SOFTWARE FOR RESEARCH PURPOSES ONLY. THIS IS NOT A PRODUCT. YOU ARE RESPONSIBLE FOR COMPLYING WITH LOCAL LAWS AND REGULATIONS. NO WARRANTY EXPRESSED OR IMPLIED.","title":"Disclaimer & License"},{"location":"Tinkla_General_disclaimer/#licensing","text":"openpilot is released under the MIT license. Some parts of the software are released under other licenses as specified. Any user of this software shall indemnify and hold harmless Comma.ai, Inc. and its directors, officers, employees, agents, stockholders, affiliates, subcontractors and customers from and against all allegations, claims, actions, suits, demands, damages, liabilities, obligations, losses, settlements, judgments, costs and expenses (including without limitation attorneys\u2019 fees and costs) which arise out of, relate to or result from any use of this software by user. THIS IS ALPHA QUALITY SOFTWARE FOR RESEARCH PURPOSES ONLY. THIS IS NOT A PRODUCT. YOU ARE RESPONSIBLE FOR COMPLYING WITH LOCAL LAWS AND REGULATIONS. NO WARRANTY EXPRESSED OR IMPLIED.","title":"Licensing"},{"location":"Tinkla_OBD-C_Adapter/","text":"Tinkla OBD-C Adapter What it does The Tinkla OBD-C Adapterwhich can be purchased from our online store replaces the previous harness that was needed in the early iterations of Open Pilot for pre AP Tesla Model S. Designed specifically to work with the latest versions of Tesla Unity and Comma two/Comma three dev kits (as well as EON Gold with Black Panda), this little device plugs into your OBD2 port and creates the needed interface between the Comma devkit and your car. It also have additional ports to allow to connect a Pedal Interceptor or to power your Tinkla Buddy . Inside the device there are 3 more expansion ports that allow you to hook up additional equipment, such as a Tesla Bosch Radar . Tinkla OBD-C Adapter Schematics Connections OBD2 Connector : this connector plugs directly into your pre AP Tesla Model S OBD2 port located in the driver's footwell. OBD-C Port : this port allows you to connect your Comma devkit to the Tinkla OBD-C Adapter using a Thunderbolt3 cable. This offers +12v, ground and access to 3 CAN buses for the Comma devkit. Do not plug anything else in this port as it will most likely fry the equipment. This is NOT a standard USB-C port! RJ45 for Pedal Interceptor : This port allows you to connect your Pedal Interceptor to the harness using a standard RJ45 Ethernet cable. Do not plug anything else in this port as it will most likely fry the equipment. This is NOT a standard RJ45 port! USB A Port : This port allows you to power your Tinkla Buddy directly from the Tinkla OBD-C Adapter. It offers 5V/2A power on standard USB power pins. JST2.5 connector for CAN0 : This connector allows you to connect other equipment to the chassis can. JST2.5 connector for CAN1 : This connector allows you to connect a Tesla Bosch Radar . It already has an 120 ohm resistor to terminate the CAN connection. JST2.5 connector for CAN2 : This connector allows you to connect a Pedal Interceptor (if yours does not have the RJ45 connector) or other equipment to CAN2. It has a built in 60ohm terminator for the CAN connection.","title":"OBD-C Adapter"},{"location":"Tinkla_OBD-C_Adapter/#what-it-does","text":"The Tinkla OBD-C Adapterwhich can be purchased from our online store replaces the previous harness that was needed in the early iterations of Open Pilot for pre AP Tesla Model S. Designed specifically to work with the latest versions of Tesla Unity and Comma two/Comma three dev kits (as well as EON Gold with Black Panda), this little device plugs into your OBD2 port and creates the needed interface between the Comma devkit and your car. It also have additional ports to allow to connect a Pedal Interceptor or to power your Tinkla Buddy . Inside the device there are 3 more expansion ports that allow you to hook up additional equipment, such as a Tesla Bosch Radar . Tinkla OBD-C Adapter Schematics","title":"What it does"},{"location":"Tinkla_OBD-C_Adapter/#connections","text":"OBD2 Connector : this connector plugs directly into your pre AP Tesla Model S OBD2 port located in the driver's footwell. OBD-C Port : this port allows you to connect your Comma devkit to the Tinkla OBD-C Adapter using a Thunderbolt3 cable. This offers +12v, ground and access to 3 CAN buses for the Comma devkit. Do not plug anything else in this port as it will most likely fry the equipment. This is NOT a standard USB-C port! RJ45 for Pedal Interceptor : This port allows you to connect your Pedal Interceptor to the harness using a standard RJ45 Ethernet cable. Do not plug anything else in this port as it will most likely fry the equipment. This is NOT a standard RJ45 port! USB A Port : This port allows you to power your Tinkla Buddy directly from the Tinkla OBD-C Adapter. It offers 5V/2A power on standard USB power pins. JST2.5 connector for CAN0 : This connector allows you to connect other equipment to the chassis can. JST2.5 connector for CAN1 : This connector allows you to connect a Tesla Bosch Radar . It already has an 120 ohm resistor to terminate the CAN connection. JST2.5 connector for CAN2 : This connector allows you to connect a Pedal Interceptor (if yours does not have the RJ45 connector) or other equipment to CAN2. It has a built in 60ohm terminator for the CAN connection.","title":"Connections"},{"location":"Tinkla_Relay/","text":"Do you like Tinkering with your Tesla? Do you like adding additional features to it without having to install old style switches to control them? Do you want to control additional lights or devices based on specific conditions of the car (charging, driving, turning left/right, gear forward/reverse, high beams on, blind spot monitoring signals, or specific button presses on the steering wheel)? Then Tinkla Relay is a must have Swiss Army Knife for Tesla Model S/X/3/Y integrations. Are you annoyed when Auto Pilot disengages because you just slightly corrected the direction due to a moron cutting into your line, or avoiding a pothole? You can enabled the Auto Resume Auto Pilot functionality and Tinkla Relay will do it for you. Do you wish your Auto Pilot (non FSD) would adjust the max speed up and down with the recognized speed limit? With Tinkla Relay it does. For Model 3/Y users it even recognizes the % offset configured in the Auto Pilot tab and takes that into consideration. Do you find yourself sometimes stuck in CHILL mode and need that extra power, but takes too long to go though the settings? If your Model 3/Y is equipped with Tinkla Relay, you will be able to floor the pedal and gain advantage of all the k Ws availble in your car. While the accelerator pedal is pressed more than 92% down, Tinkla Relay will automatically suspend the CHILL mode and give you full power. Read below for more info. Tinkla Relay is a device that connects to your Tesla power and CAN and has 4 output relays that are turned on/off based on your settings configured via DIP switches. The maximum output for the relays is 12V and up to 3A total between all on channels at a time. This is enough to drive GPIO signals, trigger relays for larger consumers or turn on notification LEDs. Talk: Feedback? Ideas? Comments? What is in the box The Tinkla Relay board Harness specific for you Tesla 3A mini fuse Automotive grade hook and loop tape Installing the Tinkla Relay Please ensure you install the 5A fuse into the Tinkla Relay before moving with the install. Model S & Model X Tinkla Relay can be either installed using the provided harness directly into the OBD2 port or hardwired directly into the car power and CAN lines. To connect directly to Tinkla Relay you need a Molex 34791-0080 connector with the following wiring: Tinkla Relay Wiring Pin 1 2 3 4 5 6 7 8 Model 3 and Model Y Tinkla Relay can be installed in less than 15 minutes by simply removing the 4 pins that hold the cover of the passenger footwell in your Model 3/Y and adding the provided harness between the car and the MCU computer. Auto Pilot Extended Functionality By enabling the Auto Pilot Extended Functionality of Tinkla Relay, you will gain access to some enhancements to your standard or EAP Autopilot. Auto Pilot Auto Resume You do not have to tap the stalk to re-engage Auto Pilot after a slight steering correction, provided that the adaptive cruise-control is still engaged. Here is how it works: When autopilot is disengaged due to a steering correction, the system will start the auto-engage process in the background- It will wait for turn signals to be off It will wait for Auto Pilot to become available (gray steering icon) It will monitor that adaptive cruise control is still engaged It will monitor that you are not actively steering (via the hands on wheel detection) Once all the conditions have been met, it will start a 1 second timer to ensure that nothing else happens, and it no other events, it will re-engage Auto Pilot You can cancel the re-engage process at any time by a simple stalk pull or by hitting the brake pedal or canceling the adaptive cruise control via the stalk. Auto Pilot Auto Adjust Max Speed Limit Driving on the highway (or on small roads, doesn't matter), and the speed limit changed, but you missed it, and then lucky you, there is a cop waiting 100 yards beyond the speed sign, ready to hand you that bill... That does not have to happen if you have Tinkla Relay installed. Tinkla Relay monitors the speed limit changes that Auto Pilot recognizes and immediately adjusts your Max Speed to match. It even takes in consideration your percentage override entered in the settings of a Model 3/Y (not available for S/X at this moment). The Relay just saved your wallet :) If you attempt to manually change the speed limit during an Auto Adjust process, the Auto Adjust will be canceled. CHILL++ Extra power when you need it If you drive in Chill mode most of the time (like I do), you will find yourself at times in situations when you wish you were not: merging in traffic, passing somebody, etc. You know you have twice the power in your car, yet you opted for the chill factor that works 98% of the time. With Tinkla Relay you can have your cake and eat it too: between 0% and 90% of your accelerator pedal press, it will continue to operate in the same manner you have it now in Chill mode. Once you go beyond the 92% mark, you will know it. Tinkla Relay recognizes you want more juice and provides it to your wheels instantly. (You will not see the CHILL text vanish from your dash, but you will feel the extra k Ws) Reading CAN messages By using the old web based version of Cabana by Comma.ai you can view live streaming of CAN messages from your Tesla (Chassis CAN for Model S/X, Vehicle and Chassis CAN for Model 3/Y). To parse the messages you can select the appropriate dbc file (tesla_modelsx.dbc from Model S/X or Josh Wardell's tesla_model3y.dbc for Model 3/Y). Please note that Cabana only works inside Google Chrome. Once you are done reading messages, you will have to make sure you power cycle the Relay to return to normal functionality. The cabana switches the standard functionality of Relay and puts it into a read only mode. The power cycle restored the basic functionality. To power cycle your Relay you have to disconnect both from the harness and from the computer (USB). Flashing Tinkla Relay Firmware Sometimes there is a need to update your Tinkla Relay firmware to take advantage of new code releases. In order to do this, you will need access to a computer with internet access and a Chromium based web browser (Google Chrome, Microsoft Edge, Chromium), and a USB cable to connect from your computer to the micro-USB port on the Tinkla Relay. In order to flash the latest code for Tinkla Relay, go to https://relay.tinkla.us and follow the instructions. Virtual Buttons Tinkla Relay creates up to 4 virtual buttons in order to control the relay outputs. These virtual buttons are combinations of quick double presses on existing steering wheel controls. Depending on the configuration selected via the DIP Switches , these virtual buttons can act alone or in combination with other logic based on car state. In the table below we show the connection between a virtual button and the corresponding steering wheel button. In order to switch the state of the relay for that corresponding button, the user will have to double-press that particular steering wheel button quickly with no more than 0.75 s between presses. Tinkla Relay Virtual Buttons Virtual Button Name Button 1 Button 2 Button 3 Button 4 DIP Switches Switches 1-4 allows you to select one of the pre-configured logic that triggers the 4 relays to turn on or off. Switch 5 is an overall setting for all 4 relays and, if on, will keep the relays in their state even when car is off. If Switch 6 is off then all relays will be turned off when the car is off. Switch 6 enables Tesla Auto Pilot Extended Functionality. Please see more info above. Switches 7 and 8 are for future use and should be always kept in the OFF position to avoid device malfunction. Tinkla Relay Configurations DIP Switches Sw1 OFF ON OFF ON OFF ON OFF ON OFF ON OFF ON OFF ON OFF ON (*) Requires the 12 sensor park assist option (6 front, 6 back) that was available from Tesla after October 2014. If you see use for a different configuration and logic, please do not hesitate to reach out to me on Discord. If the setup has merit and can be used by others as well, i can add it to the code. How to order Tinkla Relay Tinkla Relay is available to purchase in our online store .","title":"Tinkla Relay"},{"location":"Tinkla_Relay/#what-is-in-the-box","text":"The Tinkla Relay board Harness specific for you Tesla 3A mini fuse Automotive grade hook and loop tape","title":"What is in the box"},{"location":"Tinkla_Relay/#installing-the-tinkla-relay","text":"Please ensure you install the 5A fuse into the Tinkla Relay before moving with the install.","title":"Installing the Tinkla Relay"},{"location":"Tinkla_Relay/#model-s-model-x","text":"Tinkla Relay can be either installed using the provided harness directly into the OBD2 port or hardwired directly into the car power and CAN lines. To connect directly to Tinkla Relay you need a Molex 34791-0080 connector with the following wiring: Tinkla Relay Wiring Pin 1 2 3 4 5 6 7 8","title":"Model S &amp; Model X"},{"location":"Tinkla_Relay/#model-3-and-model-y","text":"Tinkla Relay can be installed in less than 15 minutes by simply removing the 4 pins that hold the cover of the passenger footwell in your Model 3/Y and adding the provided harness between the car and the MCU computer.","title":"Model 3 and Model Y"},{"location":"Tinkla_Relay/#auto-pilot-extended-functionality","text":"By enabling the Auto Pilot Extended Functionality of Tinkla Relay, you will gain access to some enhancements to your standard or EAP Autopilot.","title":"Auto Pilot Extended Functionality"},{"location":"Tinkla_Relay/#auto-pilot-auto-resume","text":"You do not have to tap the stalk to re-engage Auto Pilot after a slight steering correction, provided that the adaptive cruise-control is still engaged. Here is how it works: When autopilot is disengaged due to a steering correction, the system will start the auto-engage process in the background- It will wait for turn signals to be off It will wait for Auto Pilot to become available (gray steering icon) It will monitor that adaptive cruise control is still engaged It will monitor that you are not actively steering (via the hands on wheel detection) Once all the conditions have been met, it will start a 1 second timer to ensure that nothing else happens, and it no other events, it will re-engage Auto Pilot You can cancel the re-engage process at any time by a simple stalk pull or by hitting the brake pedal or canceling the adaptive cruise control via the stalk.","title":"Auto Pilot Auto Resume"},{"location":"Tinkla_Relay/#auto-pilot-auto-adjust-max-speed-limit","text":"Driving on the highway (or on small roads, doesn't matter), and the speed limit changed, but you missed it, and then lucky you, there is a cop waiting 100 yards beyond the speed sign, ready to hand you that bill... That does not have to happen if you have Tinkla Relay installed. Tinkla Relay monitors the speed limit changes that Auto Pilot recognizes and immediately adjusts your Max Speed to match. It even takes in consideration your percentage override entered in the settings of a Model 3/Y (not available for S/X at this moment). The Relay just saved your wallet :) If you attempt to manually change the speed limit during an Auto Adjust process, the Auto Adjust will be canceled.","title":"Auto Pilot Auto Adjust Max Speed Limit"},{"location":"Tinkla_Relay/#chill-extra-power-when-you-need-it","text":"If you drive in Chill mode most of the time (like I do), you will find yourself at times in situations when you wish you were not: merging in traffic, passing somebody, etc. You know you have twice the power in your car, yet you opted for the chill factor that works 98% of the time. With Tinkla Relay you can have your cake and eat it too: between 0% and 90% of your accelerator pedal press, it will continue to operate in the same manner you have it now in Chill mode. Once you go beyond the 92% mark, you will know it. Tinkla Relay recognizes you want more juice and provides it to your wheels instantly. (You will not see the CHILL text vanish from your dash, but you will feel the extra k Ws)","title":"CHILL++ Extra power when you need it"},{"location":"Tinkla_Relay/#reading-can-messages","text":"By using the old web based version of Cabana by Comma.ai you can view live streaming of CAN messages from your Tesla (Chassis CAN for Model S/X, Vehicle and Chassis CAN for Model 3/Y). To parse the messages you can select the appropriate dbc file (tesla_modelsx.dbc from Model S/X or Josh Wardell's tesla_model3y.dbc for Model 3/Y). Please note that Cabana only works inside Google Chrome. Once you are done reading messages, you will have to make sure you power cycle the Relay to return to normal functionality. The cabana switches the standard functionality of Relay and puts it into a read only mode. The power cycle restored the basic functionality. To power cycle your Relay you have to disconnect both from the harness and from the computer (USB).","title":"Reading CAN messages"},{"location":"Tinkla_Relay/#flashing-tinkla-relay-firmware","text":"Sometimes there is a need to update your Tinkla Relay firmware to take advantage of new code releases. In order to do this, you will need access to a computer with internet access and a Chromium based web browser (Google Chrome, Microsoft Edge, Chromium), and a USB cable to connect from your computer to the micro-USB port on the Tinkla Relay. In order to flash the latest code for Tinkla Relay, go to https://relay.tinkla.us and follow the instructions.","title":"Flashing Tinkla Relay Firmware"},{"location":"Tinkla_Relay/#virtual-buttons","text":"Tinkla Relay creates up to 4 virtual buttons in order to control the relay outputs. These virtual buttons are combinations of quick double presses on existing steering wheel controls. Depending on the configuration selected via the DIP Switches , these virtual buttons can act alone or in combination with other logic based on car state. In the table below we show the connection between a virtual button and the corresponding steering wheel button. In order to switch the state of the relay for that corresponding button, the user will have to double-press that particular steering wheel button quickly with no more than 0.75 s between presses. Tinkla Relay Virtual Buttons Virtual Button Name Button 1 Button 2 Button 3 Button 4","title":"Virtual Buttons"},{"location":"Tinkla_Relay/#dip-switches","text":"Switches 1-4 allows you to select one of the pre-configured logic that triggers the 4 relays to turn on or off. Switch 5 is an overall setting for all 4 relays and, if on, will keep the relays in their state even when car is off. If Switch 6 is off then all relays will be turned off when the car is off. Switch 6 enables Tesla Auto Pilot Extended Functionality. Please see more info above. Switches 7 and 8 are for future use and should be always kept in the OFF position to avoid device malfunction. Tinkla Relay Configurations DIP Switches Sw1 OFF ON OFF ON OFF ON OFF ON OFF ON OFF ON OFF ON OFF ON (*) Requires the 12 sensor park assist option (6 front, 6 back) that was available from Tesla after October 2014. If you see use for a different configuration and logic, please do not hesitate to reach out to me on Discord. If the setup has merit and can be used by others as well, i can add it to the code.","title":"DIP Switches"},{"location":"Tinkla_Relay/#how-to-order-tinkla-relay","text":"Tinkla Relay is available to purchase in our online store .","title":"How to order Tinkla Relay"},{"location":"Topic_Uzt2jwwsels605dt/","text":"Welcome to Tinkla Talk!","title":"Topic Uzt2jwwsels605dt"},{"location":"User_BogGyver/","text":"Intro I grew up immersed in technology. My mother was a software engineer and my father was an electrical engineer, designing computer hardware. I started writing code when I was 7, using punched cards and Cobol. At age 13, I modified my own Sinclair Computer to run CP/M, allowing me to start developing in C, Fortran and Pascal. 1986 - began the Computer Sciences High School in Bucharest, a program that had 4 x 8-hour days for regular classes and 2 x 8-hour days dedicated to software engineering (Saturdays were not free). 1987 - won the National Software Development Award for high school and college students with my own Fortran 77 compiler for Spectrum computers. 1990 - graduated high school with a GPA of 9.87 out of 10 1990 - passed the entry exam into the Polytechnic University of Bucharest (PUB) with the 11 th out of 250 average exam grade of 9.25 out of 10 1995 - graduated from the Computer Science Engineering School of PUB with a Masters in Software Engineering with a GPA of 9.34 out of 10 1997 \u2013 obtained Master\u2019s Degree in Mathematics from Bryn Mawr College; my thesis covered the topic of Image Compression using Wavelets, including full software development of the compression algorithm. 2000 \u2013 passed preliminary exams for my Ph D and began working on my dissertation: \u201cDynamical Systems in 3 Dimensional Particle Billiards\u201d, which was focusing on particle collision in certain conditions. Been a CIO/CTO/VP of IT in various private and public companies, both small and large since 2000 2007 \u2013 named by Computerworld magazine as one of the \u201cTop 40 Under 40 Innovators in IT space\u201d 2008 \u2013 received Computerworld magazine\u2019s Premier 100 Award given to the top 100 IT executives of the year 2015 \u2013 started my own IT consulting company with clients in the pharmaceuticals, health-care and utilities spaces. 2018 \u2013 started working with advanced driver-assistance systems 2019 \u2013 member of the CANucks team that won first place at the automotive hacking competition during DEFCON Professional Perspectives Comfortable operating with distributed development teams, both in-house and off-shored/outsourced Never afraid to make a decision and be accountable/hold my team accountable; \u201cFail fast, fail cheap, fail forward\u201d is what I live by and instill in my team members Always seen as an innovator Strategy-centric with comprehensive understanding of how that strategy translates to tactical activities for successful execution What do i do in my free time Work on Tesla Open Pilot branch Create and maintain the Tinkla Buddy , keeping it in line with the changes from Tesla Work on the next product, Tinkla Relay (Due October 2020) for the whole S3XY lineup Taking my car frunk and dashboard apart many times to install Open Pilot harness and mods Taking my car completely apart to install the AP1 hardware (complete with i Booster, ESP2, Park sensors, radar, etc) and many other add-ons Gettingcompletely frustrated with the Tesla Service Center","title":"User BogGyver"},{"location":"User_BogGyver/#intro","text":"I grew up immersed in technology. My mother was a software engineer and my father was an electrical engineer, designing computer hardware. I started writing code when I was 7, using punched cards and Cobol. At age 13, I modified my own Sinclair Computer to run CP/M, allowing me to start developing in C, Fortran and Pascal. 1986 - began the Computer Sciences High School in Bucharest, a program that had 4 x 8-hour days for regular classes and 2 x 8-hour days dedicated to software engineering (Saturdays were not free). 1987 - won the National Software Development Award for high school and college students with my own Fortran 77 compiler for Spectrum computers. 1990 - graduated high school with a GPA of 9.87 out of 10 1990 - passed the entry exam into the Polytechnic University of Bucharest (PUB) with the 11 th out of 250 average exam grade of 9.25 out of 10 1995 - graduated from the Computer Science Engineering School of PUB with a Masters in Software Engineering with a GPA of 9.34 out of 10 1997 \u2013 obtained Master\u2019s Degree in Mathematics from Bryn Mawr College; my thesis covered the topic of Image Compression using Wavelets, including full software development of the compression algorithm. 2000 \u2013 passed preliminary exams for my Ph D and began working on my dissertation: \u201cDynamical Systems in 3 Dimensional Particle Billiards\u201d, which was focusing on particle collision in certain conditions. Been a CIO/CTO/VP of IT in various private and public companies, both small and large since 2000 2007 \u2013 named by Computerworld magazine as one of the \u201cTop 40 Under 40 Innovators in IT space\u201d 2008 \u2013 received Computerworld magazine\u2019s Premier 100 Award given to the top 100 IT executives of the year 2015 \u2013 started my own IT consulting company with clients in the pharmaceuticals, health-care and utilities spaces. 2018 \u2013 started working with advanced driver-assistance systems 2019 \u2013 member of the CANucks team that won first place at the automotive hacking competition during DEFCON","title":"Intro"},{"location":"User_BogGyver/#professional-perspectives","text":"Comfortable operating with distributed development teams, both in-house and off-shored/outsourced Never afraid to make a decision and be accountable/hold my team accountable; \u201cFail fast, fail cheap, fail forward\u201d is what I live by and instill in my team members Always seen as an innovator Strategy-centric with comprehensive understanding of how that strategy translates to tactical activities for successful execution","title":"Professional Perspectives"},{"location":"User_BogGyver/#what-do-i-do-in-my-free-time","text":"Work on Tesla Open Pilot branch Create and maintain the Tinkla Buddy , keeping it in line with the changes from Tesla Work on the next product, Tinkla Relay (Due October 2020) for the whole S3XY lineup Taking my car frunk and dashboard apart many times to install Open Pilot harness and mods Taking my car completely apart to install the AP1 hardware (complete with i Booster, ESP2, Park sensors, radar, etc) and many other add-ons Gettingcompletely frustrated with the Tesla Service Center","title":"What do i do in my free time"},{"location":"User_talk_BogGyver/","text":"Hello","title":"User talk BogGyver"},{"location":"Welcome_to_Tinkla_/","text":"If you're looking for instructions for the old versions of Open Pilot that run on EON with white or gray panda, that page is available here . Talk: Feedback? Ideas? Comments? What is Open Pilot Open Pilot is open source software built to improve upon the existing driver assistance in most new cars on the road today. Now Open Pilot is available for pre-autopilot Tesla Model S as well as Tesla Model S/X with autopilot hardware 1 or 2. Currently, openpilot performs the functions of Adaptive Cruise Control (ACC), Automated Lane Centering (ALC), Forward Collision Warning (FCW) and Lane Departure Warning (LDW) for a growing variety of supported car makes, models and model years. In addition, while openpilot is engaged, a camera based Driver Monitoring (DM) feature alerts distracted and asleep drivers. See more about the vehicle integration and limitations. Getting Started Open Pilot for pre AP Tesla Model S Open Pilot for Tesla Model S/X with AP1 Open Pilot for Tesla Model S/X with AP2 Software Design History v0.9.6-61 (2024-01-17) * in line with latest code from Comma * adds support for C3X * adds fixes for \"steering temporary unavailable\" * you can now chose between OP/AP1/ACC on cars with AP: - OP - single stalk pull - AP - double stalk pull - ACC (Tesla stock) - up/down stalk movement * improved IC integration for cars with AP: - when OP/AP now engaged, IC shows AP data - when OP is engaed, IC shows OP data - when AP is engaged, IC shows AP data * option to ignore radar errors (useful in winter time when radar might get dirty) v0.8.13-57 (2022-11-17) * Fix pedal pressed message on ACC * Adjust top speed with speed limit for AP1 * Show set speed in lower right corner for RHD cars * Brake factor speed adjustable (1.1 below 70km/h, 1.4 above 110km/h) v0.8.13-56 (2022-11-08) * Sound files volume fix * Show TACC icon on IC for AP cars when OP is available * Display shutdown * Engage at 0 MPH (AP cars) * Fleet based speed (AP cars) * Slow down in turns based on Sunny Pilot * prevent i Booster from pressing both pedals * Improved acceleration handling for AP1 * Add message ID for the CAN Error * Reduce min accel to -4.5 * Improve follow distance * Better and smoother pedal with 4 profiles * Universal calibration tool for pedal interceptor * i Booster control improvement * Add 5 pedal profiles and 3 acceleration profiles for better long control wiht pedal * Add alert when maximum regen is used with pedal to show braking limit * Prevent PCC engagement with uncalibrated pedals * Cancel automatic lane change on blinker or wheel touch * Toggle to ignore wrong date/time on device * Increase steering angle limits on Panda * Fix Controls Mismatch when taking over steering v0.8.13-55 (2022-09-21) * Sound toggles (to mute certain sounds) * Sound files v0.8.13-54 (2022-09-19) * Add capabilities for Str params * Implement fixed fingerprint option to avoid fingerprinting issues v0.8.13-53 (2022-08-05) * i Booster ECU fixes * Try to fix Controls Mismatch issues * Add toggle for radar error with AP v0.8.13-52 (2022-08-05) * Reset Pedal PID on engagement * Toggle for Model S Performance for pedal (bug fix) * Pedal profile for MS Performance (bug fix) * Toggle to prevent auto updates * Toggle for dev unit (bug fix) * Autoresume speed from stand still v0.8.13-51 (2022-07-05) * new PID for pedal, including way to save state * toggle for Model S Performance for pedal * pedal profile for MS Performance v0.8.13-48 (2022-05-18) * limit i Booster travel to a max of 15mm (90psi on my car) * set Hold values for i Booster to 6.5mm (14psi) * change lane poly calculation logic for IC integrtion v0.8.13-47 (2022-05-11) do not send i Booster brake command when real accelerator pedal is pressed v0.8.13-46 (2022-05-10) do not send i Booster brake command when accelerator pedal is pressed increase brake hold value v0.8.13-45 (2022-05-09) update firmware for Vacuum Sensor board with brake release condition allow 0x553 for i Booster in panda allow 0x555 for IVS in panda v0.8.13-44 (2022-05-04) update firmware for Vacuum Sensor board fix CRC for i Booster v0.8.13-43 (2022-04-21) fix Pedal over CC issues when MCU2 or no Tinkla Buddy add firmware for Vacuum Sensor board fix CRC for i Booster v0.8.13-41 (2022-04-19) fix startup screen for C3 fix modem initialization for C3 (comma three: correctly set initial EPS bearer settings for AT&T sim cards) fix logic for enabling OP on pre AP MS add C3 Tinkla Splash v0.8.13-38 (2022-04-05) toggle to allow move of maps on left always show OP data on IC when engaged (AP1/AP2) Comma three support fix top speed indicator when using pedal with Tinkla Buddy v0.8.13-37 (2022-04-01) added configuration value for Hands On Level before human takeover fixed acceleration for AP1 stop-and-go which was limited at 1.2m/s^2 added testing toggle for full Long Control from planner vs actuator (AP1 or pre AP with i Booster) fixed release scripts fixed automatic flashing of panda code v0.8.13-34 (2022-03-27) full support for OP long control with AP1 follow distance is adjustable from CC stalk (when available) UI shows multiple road lanes when detected by OP fix bug where ACC would show disabled message after brake press even when not enabled variable acceleration based on speed for AP1 OP based long control improve pedal tune (by vandreykiv) fix variables default value not showing correctly in UI v0.8.13-33 (2022-03-26) new events to show when Standard CC is enabled added shutdown timeout for device (vandreykiv) v0.8.13-32 (2022-03-20) allows Standard CC (no LKAS) to be used with pedal when cruise enabled allows Standard CC (no LKAS) to be used with ACC by double press down allows for pedal to be used over CC (when setting enabled) v0.8.13-31 (2022-03-18) based on v0.8.13 (latest release from Comma) requires EON Gold/Black Panda or Comma two/three no need for EPAS harness Panda flash built in UI Pedal flash built in UI EPAS patching built in UI Radar VIN Learner built in UI radar behind nosecone setting as part of VIN Learn (set via UI) works with either human long control, ACC or pedal no more ssh to install or update no more ssh to change any settings, all done through UI automatic change top speed based on speed limit and offset (either units or %) automatic lane change with adjustable delay human steering override with adjustable delay for re-engagement steering never disengages unless you cancel it via stalk adjustable follow distance though UI allows for CC without LKAS when using Pedal pedal can be on either CAN0 or CAN2 (set via UI) support for i Booster ECU (in dev)","title":"Welcome"},{"location":"Welcome_to_Tinkla_/#what-is-open-pilot","text":"Open Pilot is open source software built to improve upon the existing driver assistance in most new cars on the road today. Now Open Pilot is available for pre-autopilot Tesla Model S as well as Tesla Model S/X with autopilot hardware 1 or 2. Currently, openpilot performs the functions of Adaptive Cruise Control (ACC), Automated Lane Centering (ALC), Forward Collision Warning (FCW) and Lane Departure Warning (LDW) for a growing variety of supported car makes, models and model years. In addition, while openpilot is engaged, a camera based Driver Monitoring (DM) feature alerts distracted and asleep drivers. See more about the vehicle integration and limitations.","title":"What is Open Pilot"},{"location":"Welcome_to_Tinkla_/#getting-started","text":"Open Pilot for pre AP Tesla Model S Open Pilot for Tesla Model S/X with AP1 Open Pilot for Tesla Model S/X with AP2","title":"Getting Started"},{"location":"Welcome_to_Tinkla_/#software-design-history","text":"","title":"Software Design History"},{"location":"Welcome_to_Tinkla_/#v096-61-2024-01-17","text":"* in line with latest code from Comma * adds support for C3X * adds fixes for \"steering temporary unavailable\" * you can now chose between OP/AP1/ACC on cars with AP: - OP - single stalk pull - AP - double stalk pull - ACC (Tesla stock) - up/down stalk movement * improved IC integration for cars with AP: - when OP/AP now engaged, IC shows AP data - when OP is engaed, IC shows OP data - when AP is engaged, IC shows AP data * option to ignore radar errors (useful in winter time when radar might get dirty)","title":"v0.9.6-61 (2024-01-17)"},{"location":"Welcome_to_Tinkla_/#v0813-57-2022-11-17","text":"* Fix pedal pressed message on ACC * Adjust top speed with speed limit for AP1 * Show set speed in lower right corner for RHD cars * Brake factor speed adjustable (1.1 below 70km/h, 1.4 above 110km/h)","title":"v0.8.13-57 (2022-11-17)"},{"location":"Welcome_to_Tinkla_/#v0813-56-2022-11-08","text":"* Sound files volume fix * Show TACC icon on IC for AP cars when OP is available * Display shutdown * Engage at 0 MPH (AP cars) * Fleet based speed (AP cars) * Slow down in turns based on Sunny Pilot * prevent i Booster from pressing both pedals * Improved acceleration handling for AP1 * Add message ID for the CAN Error * Reduce min accel to -4.5 * Improve follow distance * Better and smoother pedal with 4 profiles * Universal calibration tool for pedal interceptor * i Booster control improvement * Add 5 pedal profiles and 3 acceleration profiles for better long control wiht pedal * Add alert when maximum regen is used with pedal to show braking limit * Prevent PCC engagement with uncalibrated pedals * Cancel automatic lane change on blinker or wheel touch * Toggle to ignore wrong date/time on device * Increase steering angle limits on Panda * Fix Controls Mismatch when taking over steering","title":"v0.8.13-56 (2022-11-08)"},{"location":"Welcome_to_Tinkla_/#v0813-55-2022-09-21","text":"* Sound toggles (to mute certain sounds) * Sound files","title":"v0.8.13-55 (2022-09-21)"},{"location":"Welcome_to_Tinkla_/#v0813-54-2022-09-19","text":"* Add capabilities for Str params * Implement fixed fingerprint option to avoid fingerprinting issues","title":"v0.8.13-54 (2022-09-19)"},{"location":"Welcome_to_Tinkla_/#v0813-53-2022-08-05","text":"* i Booster ECU fixes * Try to fix Controls Mismatch issues * Add toggle for radar error with AP","title":"v0.8.13-53 (2022-08-05)"},{"location":"Welcome_to_Tinkla_/#v0813-52-2022-08-05","text":"* Reset Pedal PID on engagement * Toggle for Model S Performance for pedal (bug fix) * Pedal profile for MS Performance (bug fix) * Toggle to prevent auto updates * Toggle for dev unit (bug fix) * Autoresume speed from stand still","title":"v0.8.13-52 (2022-08-05)"},{"location":"Welcome_to_Tinkla_/#v0813-51-2022-07-05","text":"* new PID for pedal, including way to save state * toggle for Model S Performance for pedal * pedal profile for MS Performance","title":"v0.8.13-51 (2022-07-05)"},{"location":"Welcome_to_Tinkla_/#v0813-48-2022-05-18","text":"* limit i Booster travel to a max of 15mm (90psi on my car) * set Hold values for i Booster to 6.5mm (14psi) * change lane poly calculation logic for IC integrtion","title":"v0.8.13-48 (2022-05-18)"},{"location":"Welcome_to_Tinkla_/#v0813-47-2022-05-11","text":"do not send i Booster brake command when real accelerator pedal is pressed","title":"v0.8.13-47 (2022-05-11)"},{"location":"Welcome_to_Tinkla_/#v0813-46-2022-05-10","text":"do not send i Booster brake command when accelerator pedal is pressed increase brake hold value","title":"v0.8.13-46 (2022-05-10)"},{"location":"Welcome_to_Tinkla_/#v0813-45-2022-05-09","text":"update firmware for Vacuum Sensor board with brake release condition allow 0x553 for i Booster in panda allow 0x555 for IVS in panda","title":"v0.8.13-45 (2022-05-09)"},{"location":"Welcome_to_Tinkla_/#v0813-44-2022-05-04","text":"update firmware for Vacuum Sensor board fix CRC for i Booster","title":"v0.8.13-44 (2022-05-04)"},{"location":"Welcome_to_Tinkla_/#v0813-43-2022-04-21","text":"fix Pedal over CC issues when MCU2 or no Tinkla Buddy add firmware for Vacuum Sensor board fix CRC for i Booster","title":"v0.8.13-43 (2022-04-21)"},{"location":"Welcome_to_Tinkla_/#v0813-41-2022-04-19","text":"fix startup screen for C3 fix modem initialization for C3 (comma three: correctly set initial EPS bearer settings for AT&T sim cards) fix logic for enabling OP on pre AP MS add C3 Tinkla Splash","title":"v0.8.13-41 (2022-04-19)"},{"location":"Welcome_to_Tinkla_/#v0813-38-2022-04-05","text":"toggle to allow move of maps on left always show OP data on IC when engaged (AP1/AP2) Comma three support fix top speed indicator when using pedal with Tinkla Buddy","title":"v0.8.13-38 (2022-04-05)"},{"location":"Welcome_to_Tinkla_/#v0813-37-2022-04-01","text":"added configuration value for Hands On Level before human takeover fixed acceleration for AP1 stop-and-go which was limited at 1.2m/s^2 added testing toggle for full Long Control from planner vs actuator (AP1 or pre AP with i Booster) fixed release scripts fixed automatic flashing of panda code","title":"v0.8.13-37 (2022-04-01)"},{"location":"Welcome_to_Tinkla_/#v0813-34-2022-03-27","text":"full support for OP long control with AP1 follow distance is adjustable from CC stalk (when available) UI shows multiple road lanes when detected by OP fix bug where ACC would show disabled message after brake press even when not enabled variable acceleration based on speed for AP1 OP based long control improve pedal tune (by vandreykiv) fix variables default value not showing correctly in UI","title":"v0.8.13-34 (2022-03-27)"},{"location":"Welcome_to_Tinkla_/#v0813-33-2022-03-26","text":"new events to show when Standard CC is enabled added shutdown timeout for device (vandreykiv)","title":"v0.8.13-33 (2022-03-26)"},{"location":"Welcome_to_Tinkla_/#v0813-32-2022-03-20","text":"allows Standard CC (no LKAS) to be used with pedal when cruise enabled allows Standard CC (no LKAS) to be used with ACC by double press down allows for pedal to be used over CC (when setting enabled)","title":"v0.8.13-32 (2022-03-20)"},{"location":"Welcome_to_Tinkla_/#v0813-31-2022-03-18","text":"based on v0.8.13 (latest release from Comma) requires EON Gold/Black Panda or Comma two/three no need for EPAS harness Panda flash built in UI Pedal flash built in UI EPAS patching built in UI Radar VIN Learner built in UI radar behind nosecone setting as part of VIN Learn (set via UI) works with either human long control, ACC or pedal no more ssh to install or update no more ssh to change any settings, all done through UI automatic change top speed based on speed limit and offset (either units or %) automatic lane change with adjustable delay human steering override with adjustable delay for re-engagement steering never disengages unless you cancel it via stalk adjustable follow distance though UI allows for CC without LKAS when using Pedal pedal can be on either CAN0 or CAN2 (set via UI) support for i Booster ECU (in dev)","title":"v0.8.13-31 (2022-03-18)"}]}